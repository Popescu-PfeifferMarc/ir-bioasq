<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id><journal-id journal-id-type="publisher-id">Nucleic Acids Research</journal-id><journal-title>Nucleic Acids Research</journal-title><issn pub-type="ppub">0305-1048</issn><issn pub-type="epub">1362-4962</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">16757580</article-id><article-id pub-id-type="pmc">PMC1475746</article-id><article-id pub-id-type="doi">10.1093/nar/gkl396</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>An expectation-maximization algorithm for probabilistic reconstructions of full-length isoforms from splice graphs</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Xing</surname><given-names>Yi</given-names></name><xref ref-type="aff" rid="au1">1</xref><xref ref-type="corresp" rid="cor2">*</xref></contrib><contrib contrib-type="author"><name><surname>Yu</surname><given-names>Tianwei</given-names></name><xref ref-type="aff" rid="au2">2</xref><xref ref-type="aff" rid="au3">3</xref></contrib><contrib contrib-type="author"><name><surname>Wu</surname><given-names>Ying Nian</given-names></name><xref ref-type="aff" rid="au2">2</xref></contrib><contrib contrib-type="author"><name><surname>Roy</surname><given-names>Meenakshi</given-names></name><xref ref-type="aff" rid="au1">1</xref></contrib><contrib contrib-type="author"><name><surname>Kim</surname><given-names>Joseph</given-names></name><xref ref-type="aff" rid="au1">1</xref></contrib><contrib contrib-type="author"><name><surname>Lee</surname><given-names>Christopher</given-names></name><xref ref-type="aff" rid="au1">1</xref><xref ref-type="corresp" rid="cor1">*</xref></contrib><aff id="au1"><sup>1</sup><institution>Molecular Biology Institute, Center for Computational Biology, Department of Chemistry and Biochemistry, University of California</institution><addr-line>Los Angeles, USA</addr-line></aff><aff id="au2"><sup>2</sup><institution>Department of Statistics, University of California</institution><addr-line>Los Angeles, USA</addr-line></aff><aff id="au3"><sup>3</sup><institution>Dental Research Institute, School of Dentistry, University of California</institution><addr-line>Los Angeles, USA</addr-line></aff></contrib-group><author-notes><corresp id="cor1"><sup>*</sup>To whom correspondence should be addressed. Tel: +1 310 825 7374; Fax: +1 310 206 7286. Email: <email>leec@mbi.ucla.edu</email></corresp><corresp id="cor2"><sup>*</sup>Correspondence may also be addressed to Yi Xing. Email: <email>yxing@ucla.edu</email></corresp><fn><p>The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors</p></fn></author-notes><!--For NAR: both ppub and collection dates generated for PMC processing 1/27/05 beck--><pub-date pub-type="collection"><year>2006</year></pub-date><pub-date pub-type="ppub"><year>2006</year></pub-date><pub-date pub-type="epub"><day>6</day><month>6</month><year>2006</year></pub-date><volume>34</volume><issue>10</issue><fpage>3150</fpage><lpage>3160</lpage><history><date date-type="received"><day>29</day><month>1</month><year>2006</year></date><date date-type="rev-recd"><day>13</day><month>4</month><year>2006</year></date><date date-type="accepted"><day>10</day><month>5</month><year>2006</year></date></history><copyright-statement>&#x000a9; 2006 The Author(s)</copyright-statement><copyright-year>2006</copyright-year><license license-type="openaccess"><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/"/>) which permits unrestricted non-commerical use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license><abstract><p>Reconstructing full-length transcript isoforms from sequence fragments (such as ESTs) is a major interest and challenge for bioinformatic analysis of pre-mRNA alternative splicing. This problem has been formulated as finding traversals across the splice graph, which is a directed acyclic graph (DAG) representation of gene structure and alternative splicing. In this manuscript we introduce a probabilistic formulation of the isoform reconstruction problem, and provide an expectation-maximization (EM) algorithm for its maximum likelihood solution. Using a series of simulated data and expressed sequences from real human genes, we demonstrate that our EM algorithm can correctly handle various situations of fragmentation and coupling in the input data. Our work establishes a general probabilistic framework for splice graph-based reconstructions of full-length isoforms.</p></abstract></article-meta></front><body><sec><title>INTRODUCTION</title><p>Alternative splicing is a widespread mechanism of gene regulation in higher eukaryotes (<xref ref-type="bibr" rid="b1">1</xref>&#x02013;<xref ref-type="bibr" rid="b3">3</xref>). It refers to the production of different mRNA transcripts from a single gene through alternative combinations of exons or alternative selections of splice sites (<xref ref-type="bibr" rid="b4">4</xref>). Among multi-exon genes in the human genome, it is estimated that as many as 74% are alternatively spliced (<xref ref-type="bibr" rid="b2">2</xref>). Alternative splicing can impact important functional regions of the proteins, such as protein interaction domains (<xref ref-type="bibr" rid="b5">5</xref>) and structural elements (<xref ref-type="bibr" rid="b6">6</xref>,<xref ref-type="bibr" rid="b7">7</xref>), leading to multiple protein products with distinct functions. It can be regulated in a tissue-specific (<xref ref-type="bibr" rid="b8">8</xref>) or developmental-dependent (<xref ref-type="bibr" rid="b9">9</xref>) manner. Aberrant alternative splicing is a major cause for many human diseases (<xref ref-type="bibr" rid="b10">10</xref>).</p><p>There are two types of experimental data for detecting alternative splicing: full-length sequences and sequence fragments. Sequencing of cDNAs can reveal the complete set of splicing events of full-length transcripts, leading to discoveries of splice variants (<xref ref-type="bibr" rid="b11">11</xref>). By contrast, most high-throughput genomic technologies [such as shotgun sequencing of ESTs (<xref ref-type="bibr" rid="b12">12</xref>) and oligonucleotide microarrays (<xref ref-type="bibr" rid="b13">13</xref>)] produce information about sequence fragments. The vast majority of alternative splicing events in the human and other eukaryotic genomes are discovered using fragmentary sequence data, such as ESTs (<xref ref-type="bibr" rid="b1">1</xref>) and microarray probe signals (<xref ref-type="bibr" rid="b2">2</xref>). ESTs are short fragments of full-length mRNA sequences (<xref ref-type="bibr" rid="b12">12</xref>). To date over 6.5 million human ESTs have been deposited in the UniGene database (compared to &#x0223c;200 000 full-length mRNAs, see the statistics at <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/UniGene/UGOrg.cgi?TAXID=9606"/>), which are extremely useful for discovering mRNA diversity, such as alternative splicing. However, as sequence fragments, ESTs only provide partial information on the complete gene structure (e.g. how 2 exons are combined). It is difficult to infer the likely functional impact of a splice variant, without the knowledge of its full-length transcript and protein product (<xref ref-type="bibr" rid="b14">14</xref>). In fact, over 80% of alternative splicing events in the human transcriptome are detected from EST sequences, with no corresponding full-length transcript or protein sequences available in sequence databases, such as GenBank (<xref ref-type="bibr" rid="b15">15</xref>). This problem becomes even more complicated in splicing microarrays, which return highly fragmentary information from probes targeting specific exons or exon&#x02013;exon junctions (<xref ref-type="bibr" rid="b2">2</xref>,<xref ref-type="bibr" rid="b16">16</xref>,<xref ref-type="bibr" rid="b17">17</xref>). For these reasons, the computational reconstruction of full-length transcript isoforms from sequence fragments becomes an important problem and challenge for bioinformatic analyses of alternative splicing (<xref ref-type="bibr" rid="b18">18</xref>).</p><p>Over the years, there has been a large body of work on this isoform reconstruction problem (<xref ref-type="bibr" rid="b15">15</xref>,<xref ref-type="bibr" rid="b19">19</xref>&#x02013;<xref ref-type="bibr" rid="b28">28</xref>). The centerpiece of these studies is a graph representation of gene structure and alternative splicing, often referred to as the &#x02018;splice graph&#x02019;. In a pioneering study, Heber and colleagues introduced the concept of splice graph (<xref ref-type="bibr" rid="b23">23</xref>), which represented exons as nodes and splicing events as directed edges (see <xref ref-type="fig" rid="fig1">Figure 1</xref> for a simple illustration). Different types of alternative splicing events, such as exon skipping, alternative donor/acceptor splice sites, mutually exclusive exon usage, intron retention, can be easily represented using splice graphs (e.g. see the representation of exon skipping events in <xref ref-type="fig" rid="fig1">Figure 1</xref>). The problem of isoform reconstruction can be formulated as a splice graph traversal problem (<xref ref-type="bibr" rid="b15">15</xref>,<xref ref-type="bibr" rid="b23">23</xref>,<xref ref-type="bibr" rid="b29">29</xref>). Due to alternative splicing, multiple traversals exist, corresponding to multiple isoforms of the gene (see <xref ref-type="fig" rid="fig1">Figure 1</xref>). Some methods enumerate all possible traversals across the splice graph (<xref ref-type="bibr" rid="b23">23</xref>,<xref ref-type="bibr" rid="b24">24</xref>). For genes with multiple alternatively spliced regions, such methods potentially generate a large number of random exon combinations. Several other methods use certain rules to produce a minimal set of traversals sufficient to explain all the input data (<xref ref-type="bibr" rid="b15">15</xref>,<xref ref-type="bibr" rid="b20">20</xref>&#x02013;<xref ref-type="bibr" rid="b22">22</xref>). In some cases the results of isoform reconstruction are dependent on the order of sequence observations in the input data (<xref ref-type="bibr" rid="b15">15</xref>,<xref ref-type="bibr" rid="b18">18</xref>).</p><p>Despite the vital contributions by these studies, several aspects of isoform reconstruction need to be improved. First, many genes have multiple alternatively spliced regions and complex patterns of alternative splicing (<xref ref-type="bibr" rid="b30">30</xref>,<xref ref-type="bibr" rid="b31">31</xref>). Multiple alternative splicing events in a single gene can be regulated in a highly coordinated fashion as shown experimentally in fibronectin, and other genes (<xref ref-type="bibr" rid="b32">32</xref>). One classic example is the alternative splicing of CD44. Only &#x0223c;20 isoforms have been observed for CD44, despite the possibility of &#x0223c;1000 random combinations of cassette exons (<xref ref-type="bibr" rid="b33">33</xref>,<xref ref-type="bibr" rid="b34">34</xref>). It is estimated that coupling of alternative splicing exists in at least 25% of alternatively spliced genes (<xref ref-type="bibr" rid="b32">32</xref>). In principle a splice graph traversal algorithm based on dynamic programming [such as the Heaviest Bundling algorithm of ours (<xref ref-type="bibr" rid="b15">15</xref>)], which makes local choices for finding the optimal traversal, cannot guarantee the correct treatment of coupled edges in the splice graph. Second, not all traversals across the splice graph are equally likely. It is important for the isoform reconstruction algorithm to reflect the strength of evidence for a particular splice graph traversal. An essential question is how to weigh evidence from sequence fragments, which might be consistent with a large number of traversals of the splice graph. These issues point to the need for an explicitly probabilistic approach to the isoform reconstruction problem.</p><p>In this manuscript, we introduce a probabilistic formulation of the isoform reconstruction problem, and provide a solution based on the maximum likelihood principle. EM algorithm (<xref ref-type="bibr" rid="b35">35</xref>) has been used in many areas of computational biology, such as haplotype inference (<xref ref-type="bibr" rid="b36">36</xref>), evolutionary selection pressure (e.g. Ka/Ks) estimation (<xref ref-type="bibr" rid="b37">37</xref>), predictions of domain&#x02013;domain interactions (<xref ref-type="bibr" rid="b38">38</xref>) and motif detection (<xref ref-type="bibr" rid="b39">39</xref>), etc. We describe an EM algorithm to estimate the probability for each traversal across the splice graph, which maximizes the total likelihood of the observed input data. A large body of work has used expressed sequences to reconstruct full-length isoforms (<xref ref-type="bibr" rid="b15">15</xref>,<xref ref-type="bibr" rid="b19">19</xref>&#x02013;<xref ref-type="bibr" rid="b28">28</xref>), or to quantify alternative splicing on the exon level (<xref ref-type="bibr" rid="b8">8</xref>,<xref ref-type="bibr" rid="b40">40</xref>&#x02013;<xref ref-type="bibr" rid="b42">42</xref>). Consistent with these previous studies, here we use a series of simulated sequence observations and expressed sequences of real human genes to demonstrate our probabilistic reconstruction of full-length isoforms from splice graphs. We want to emphasize that our method is not limited to the analyses of EST data. A variety of high-throughput genomic technologies [such as mass spectrometry (<xref ref-type="bibr" rid="b43">43</xref>), microarray (<xref ref-type="bibr" rid="b2">2</xref>), massively parallel signature sequencing (MPSS) (<xref ref-type="bibr" rid="b44">44</xref>), etc] produce fragments that can be used to detect alternative splicing. The goal of this manuscript is to establish a general probabilistic framework for splice graph-based reconstruction of full-length isoforms.</p></sec><sec sec-type="materials|methods"><title>MATERIALS AND METHODS</title><sec><title>Enumeration of putative isoforms from the splice graph</title><p>A splice graph is a directed acyclic graph (DAG), whose nodes represent exons and edges represent splicing events (<xref ref-type="bibr" rid="b23">23</xref>) (see <xref ref-type="fig" rid="fig1">Figure 1</xref>). We enumerated all possible traversals across the splice graph using a breadth-first-search (BFS) algorithm. These traversals corresponded to putative isoforms of a gene. We compared each sequence observation with each putative isoform to derive their consistency relationship. A sequence observation was defined as being consistent with a putative isoform if it was fully contained in the putative isoform. We constructed an indicator matrix, which recorded the consistency relationship of all sequence observations with all putative isoforms (see details below).</p></sec><sec><title>Probabilistic formulation and EM algorithm</title><sec><title>Multinomial model with uncommitted categorization</title><p>Suppose there are <italic>K</italic> possible isoforms for a gene. Let's denote them by <italic>I</italic><sub>1</sub>, <italic>I</italic><sub>2</sub>,&#x02009;&#x02026;&#x02009;,&#x02009;<italic>I</italic><sub><italic>K</italic></sub>. For each sequence observation, the probability that it is generated by isoform <italic>I<sub>k</sub></italic> is <italic>p<sub>k</sub></italic>, where <italic>k</italic> = 1,&#x02009;&#x02026;&#x02009;,&#x02009;<italic>K</italic> and <italic>p</italic><sub>1</sub> + <italic>p</italic><sub>2</sub> + &#x02026; + <italic>p</italic><sub><italic>K</italic></sub> = 1. This probability model is called multinomial model.</p><p>Suppose we observe <italic>N</italic> sequence observations. Let's denote them by <italic>O</italic><sub>1</sub>, <italic>O</italic><sub>2</sub>,&#x02009;&#x02026;&#x02009;,&#x02009;<italic>O<sub>N</sub></italic>. We can use an <italic>N</italic> &#x000d7; <italic>K</italic> indicator matrix <bold>Z</bold> = (<italic>z<sub>i,k</sub></italic>)<sub><italic>i</italic>=1,&#x02009;&#x02026;&#x02009;,&#x02009;<italic>N</italic>, <italic>k</italic>=1,&#x02009;&#x02026;&#x02009;,&#x02009;<italic>K</italic></sub> to record the categorizations of these sequence observations. Specifically, if the <italic>i</italic>th sequence observation is generated by isoform <italic>I<sub>k</sub></italic>, then <italic>z<sub>i,k</sub></italic> = 1; otherwise, <italic>z<sub>i,k</sub></italic> = 0.</p><p>The probabilities (<italic>p<sub>k</sub></italic>, <italic>k</italic> = 1,&#x02009;&#x02026;&#x02009;,&#x02009;<italic>K</italic>) can be estimated by isoform proportions. Specifically, we count the number of sequence observations that are generated by isoform <italic>k</italic>, i.e. <inline-formula><mml:math id="M1"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, then the estimated probability <inline-formula><mml:math id="M2"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>.</p><p>The complication is that most sequence observations are not of full-length, so that they are consistent with more than one isoform. Therefore, the indicator matrix <bold>Z</bold> is not fully observed. What is observed is another indicator matrix <bold>Y</bold> = (<italic>y<sub>i,k</sub></italic>)<sub><italic>i</italic>=1,&#x02009;&#x02026;&#x02009;,&#x02009;<italic>N</italic>;<italic>k</italic>=1,&#x02009;&#x02026;&#x02009;,&#x02009;<italic>K</italic></sub>, where <italic>y<sub>i,k</sub></italic> = 1 if the <italic>i</italic>th sequence observation is consistent with isoform <italic>I<sub>k</sub></italic>, and <italic>y<sub>i,k</sub></italic> = 0 otherwise. Unlike matrix <bold>Z</bold>, which has one and only one 1 in each row, the matrix <bold>Y</bold> has one or more 1's in each row. If <italic>y<sub>i,k</sub></italic> = 0, then <italic>z<sub>i,k</sub></italic> must be 0, but if <italic>y<sub>i,k</sub></italic> = 1, then <italic>z<sub>i,k</sub></italic> may or may not be 1. We call <bold>Y</bold> the uncommitted categorization, and <bold>Z</bold> the underlying committed categorization.</p><p>We denote &#x003b8; = (<italic>p</italic><sub>1</sub>,&#x02009;&#x02026;&#x02009;,&#x02009;<italic>p<sub>K</sub></italic>). The log likelihood function of the multinomial model with uncommitted categorization is
<disp-formula><mml:math id="M3"><mml:mrow><mml:mi>l</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>&#x003b8;</mml:mi><mml:mo>&#x02223;</mml:mo><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover></mml:mstyle><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover></mml:mstyle><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>
)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
The maximum likelihood estimates (MLE) of &#x003b8;, <inline-formula><mml:math id="M4"><mml:mrow><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo>arg</mml:mo><mml:msub><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>&#x003b8;</mml:mi><mml:mo>&#x02223;</mml:mo><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, cannot be obtained in closed-form.</p></sec><sec><title>EM: soft categorization and fractional counts</title><p>The EM algorithm (<xref ref-type="bibr" rid="b35">35</xref>) can be used to compute the maximum likelihood estimates (MLE) of the category probabilities &#x003b8; = (<italic>p<sub>k</sub></italic>, <italic>k</italic> = 1,&#x02009;&#x02026;&#x02009;,&#x02009;<italic>K</italic>) from the observed data <bold>Y</bold>. The EM algorithm is an iterative algorithm. In describing the algorithm, we add subscript &#x003b8;<sup><italic>(t)</italic></sup> to the relevant quantities. For instance, &#x003b8;<sub><italic>(t)</italic></sub> is the parameter value computed after <italic>t</italic> th iteration. The algorithm starts from an initial guess <inline-formula><mml:math id="M5"><mml:mrow><mml:msup><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>&#x02026;</mml:mn><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>. For instance, <inline-formula><mml:math id="M6"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>K</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> Each iteration is a mapping from &#x003b8;<sup>(<italic>t</italic>)</sup> to &#x003b8;<sup>(<italic>t</italic>+1)</sup>, which is accomplished via the following two steps:</p><p>E-step:
<disp-formula><mml:math id="M7"><mml:mrow><mml:msubsup><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02223;</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>Pr</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02223;</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>p</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>p</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mo>&#x02200;</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>M-step: Let <inline-formula><mml:math id="M8"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover></mml:mstyle><mml:mrow><mml:msubsup><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#x02200;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula>,
<disp-formula><mml:math id="M9"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>,</mml:mo><mml:mo>&#x02200;</mml:mo><mml:mi>k</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
Intuitively, the E-step splits the <italic>i</italic>th sequence observation into different isoforms. Each isoform <italic>k</italic> with <italic>y</italic><sub><italic>i</italic>,<italic>k</italic></sub> = 1 gets a fraction of <italic>O<sub>i</sub></italic> in proportion to <inline-formula><mml:math id="M10"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, and this fraction is <inline-formula><mml:math id="M11"><mml:mrow><mml:msubsup><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>. We call this soft categorization. The M-step updates the probability of each isoform by counting the sequence observations that are categorized into this isoform. Because of soft categorization, we have to sum up the fractional indicators as if they were0/1 indicators.</p><p>We can run this algorithm until <inline-formula><mml:math id="M12"><mml:mrow><mml:mo>&#x02223;</mml:mo><mml:msup><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>&#x02212;</mml:mo><mml:msup><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>&#x02223;</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mrow><mml:mo>&#x02223;</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>&#x02223;</mml:mo><mml:mo>&#x0003c;</mml:mo><mml:mi>&#x0025b;</mml:mi></mml:mrow></mml:math></inline-formula>, where &#x0025b; is a pre-specified stopping criterion. Throughout this manuscript, we used an &#x0025b; of 10<sup>&#x02212;6</sup>.</p><p>The algorithm is justified in Appendix 1 of the online supplements. The standard errors of the parameter estimates can be obtained after EM converges. See Appendix 2 of the online supplements.</p></sec></sec><sec><title>Simulation study</title><p>We performed a simulation study to examine the robustness of our EM algorithm against sampling biases in the input data. EST generation is subject to two major sources of variation: (i) isoform sampling based on isoform abundance and (ii) random fragmentation of isoforms. These variations translate into the variation in the MLE estimates of the probabilities. We simulated a gene with 10 exons. The terminal exons were 250 bp in length. All the internal exons were 150 bp. Exon 2 and 9 were alternatively spliced cassette exons. Four isoforms can be generated from this gene: the isoform with all exons, the isoform without exon 2, the isoform without exon 9, and the isoform without exon 2 and 9 (see <xref ref-type="table" rid="tbl1">Table 1</xref>).</p><p>We set certain fixed probabilities for these isoforms (see <xref ref-type="table" rid="tbl1">Table 1</xref>). We generated a simulated expressed sequence using the following three-step procedure: (i) randomly sample the four isoforms, to generate a full-length mRNA, (ii) randomly sample the empirical distribution of the length of ESTs (taken from human UniGene data, see Supplementary Data), to decide the length of the simulated expressed sequence and (iii) randomly truncate the simulated mRNA according to the length obtained from the previous step, to make the simulated expressed sequence. If the length was longer than the mRNA, the whole mRNA was the simulated expressed sequence.</p><p>After gathering <italic>N</italic> (<italic>N</italic> = 10, 25, 50, 100 and 250) simulated expressed sequences, we ran the EM algorithm to obtain the estimates of probabilities. The deviation of the estimated probabilities from the truth was measured by the total variation distance, which is <inline-formula><mml:math id="M13"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:munderover><mml:mrow><mml:mrow><mml:mo>&#x02223;</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>&#x02223;</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. For each <italic>N</italic>, we repeated the process 100 times and inspected the distributions of the total variation distance.</p></sec><sec><title>Probabilistic isoform reconstruction using human expressed sequence data</title><p>For a human gene, we aligned all of its mRNA and EST sequences to its genomic sequence using POA (<xref ref-type="bibr" rid="b45">45</xref>), and calculated the exons and splicing events from the multiple sequence alignment (<xref ref-type="bibr" rid="b15">15</xref>), using June 2003 download of UniGene data and human genome sequences. We constructed the splice graph based on observed splicing events among its exons in the expressed sequence data. Details of the splice graph construction were described in Xing <italic>et al</italic>. (<xref ref-type="bibr" rid="b15">15</xref>). We enumerated all possible traversals across the splice graph as the total set of putative isoforms, using a BFS algorithm. We used the EM algorithm described above to estimate the probability of each isoform.</p></sec></sec><sec><title>RESULTS</title><sec><title>Probabilistic isoform reconstruction for a simulated gene</title><p>To test and illustrate the behavior of the EM algorithm, we designed a simulated gene with 5 exons. Exon 2 and 4 were cassette exons that could be skipped entirely. An exhaustive traversal of this splice graph produced four isoforms for this gene: the one that contained all 5 exons (FL), the one that lacked exon 2 (&#x00394;&#x02212;2), the one that lacked exon 4 (&#x00394;&#x02212;4) and the one that lacked both exon 2 and 4(&#x00394;&#x02212;2, 4). Of course, the result of our probabilistic isoform reconstruction should be dependent on the actual sequence observations for this gene.</p><p>We designed four different sets of sequence observations, and ran the EM algorithm on each of them to infer isoform probabilities. Each set contained 20 sequences, and represented distinct situations of sequence observations. Details of these dataset are illustrated in <xref ref-type="fig" rid="fig2">Figure 2</xref> (left panels).</p><p>In sequence set 1, each sequence indicated the inclusion or skipping of one cassette exon (exon 2 or exon 4). No sequence covered both alternatively spliced regions. Five sequences contained exon 1 and 3, indicating the skipping of exon 2; five sequences contained exon 1, 2 and 3, indicating the inclusion of exon 2. These ten sequences gave no information about the inclusion or skipping of exon 4. Similarly, five sequences indicated the inclusion and another five sequences indicated the skipping of exon 4, but carried no information on the status of exon 2. In summary, this sequence dataset represented a situation where all the input sequences were highly fragmented. There was no indication on how cassette exon 2 and 4 were combined in the final transcripts. Our EM algorithm converged at equal probabilities for all possible isoforms (see <xref ref-type="fig" rid="fig2">Figure 2A</xref>, right panel).</p><p>Sequence set 2 represented a completely opposite situation. Every sequence in set 2 was a full-length sequence. Twelve sequences contained all 5 exons, and eight sequences contained only exon 1, 3 and 5. Obviously, although we could produce four different traversals across this splice graph, only two traversals were observed in our input data and were necessary to explain all the 20 sequences. In fact, the skipping events of exon 2 and exon 4 were always coupled in the input data. Initiating from equal probabilities (0.25) for all isoforms, our EM algorithm converged at 0.6 for the FL and 0.4 for the &#x00394;&#x02212;2,4 isoform, and 0 for the &#x00394;&#x02212;2 and &#x00394;&#x02212;4 isoform (see <xref ref-type="fig" rid="fig2">Figure 2B</xref>). The result of our EM algorithm was consistent with the proposed strategy of producing a minimal set of isoforms to explain all the sequence observations (<xref ref-type="bibr" rid="b15">15</xref>,<xref ref-type="bibr" rid="b21">21</xref>,<xref ref-type="bibr" rid="b22">22</xref>).</p><p>Sequence set 3 contained both full-length sequences and sequence fragments (see <xref ref-type="fig" rid="fig2">Figure 2C</xref>, left panel). It was easy to notice that six sequence fragments (which contained exon 3, 4 and 5) were consistent with both FL and &#x00394;&#x02212;2 isoforms. During the iterations, the categorization of these six sequences to the FL and &#x00394;&#x02212;2 isoform was gradually assigned to the FL isoform, due to additional sequence evidence (nine sequences) that only supported the FL isoform. The algorithm converged at 0.75 for the FL and 0 for the &#x00394;&#x02212;2 isoform. A similar situation occurred during the probability estimation for the other two isoforms: &#x00394;&#x02212;2,4 received a probability of 0.25 while &#x00394;&#x02212;4 received a probability of 0 (see <xref ref-type="fig" rid="fig2">Figure 2C</xref>, right panel).</p><p>In sequence set 4, all four isoforms were observed in the input data. Our EM algorithm converged at non-zero probabilities for all isoforms (see <xref ref-type="fig" rid="fig2">Figure 2D</xref>).</p><p>The results of our probabilistic isoform reconstruction on this simulated gene indicate that our EM algorithm can correctly handle various situations of fragmentation and coupling in the sequence data. It produces the most likely probability estimate for each isoform by considering all the sequence observations simultaneously. Unlike our previous method (<xref ref-type="bibr" rid="b15">15</xref>), this probabilistic reconstruction is completely independent of the order of input sequence observations.</p></sec><sec><title>Simulation study to test the robustness of the EM algorithm</title><p>Sampling biases in the input data can affect the maximum likelihood estimates of the isoform probabilities. In particular, when the number of sequence observations for a gene is relatively small, the MLE might have considerable deviations from the true isoform probabilities. To assess the impact of sampling biases, we performed a simulation study on a simple gene model with 10 exons. We used four sets of probability distributions of isoforms (see <xref ref-type="table" rid="tbl1">Table 1</xref>), and then simulated the process of random EST generation (see Materials and Methods). For each probability distribution we randomly generated 10, 25, 50, 100 and 250 sequences (see Materials and Methods).</p><p>We compared our MLE estimates to the true probabilities to calculate the total variation distance (see the definition in Materials and Methods). When the total number of sequence observations was only 10, there was a considerable difference between the estimated isoform probabilities and the true probabilities. By contrast, with 250 sequence observations, these two sets of probabilities were fairly close (see <xref ref-type="fig" rid="fig3">Figure 3A</xref>). An additional simulation that randomly initiated the true probability distribution of all isoforms produced a similar result (see <xref ref-type="fig" rid="fig3">Figure 3B</xref>). As expected, our simulation study indicates that the accuracy of our estimates is dependent on the number of sequence observations for a gene.</p></sec><sec><title>Isoform reconstruction using expressed sequence data for HLA-DMB and TPM1</title><p><xref ref-type="fig" rid="fig4">Figure 4A</xref> shows the gene structure for a well-studied gene <italic>HLA-DMB</italic>. <italic>HLA-DMB</italic> plays an important role in antigen presentation and the activation of the humoral immune response, by facilitating the loading of class II MHC molecules with exogenous peptide antigens (<xref ref-type="bibr" rid="b46">46</xref>&#x02013;<xref ref-type="bibr" rid="b48">48</xref>). This process occurs in early lysosomal compartments. <italic>HLA-DMB</italic> has 6 exons. Exon 4 encodes a hydrophobic transmembrane (TM) domain, and exon 5 encodes a lysosomal targeting (LT) signal. Our EST-genome alignment revealed alternative splice forms that skipped exon 4 or exon 5 of <italic>HLA-DMB</italic>, or both. Therefore in addition to the FL form of <italic>HLA-DMB</italic>, expressed sequence data indicate three additional isoforms that lack the TM domain (&#x00394;-TM), or the LT signal (&#x00394;-LT), or both (&#x00394;-TM and LT). By excluding likely EST artifacts from unspliced genomic DNA (<xref ref-type="bibr" rid="b1">1</xref>), we used 97 cDNA/EST sequences as the input data for our probabilistic isoform reconstruction. Our calculation shows that the FL <italic>HLA-DMB</italic> is the predominant isoform for this gene, with an estimated probability of 0.732. The three shorter <italic>HLA-DMB</italic> isoforms are present at a much lower level (see <xref ref-type="fig" rid="fig4">Figure 4C</xref>). The probability estimates of these <italic>HLA-DMB</italic> isoforms agree well with our RT&#x02013;PCR analysis of <italic>HLA-DMB</italic> isoforms (<xref ref-type="fig" rid="fig4">Figure 4D</xref>; see Appendix 3 of the online supplements for details on RT&#x02013;PCR analyses and sequencing of <italic>HLA-DMB</italic>).</p><p>We also reconstructed isoforms for Tropomyosin 1 (<italic>TPM1</italic>). <italic>TPM1</italic> has multiple regions with complicated patterns of alternative splicing. Even after we excluded likely EST artifacts, the remaining sequence observations still gave rise to a splice graph with 16 possible traversals. Previous studies of <italic>TPM1</italic> alternative splicing revealed two major alternative splicing events: the mutually exclusive usage of exon 6a and 6b; the alternative use of exon 9/10 or exon 11 as the 3&#x02032; terminal exons (see <xref ref-type="fig" rid="fig5">Figure 5A</xref>). There is evidence in the expressed sequence data that alternative splicing of these two regions is not independent (see <xref ref-type="fig" rid="fig5">Figure 5B</xref>). In fact, quantitative PCR analyses of <italic>TPM1</italic> alternative splicing showed that the inclusion of exon 6b together with exon 9/10 was the predominant isoform in muscle (<xref ref-type="bibr" rid="b49">49</xref>). On the other hand, the inclusion of exon 6a and exon 11 was predominant in non-muscle tissues (<xref ref-type="bibr" rid="b49">49</xref>). Although such coupling information was present in the input sequence observations, our previous isoform generation method failed to capture such a signal for coupled alternative splicing events (<xref ref-type="bibr" rid="b15">15</xref>), demonstrating the limitation of dynamic programming in recognizing coupled edges in the splice graph. By contrast, our EM algorithm converged at five isoforms with an inferred probability of at least 0.05. The two isoforms that received the highest probability estimates corresponded to the muscle-specific and non-muscle isoforms of <italic>TPM1</italic> (see <xref ref-type="fig" rid="fig5">Figure 5C</xref>). This analysis demonstrates that our EM algorithm provides a global, probabilistic solution that can deal with coupling events in the splice graph.</p></sec><sec><title>Isoform reconstruction for genes on human chromosome 22</title><p>To assess the computational feasibility of our algorithm, we performed isoform reconstruction for 186 alternatively spliced genes from human chromosome 22. We recorded the computation time on a PC (AMD Athlon 1500+ with 320MB of RAM) for each gene. The result is plotted in <xref ref-type="fig" rid="fig6">Figure 6</xref>. The average CPU time is 6.7 seconds. The maximal CPU time is 298.1 seconds for Hs.26593 (HDAC10), which has 768 possible traversals across its splice graph. This analysis demonstrates that our algorithm is computationally feasible.</p><p>One important and difficult aspect of isoform reconstruction is to assess the confidence in different traversals of the splice graph, by integrating full-length sequences and sequence fragments. A widely used approach in non-probabilistic isoform reconstruction method is to evaluate isoforms based on numbers of consistent sequence evidence. For each of the 186 UniGene clusters on chromosome 22, we scored its putative isoforms using (i) probability estimates from our EM algorithm; (ii) numbers of consistent sequence evidence. We classified all putative isoforms into two categories: those with mRNA evidence, and those with only EST evidence. The first category was treated as goldstandard high-confidence isoforms, since the presence of mRNA evidence was widely used as a criterion for real isoforms, as opposed to rare spliceosomal errors or EST artifacts (<xref ref-type="bibr" rid="b1">1</xref>). For UniGene clusters on chromosome 22 with both mRNAs and ESTs, we summed the scores for both categories of putative isoforms separately and calculated their ratio. Using probability estimates as the scores, the overall ratio (isoforms with mRNA evidence versus isoforms with only EST evidence) is 4.5. By contrast, scoring by numbers of consistent sequence evidence yielded an overall ratio of 1.1. This analysis indicates that a higher probability out of our EM algorithm is correlated with a higher confidence in the putative isoforms. Isoform evaluation by EM has a more significant tendency of favoring high-confidence isoforms, compared to the non-probabilistic method. In addition, EM algorithm does a much better job in distinguishing high-scoring isoforms from low-scoring isoforms (data not shown).</p></sec></sec><sec><title>DISCUSSION</title><p>Our study is an extension to a large body of previous work which reconstruct full-length isoforms from the splice graph (<xref ref-type="bibr" rid="b15">15</xref>,<xref ref-type="bibr" rid="b19">19</xref>&#x02013;<xref ref-type="bibr" rid="b26">26</xref>). An essential question in every isoform reconstruction method is how to integrate evidence from full-length sequences and sequence fragments. This question is complicated by the combinatorial nature of alternative splicing, i.e. a sequence fragment can be consistent evidence for a large number of isoforms. Some previous studies enumerate all possible isoforms (<xref ref-type="bibr" rid="b23">23</xref>,<xref ref-type="bibr" rid="b24">24</xref>). Several others use certain rules to produce a minimal set of isoforms sufficient to explain all the input data (<xref ref-type="bibr" rid="b15">15</xref>,<xref ref-type="bibr" rid="b20">20</xref>&#x02013;<xref ref-type="bibr" rid="b22">22</xref>). The resulting minimal set of isoforms can be input-order dependent (<xref ref-type="bibr" rid="b15">15</xref>,<xref ref-type="bibr" rid="b18">18</xref>). There is a genuine need for a global consideration of all the observational data simultaneously, and a probabilistic approach to measure evidence for every possible traversal across the splice graph. In this manuscript, we introduce a probabilistic formulation of the isoform reconstruction problem, and describe an EM algorithm for its maximum likelihood solution. Through the analyses of simulated data and sequence data of real human genes, we demonstrate that our algorithm provide a robust, probabilistic solution for various situations of fragmentation and coupling in the input data.</p><p>Our probabilistic framework provides the basis for several areas of extensions. One extension is to account for errors or redundancies in the sequence observations. For example, EST data contain various types of artifacts. Sorek and colleagues (<xref ref-type="bibr" rid="b50">50</xref>,<xref ref-type="bibr" rid="b51">51</xref>) proposed a method to detect EST libraries with high levels of artifacts. It has also been suggested that due to issues related to the normalization of cDNA libraries (<xref ref-type="bibr" rid="b52">52</xref>), multiple ESTs from a single library should be regarded as weaker evidence for an alternative splice form than the same number of ESTs from different libraries. We can use an additional weighting parameter to reflect our confidence about an individual EST sequence. This weighting parameter can be easily incorporated in the EM algorithm for maximum likelihood estimation. Specifically, we can write the log likelihood as the weighted sum of the individual log terms, and this leads to an EM algorithm where the sum of <italic>z<sub>i,k</sub></italic> becomes the weight sum of <italic>z</italic><sub><italic>i</italic>,<italic>k</italic></sub>. Of course, we can also be more formal by adding an extra layer of randomization in the model to reflect the uncertainty in the sequence observations, and then develop the EM algorithm for maximum likelihood estimation.</p><p>A second extension is to detect full-length isoforms that are specifically enriched in certain conditions (e.g. tissues, developmental states, diseases) by considering the origin of sequence observations. Several studies used expressed sequences to detect tissue-specific and cancer-specific exons (<xref ref-type="bibr" rid="b8">8</xref>,<xref ref-type="bibr" rid="b52">52</xref>&#x02013;<xref ref-type="bibr" rid="b54">54</xref>). However, information of specificity in sequence fragments cannot be directly translated into knowledge about full-length tissue-specific and cancer-specific isoforms. In our current probabilistic framework, the EM algorithm can run separately on different sets of sequence observations for a given gene (e.g. one set from cancerous libraries and another set from normal libraries). The likelihood ratio test (LRT) can be used to assess whether the abundance of a particular isoform varies significantly across different sets of sequence observations.</p><p>One of the most exciting future developments is to incorporate splicing microarray data. Recently, microarray technology has been developed for high-throughput analyses of alternative splicing (<xref ref-type="bibr" rid="b2">2</xref>,<xref ref-type="bibr" rid="b16">16</xref>). By designing probes targeting specific exons or exon&#x02013;exon junctions, microarray allows a rapid quantitative analysis of alternative splicing of thousands of exons on a single array. However, the signal from microarray experiments is even more fragmented compared to expressed sequences. There will be a growing need for an isoform reconstruction method that integrates sequence data (e.g. expressed sequences) and microarray probe signals (<xref ref-type="bibr" rid="b55">55</xref>). We will describe our splice graph-based analysis of splicing microarray data in a separate manuscript.</p></sec><sec><title>ONLINE SUPPLEMENTS</title><p>Online Supplementary Data, including the R code for the EM calculation and simulation studies, can be accessed at <ext-link ext-link-type="uri" xlink:href="http://bioinfo.mbi.ucla.edu/yxing/isoform/"/>.</p></sec><sec><title>SUPPLEMENTARY DATA</title><p>Supplementary Data are available at NAR Online.</p></sec></body><back><ack><p>We thank Stott Parker and Namshin Kim for comments on this manuscript. This work was supported by NIH Grant U54-RR021813, a Teacher-Scholar award to C.J.L. from the Dreyfus Foundation, a DOE grant DE-FC02-02ER63421, and a Dissertation Year Fellowship to Y.X. from UCLA. Funding to pay the Open Access publication charges for this article was provided by National Institutes of Health, Bethesda, Maryland, USA.</p><p><italic>Conflict of interest statement</italic>. None declared.</p></ack><ref-list><title>REFERENCES</title><ref id="b1"><label>1</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Modrek</surname><given-names>B.</given-names></name><name><surname>Lee</surname><given-names>C.</given-names></name></person-group><article-title>A genomic view of alternative splicing</article-title><source>Nature Genet.</source><year>2002</year><volume>30</volume><fpage>13</fpage><lpage>19</lpage><pub-id pub-id-type="pmid">11753382</pub-id></citation></ref><ref id="b2"><label>2</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname><given-names>J.M.</given-names></name><name><surname>Castle</surname><given-names>J.</given-names></name><name><surname>Garrett-Engele</surname><given-names>P.</given-names></name><name><surname>Kan</surname><given-names>Z.</given-names></name><name><surname>Loerch</surname><given-names>P.M.</given-names></name><name><surname>Armour</surname><given-names>C.D.</given-names></name><name><surname>Santos</surname><given-names>R.</given-names></name><name><surname>Schadt</surname><given-names>E.E.</given-names></name><name><surname>Stoughton</surname><given-names>R.</given-names></name><name><surname>Shoemaker</surname><given-names>D.D.</given-names></name></person-group><article-title>Genome-wide survey of human alternative pre-mRNA splicing with exon junction microarrays</article-title><source>Science</source><year>2003</year><volume>302</volume><fpage>2141</fpage><lpage>2144</lpage><pub-id pub-id-type="pmid">14684825</pub-id></citation></ref><ref id="b3"><label>3</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lareau</surname><given-names>L.F.</given-names></name><name><surname>Green</surname><given-names>R.E.</given-names></name><name><surname>Bhatnagar</surname><given-names>R.S.</given-names></name><name><surname>Brenner</surname><given-names>S.E.</given-names></name></person-group><article-title>The evolving roles of alternative splicing</article-title><source>Curr. Opin. Struct. Biol.</source><year>2004</year><volume>14</volume><fpage>273</fpage><lpage>282</lpage><pub-id pub-id-type="pmid">15193306</pub-id></citation></ref><ref id="b4"><label>4</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gravely</surname><given-names>B.R.</given-names></name></person-group><article-title>Alternative splicing: increasing diversity in the proteomic world</article-title><source>Trends Genet.</source><year>2001</year><volume>17</volume><fpage>100</fpage><lpage>107</lpage><pub-id pub-id-type="pmid">11173120</pub-id></citation></ref><ref id="b5"><label>5</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Resch</surname><given-names>A.</given-names></name><name><surname>Xing</surname><given-names>Y.</given-names></name><name><surname>Modrek</surname><given-names>B.</given-names></name><name><surname>Gorlick</surname><given-names>M.</given-names></name><name><surname>Riley</surname><given-names>R.</given-names></name><name><surname>Lee</surname><given-names>C.</given-names></name></person-group><article-title>Assessing the impact of alternative splicing on domain interactions in the human proteome</article-title><source>J. Proteome Res.</source><year>2004</year><volume>3</volume><fpage>76</fpage><lpage>83</lpage><pub-id pub-id-type="pmid">14998166</pub-id></citation></ref><ref id="b6"><label>6</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Garcia</surname><given-names>J.</given-names></name><name><surname>Gerber</surname><given-names>S.H.</given-names></name><name><surname>Sugita</surname><given-names>S.</given-names></name><name><surname>Sudhof</surname><given-names>T.C.</given-names></name><name><surname>Rizo</surname><given-names>J.</given-names></name></person-group><article-title>A conformational switch in the Piccolo C2A domain regulated by alternative splicing</article-title><source>Nature Struct. Mol. Biol.</source><year>2004</year><volume>11</volume><fpage>45</fpage><lpage>53</lpage><pub-id pub-id-type="pmid">14718922</pub-id></citation></ref><ref id="b7"><label>7</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wen</surname><given-names>F.</given-names></name><name><surname>Li</surname><given-names>F.</given-names></name><name><surname>Xia</surname><given-names>H.</given-names></name><name><surname>Lu</surname><given-names>X.</given-names></name><name><surname>Zhang</surname><given-names>X.</given-names></name><name><surname>Li</surname><given-names>Y.</given-names></name></person-group><article-title>The impact of very short alternative splicing on protein structures and functions in the human genome</article-title><source>Trends Genet.</source><year>2004</year><volume>20</volume><fpage>232</fpage><lpage>236</lpage><pub-id pub-id-type="pmid">15109776</pub-id></citation></ref><ref id="b8"><label>8</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>Q.</given-names></name><name><surname>Modrek</surname><given-names>B.</given-names></name><name><surname>Lee</surname><given-names>C.</given-names></name></person-group><article-title>Genome-wide detection of tissue-specific alternative splicing in the human transcriptome</article-title><source>Nucleic Acids Res.</source><year>2002</year><volume>30</volume><fpage>3754</fpage><lpage>3766</lpage><pub-id pub-id-type="pmid">12202761</pub-id></citation></ref><ref id="b9"><label>9</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>X.</given-names></name><name><surname>Yang</surname><given-names>D.</given-names></name><name><surname>Ding</surname><given-names>J.H.</given-names></name><name><surname>Wang</surname><given-names>W.</given-names></name><name><surname>Chu</surname><given-names>P.H.</given-names></name><name><surname>Dalton</surname><given-names>N.D.</given-names></name><name><surname>Wang</surname><given-names>H.Y.</given-names></name><name><surname>Bermingham</surname><given-names>J.R.</given-names><suffix>Jr</suffix></name><name><surname>Ye</surname><given-names>Z.</given-names></name><name><surname>Liu</surname><given-names>F.</given-names></name><etal/></person-group><article-title>ASF/SF2-regulated CaMKIIdelta alternative splicing temporally reprograms excitation-contraction coupling in cardiac muscle</article-title><source>Cell</source><year>2005</year><volume>120</volume><fpage>59</fpage><lpage>72</lpage><pub-id pub-id-type="pmid">15652482</pub-id></citation></ref><ref id="b10"><label>10</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Garcia-Blanco</surname><given-names>M.A.</given-names></name><name><surname>Baraniak</surname><given-names>A.P.</given-names></name><name><surname>Lasda</surname><given-names>E.L.</given-names></name></person-group><article-title>Alternative splicing in disease and therapy</article-title><source>Nat. Biotechnol.</source><year>2004</year><volume>22</volume><fpage>535</fpage><lpage>546</lpage><pub-id pub-id-type="pmid">15122293</pub-id></citation></ref><ref id="b11"><label>11</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kochiwa</surname><given-names>H.</given-names></name><name><surname>Suzuki</surname><given-names>R.</given-names></name><name><surname>Washio</surname><given-names>T.</given-names></name><name><surname>Saito</surname><given-names>R.</given-names></name><name><surname>Bono</surname><given-names>H.</given-names></name><name><surname>Carninci</surname><given-names>P.</given-names></name><name><surname>Okazaki</surname><given-names>Y.</given-names></name><name><surname>Miki</surname><given-names>R.</given-names></name><name><surname>Hayashizaki</surname><given-names>Y.</given-names></name><name><surname>Tomita</surname><given-names>M.</given-names></name></person-group><article-title>Inferring alternative splicing patterns in mouse from a full-length cDNA library and microarray data</article-title><source>Genome Res.</source><year>2002</year><volume>12</volume><fpage>1286</fpage><lpage>1293</lpage><pub-id pub-id-type="pmid">12176936</pub-id></citation></ref><ref id="b12"><label>12</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Boguski</surname><given-names>M.S.</given-names></name><name><surname>Lowe</surname><given-names>T.M.</given-names></name><name><surname>Tolstoshev</surname><given-names>C.M.</given-names></name></person-group><article-title>dbEST&#x02013;database for &#x02018;expressed sequence tags&#x02019;</article-title><source>Nature Genet.</source><year>1993</year><volume>4</volume><fpage>332</fpage><lpage>333</lpage><pub-id pub-id-type="pmid">8401577</pub-id></citation></ref><ref id="b13"><label>13</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>C.</given-names></name><name><surname>Wong</surname><given-names>W.H.</given-names></name></person-group><article-title>Model-based analysis of oligonucleotide arrays: expression index computation and outlier detection</article-title><source>Proc. Natl Acad. Sci. USA</source><year>2001</year><volume>98</volume><fpage>31</fpage><lpage>36</lpage><pub-id pub-id-type="pmid">11134512</pub-id></citation></ref><ref id="b14"><label>14</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Boue</surname><given-names>S.</given-names></name><name><surname>Vingron</surname><given-names>M.</given-names></name><name><surname>Kriventseva</surname><given-names>E.</given-names></name><name><surname>Koch</surname><given-names>I.</given-names></name></person-group><article-title>Theoretical analysis of alternative splice forms using computational methods</article-title><source>Bioinformatics</source><year>2002</year><volume>18</volume><fpage>S65</fpage><lpage>S73</lpage><pub-id pub-id-type="pmid">12385985</pub-id></citation></ref><ref id="b15"><label>15</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Xing</surname><given-names>Y.</given-names></name><name><surname>Resch</surname><given-names>A.</given-names></name><name><surname>Lee</surname><given-names>C.</given-names></name></person-group><article-title>The Multiassembly Problem: reconstructing multiple transcript isoforms from EST fragment mixtures</article-title><source>Genome Res.</source><year>2004</year><volume>14</volume><fpage>426</fpage><lpage>441</lpage><pub-id pub-id-type="pmid">14962984</pub-id></citation></ref><ref id="b16"><label>16</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pan</surname><given-names>Q.</given-names></name><name><surname>Shai</surname><given-names>O.</given-names></name><name><surname>Misquitta</surname><given-names>C.</given-names></name><name><surname>Zhang</surname><given-names>W.</given-names></name><name><surname>Saltzman</surname><given-names>A.L.</given-names></name><name><surname>Mohammad</surname><given-names>N.</given-names></name><name><surname>Babak</surname><given-names>T.</given-names></name><name><surname>Siu</surname><given-names>H.</given-names></name><name><surname>Hughes</surname><given-names>T.R.</given-names></name><name><surname>Morris</surname><given-names>Q.D.</given-names></name><etal/></person-group><article-title>Revealing global regulatory features of Mammalian alternative splicing using a quantitative microarray platform</article-title><source>Mol. Cell</source><year>2004</year><volume>16</volume><fpage>929</fpage><lpage>941</lpage><pub-id pub-id-type="pmid">15610736</pub-id></citation></ref><ref id="b17"><label>17</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>H.</given-names></name><name><surname>Hubbell</surname><given-names>E.</given-names></name><name><surname>Hu</surname><given-names>J.S.</given-names></name><name><surname>Mei</surname><given-names>G.</given-names></name><name><surname>Cline</surname><given-names>M.</given-names></name><name><surname>Lu</surname><given-names>G.</given-names></name><name><surname>Clark</surname><given-names>T.</given-names></name><name><surname>Siani-Rose</surname><given-names>M.A.</given-names></name><name><surname>Ares</surname><given-names>M.</given-names></name><name><surname>Kulp</surname><given-names>D.C.</given-names></name><etal/></person-group><article-title>Gene structure-based splice variant deconvolution using a microarray platform</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><fpage>i315</fpage><lpage>i322</lpage><pub-id pub-id-type="pmid">12855476</pub-id></citation></ref><ref id="b18"><label>18</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>C.</given-names></name><name><surname>Wang</surname><given-names>Q.</given-names></name></person-group><article-title>Bioinformatics analysis of alternative splicing</article-title><source>Brief Bioinform.</source><year>2005</year><volume>6</volume><fpage>23</fpage><lpage>33</lpage><pub-id pub-id-type="pmid">15826354</pub-id></citation></ref><ref id="b19"><label>19</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Sharov</surname><given-names>A.A.</given-names></name><name><surname>Dudekula</surname><given-names>D.B.</given-names></name><name><surname>Ko</surname><given-names>M.S.</given-names></name></person-group><article-title>Genome-wide assembly and analysis of alternative transcripts in mouse</article-title><source>Genome Res.</source><year>2005</year><volume>15</volume><fpage>748</fpage><lpage>754</lpage><pub-id pub-id-type="pmid">15867436</pub-id></citation></ref><ref id="b20"><label>20</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>P.</given-names></name><name><surname>Kim</surname><given-names>N.</given-names></name><name><surname>Lee</surname><given-names>Y.</given-names></name><name><surname>Kim</surname><given-names>B.</given-names></name><name><surname>Shin</surname><given-names>Y.</given-names></name><name><surname>Lee</surname><given-names>S.</given-names></name></person-group><article-title>ECgene: genome annotation for alternative splicing</article-title><source>Nucleic Acids Res.</source><year>2005</year><volume>33</volume><fpage>D75</fpage><lpage>D79</lpage><pub-id pub-id-type="pmid">15608289</pub-id></citation></ref><ref id="b21"><label>21</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Eyras</surname><given-names>E.</given-names></name><name><surname>Caccamo</surname><given-names>M.</given-names></name><name><surname>Curwen</surname><given-names>V.</given-names></name><name><surname>Clamp</surname><given-names>M.</given-names></name></person-group><article-title>ESTGenes: alternative splicing from ESTs in Ensembl</article-title><source>Genome Res.</source><year>2004</year><volume>14</volume><fpage>976</fpage><lpage>987</lpage><pub-id pub-id-type="pmid">15123595</pub-id></citation></ref><ref id="b22"><label>22</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Florea</surname><given-names>L.</given-names></name><name><surname>Di Francesco</surname><given-names>V.</given-names></name><name><surname>Miller</surname><given-names>J.</given-names></name><name><surname>Turner</surname><given-names>R.</given-names></name><name><surname>Yao</surname><given-names>A.</given-names></name><name><surname>Harris</surname><given-names>M.</given-names></name><name><surname>Walenz</surname><given-names>B.</given-names></name><name><surname>Mobarry</surname><given-names>C.</given-names></name><name><surname>Merkulov</surname><given-names>G.V.</given-names></name><name><surname>Charlab</surname><given-names>R.</given-names></name><etal/></person-group><article-title>Gene and alternative splicing annotation with AIR</article-title><source>Genome Res.</source><year>2005</year><volume>15</volume><fpage>54</fpage><lpage>66</lpage><pub-id pub-id-type="pmid">15632090</pub-id></citation></ref><ref id="b23"><label>23</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Heber</surname><given-names>S.</given-names></name><name><surname>Alekseyev</surname><given-names>M.</given-names></name><name><surname>Sze</surname><given-names>S.H.</given-names></name><name><surname>Tang</surname><given-names>H.</given-names></name><name><surname>Pevzner</surname><given-names>P.A.</given-names></name></person-group><article-title>Splicing graphs and EST assembly problem</article-title><source>Bioinformatics</source><year>2002</year><volume>18</volume><fpage>S181</fpage><lpage>S188</lpage><pub-id pub-id-type="pmid">12169546</pub-id></citation></ref><ref id="b24"><label>24</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Leipzig</surname><given-names>J.</given-names></name><name><surname>Pevzner</surname><given-names>P.</given-names></name><name><surname>Heber</surname><given-names>S.</given-names></name></person-group><article-title>The Alternative Splicing Gallery (ASG): bridging the gap between genome and transcriptome</article-title><source>Nucleic Acids Res.</source><year>2004</year><volume>32</volume><fpage>3977</fpage><lpage>3983</lpage><pub-id pub-id-type="pmid">15292448</pub-id></citation></ref><ref id="b25"><label>25</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>B.T.</given-names></name><name><surname>Tan</surname><given-names>T.W.</given-names></name><name><surname>Ranganathan</surname><given-names>S.</given-names></name></person-group><article-title>DEDB: a database of <italic>Drosophila melanogaster</italic> exons in splicing graph form</article-title><source>BMC Bioinformatics</source><year>2004</year><volume>5</volume><fpage>189</fpage><pub-id pub-id-type="pmid">15581431</pub-id></citation></ref><ref id="b26"><label>26</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Neverov</surname><given-names>A.D.</given-names></name><name><surname>Artamonova</surname><given-names>II</given-names></name><name><surname>Nurtdinov</surname><given-names>R.N.</given-names></name><name><surname>Frishman</surname><given-names>D.</given-names></name><name><surname>Gelfand</surname><given-names>M.S.</given-names></name><name><surname>Mironov</surname><given-names>A.A.</given-names></name></person-group><article-title>Alternative splicing and protein function</article-title><source>BMC Bioinformatics</source><year>2005</year><volume>6</volume><fpage>266</fpage><pub-id pub-id-type="pmid">16274476</pub-id></citation></ref><ref id="b27"><label>27</label><citation citation-type="confproc"><person-group person-group-type="author"><name><surname>Chang</surname><given-names>H.C.</given-names></name><name><surname>Yu</surname><given-names>P.S.</given-names></name><name><surname>Huang</surname><given-names>T.W.</given-names></name><name><surname>Lin</surname><given-names>Y.L.</given-names></name><name><surname>Hsu</surname><given-names>F.R.</given-names></name></person-group><article-title>The Application of Alternative Splicing Graphs in Quantitative Analysis of Alternative Splicing Form from EST Database</article-title><year>2004</year><conf-name>Fourth IEEE Symposium on Bioinformatics and Bioengineering (BIBE'04)</conf-name><fpage>293</fpage></citation></ref><ref id="b28"><label>28</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Haas</surname><given-names>B.J.</given-names></name><name><surname>Delcher</surname><given-names>A.L.</given-names></name><name><surname>Mount</surname><given-names>S.M.</given-names></name><name><surname>Wortman</surname><given-names>J.R.</given-names></name><name><surname>Smith</surname><given-names>R.K.</given-names><suffix>Jr</suffix></name><name><surname>Hannick</surname><given-names>L.I.</given-names></name><name><surname>Maiti</surname><given-names>R.</given-names></name><name><surname>Ronning</surname><given-names>C.M.</given-names></name><name><surname>Rusch</surname><given-names>D.B.</given-names></name><name><surname>Town</surname><given-names>C.D.</given-names></name><etal/></person-group><article-title>Improving the <italic>Arabidopsis</italic> genome annotation using maximal transcript alignment assemblies</article-title><source>Nucleic Acids Res.</source><year>2003</year><volume>31</volume><fpage>5654</fpage><lpage>5666</lpage><pub-id pub-id-type="pmid">14500829</pub-id></citation></ref><ref id="b29"><label>29</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Malde</surname><given-names>K.</given-names></name><name><surname>Coward</surname><given-names>E.</given-names></name><name><surname>Jonassen</surname><given-names>I.</given-names></name></person-group><article-title>A graph based algorithm for generating EST consensus sequences</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>1371</fpage><lpage>1375</lpage><pub-id pub-id-type="pmid">15572463</pub-id></citation></ref><ref id="b30"><label>30</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Roberts</surname><given-names>G.C.</given-names></name><name><surname>Smith</surname><given-names>C.W.</given-names></name></person-group><article-title>Alternative splicing: combinatorial output from the genome</article-title><source>Curr. Opin. Chem. Biol.</source><year>2002</year><volume>6</volume><fpage>375</fpage><lpage>383</lpage><pub-id pub-id-type="pmid">12023119</pub-id></citation></ref><ref id="b31"><label>31</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>C.W.</given-names></name><name><surname>Valcarcel</surname><given-names>J.</given-names></name></person-group><article-title>Alternative pre-mRNA splicing: the logic of combinatorial control</article-title><source>Trends Biochem. Sci.</source><year>2000</year><volume>25</volume><fpage>381</fpage><lpage>388</lpage><pub-id pub-id-type="pmid">10916158</pub-id></citation></ref><ref id="b32"><label>32</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Fededa</surname><given-names>J.P.</given-names></name><name><surname>Petrillo</surname><given-names>E.</given-names></name><name><surname>Gelfand</surname><given-names>M.S.</given-names></name><name><surname>Neverov</surname><given-names>A.D.</given-names></name><name><surname>Kadener</surname><given-names>S.</given-names></name><name><surname>Nogues</surname><given-names>G.</given-names></name><name><surname>Pelisch</surname><given-names>F.</given-names></name><name><surname>Baralle</surname><given-names>F.E.</given-names></name><name><surname>Muro</surname><given-names>A.F.</given-names></name><name><surname>Kornblihtt</surname><given-names>A.R.</given-names></name></person-group><article-title>A polar mechanism coordinates different regions of alternative splicing within a single gene</article-title><source>Mol. Cell</source><year>2005</year><volume>19</volume><fpage>393</fpage><lpage>404</lpage><pub-id pub-id-type="pmid">16061185</pub-id></citation></ref><ref id="b33"><label>33</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>J.</given-names></name><name><surname>Shendure</surname><given-names>J.</given-names></name><name><surname>Mitra</surname><given-names>R.D.</given-names></name><name><surname>Church</surname><given-names>G.M.</given-names></name></person-group><article-title>Single molecule profiling of alternative pre-mRNA splicing</article-title><source>Science</source><year>2003</year><volume>301</volume><fpage>836</fpage><lpage>838</lpage><pub-id pub-id-type="pmid">12907803</pub-id></citation></ref><ref id="b34"><label>34</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bell</surname><given-names>M.V.</given-names></name><name><surname>Cowper</surname><given-names>A.E.</given-names></name><name><surname>Lefranc</surname><given-names>M.P.</given-names></name><name><surname>Bell</surname><given-names>J.I.</given-names></name><name><surname>Screaton</surname><given-names>G.R.</given-names></name></person-group><article-title>Influence of intron length on alternative splicing of CD44</article-title><source>Mol. Cell Biol.</source><year>1998</year><volume>18</volume><fpage>5930</fpage><lpage>5941</lpage><pub-id pub-id-type="pmid">9742110</pub-id></citation></ref><ref id="b35"><label>35</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dempster</surname><given-names>A.P.</given-names></name><name><surname>Laird</surname><given-names>N.M.</given-names></name><name><surname>Rubin</surname><given-names>D.B.</given-names></name></person-group><article-title>Maximum likelihood from incomplete data via the EM algorithm (with discussion)</article-title><source>J. Royal Stat. Soc. B</source><year>1977</year><volume>39</volume><fpage>1</fpage><lpage>38</lpage></citation></ref><ref id="b36"><label>36</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Excoffier</surname><given-names>L.</given-names></name><name><surname>Slatkin</surname><given-names>M.</given-names></name></person-group><article-title>Maximum-likelihood estimation of molecular haplotype frequencies in a diploid population</article-title><source>Mol. Biol. Evol.</source><year>1995</year><volume>12</volume><fpage>921</fpage><lpage>927</lpage><pub-id pub-id-type="pmid">7476138</pub-id></citation></ref><ref id="b37"><label>37</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z.</given-names></name></person-group><article-title>PAML: a program package for phylogenetic analysis by maximum likelihood</article-title><source>Comput. Appl. Biosci.</source><year>1997</year><volume>13</volume><fpage>555</fpage><lpage>556</lpage><pub-id pub-id-type="pmid">9367129</pub-id></citation></ref><ref id="b38"><label>38</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Deng</surname><given-names>M.</given-names></name><name><surname>Mehta</surname><given-names>S.</given-names></name><name><surname>Sun</surname><given-names>F.</given-names></name><name><surname>Chen</surname><given-names>T.</given-names></name></person-group><article-title>Inferring domain-domain interactions from protein&#x02013;protein interactions</article-title><source>Genome Res.</source><year>2002</year><volume>12</volume><fpage>1540</fpage><lpage>1548</lpage><pub-id pub-id-type="pmid">12368246</pub-id></citation></ref><ref id="b39"><label>39</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Moses</surname><given-names>A.M.</given-names></name><name><surname>Chiang</surname><given-names>D.Y.</given-names></name><name><surname>Eisen</surname><given-names>M.B.</given-names></name></person-group><article-title>Phylogenetic motif detection by expectation-maximization on evolutionary mixtures</article-title><source>Pac. Symp. Biocomput.</source><year>2004</year><fpage>324</fpage><lpage>335</lpage><pub-id pub-id-type="pmid">14992514</pub-id></citation></ref><ref id="b40"><label>40</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hide</surname><given-names>W.A.</given-names></name><name><surname>Babenko</surname><given-names>V.N.</given-names></name><name><surname>van Heusden</surname><given-names>P.A.</given-names></name><name><surname>Seoighe</surname><given-names>C.</given-names></name><name><surname>Kelso</surname><given-names>J.F.</given-names></name></person-group><article-title>The contribution of exon-skipping events on chromosome 22 to protein coding diversity</article-title><source>Genome Res.</source><year>2001</year><volume>11</volume><fpage>1848</fpage><lpage>1853</lpage><pub-id pub-id-type="pmid">11691849</pub-id></citation></ref><ref id="b41"><label>41</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Modrek</surname><given-names>B.</given-names></name><name><surname>Lee</surname><given-names>C.</given-names></name></person-group><article-title>Alternative splicing in the human, mouse and rat genomes is associated with an increased rate of exon creation/loss</article-title><source>Nature Genet.</source><year>2003</year><volume>34</volume><fpage>177</fpage><lpage>180</lpage><pub-id pub-id-type="pmid">12730695</pub-id></citation></ref><ref id="b42"><label>42</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yeo</surname><given-names>G.</given-names></name><name><surname>Holste</surname><given-names>D.</given-names></name><name><surname>Kreiman</surname><given-names>G.</given-names></name><name><surname>Burge</surname><given-names>C.B.</given-names></name></person-group><article-title>Variation in alternative splicing across human tissues</article-title><source>Genome Biol.</source><year>2004</year><volume>5</volume><fpage>R74</fpage><pub-id pub-id-type="pmid">15461793</pub-id></citation></ref><ref id="b43"><label>43</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>McCullough</surname><given-names>R.M.</given-names></name><name><surname>Cantor</surname><given-names>C.R.</given-names></name><name><surname>Ding</surname><given-names>C.</given-names></name></person-group><article-title>High-throughput alternative splicing quantification by primer extension and matrix-assisted laser desorption/ionization time-of-flight mass spectrometry</article-title><source>Nucleic Acids Res.</source><year>2005</year><volume>33</volume><fpage>e99</fpage><pub-id pub-id-type="pmid">15967806</pub-id></citation></ref><ref id="b44"><label>44</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Meyers</surname><given-names>B.C.</given-names></name><name><surname>Vu</surname><given-names>T.H.</given-names></name><name><surname>Tej</surname><given-names>S.S.</given-names></name><name><surname>Ghazal</surname><given-names>H.</given-names></name><name><surname>Matvienko</surname><given-names>M.</given-names></name><name><surname>Agrawal</surname><given-names>V.</given-names></name><name><surname>Ning</surname><given-names>J.</given-names></name><name><surname>Haudenschild</surname><given-names>C.D.</given-names></name></person-group><article-title>Analysis of the transcriptional complexity of <italic>Arabidopsis thaliana</italic> by massively parallel signature sequencing</article-title><source>Nat. Biotechnol.</source><year>2004</year><volume>22</volume><fpage>1006</fpage><lpage>1011</lpage><pub-id pub-id-type="pmid">15247925</pub-id></citation></ref><ref id="b45"><label>45</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>C.</given-names></name><name><surname>Grasso</surname><given-names>C.</given-names></name><name><surname>Sharlow</surname><given-names>M.</given-names></name></person-group><article-title>Multiple sequence alignment using partial order graphs</article-title><source>Bioinformatics</source><year>2002</year><volume>18</volume><fpage>452</fpage><lpage>464</lpage><pub-id pub-id-type="pmid">11934745</pub-id></citation></ref><ref id="b46"><label>46</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kelly</surname><given-names>A.P.</given-names></name><name><surname>Monaco</surname><given-names>J.J.</given-names></name><name><surname>Cho</surname><given-names>S.G.</given-names></name><name><surname>Trowsdale</surname><given-names>J.</given-names></name></person-group><article-title>A new human HLA class II-related locus, DM</article-title><source>Nature</source><year>1991</year><volume>353</volume><fpage>571</fpage><lpage>573</lpage><pub-id pub-id-type="pmid">1922365</pub-id></citation></ref><ref id="b47"><label>47</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Sanderson</surname><given-names>F.</given-names></name><name><surname>Kleijmeer</surname><given-names>M.J.</given-names></name><name><surname>Kelly</surname><given-names>A.P.</given-names></name><name><surname>Verwoerd</surname><given-names>D.</given-names></name><name><surname>Tulp</surname><given-names>A.</given-names></name><name><surname>Neefjes</surname><given-names>J.</given-names></name><name><surname>Geueze</surname><given-names>H.J.</given-names></name><name><surname>Trowsdale</surname><given-names>J.</given-names></name></person-group><article-title>Accumulation of HLA-DM, a regulator of antigen presentation, in MHC class II compartments</article-title><source>Science</source><year>1994</year><volume>266</volume><fpage>1566</fpage><lpage>1569</lpage><pub-id pub-id-type="pmid">7985027</pub-id></citation></ref><ref id="b48"><label>48</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Weber</surname><given-names>D.A.</given-names></name><name><surname>Dao</surname><given-names>C.T.</given-names></name><name><surname>Jun</surname><given-names>J.</given-names></name><name><surname>Wigal</surname><given-names>J.L.</given-names></name><name><surname>Jensen</surname><given-names>P.E.</given-names></name></person-group><article-title>Transmembrane domain-mediated colocalization of HLA-DM and HLA-DR is required for optimal HLA-DM catalytic activity</article-title><source>J. Immunol.</source><year>2001</year><volume>167</volume><fpage>5167</fpage><lpage>5174</lpage><pub-id pub-id-type="pmid">11673529</pub-id></citation></ref><ref id="b49"><label>49</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Le</surname><given-names>K.</given-names></name><name><surname>Mitsouras</surname><given-names>K.</given-names></name><name><surname>Roy</surname><given-names>M.</given-names></name><name><surname>Wang</surname><given-names>Q.</given-names></name><name><surname>Xu</surname><given-names>Q.</given-names></name><name><surname>Nelson</surname><given-names>S.F.</given-names></name><name><surname>Lee</surname><given-names>C.</given-names></name></person-group><article-title>Detecting tissue-specific regulation of alternative splicing as a qualitative change in microarray data</article-title><source>Nucleic Acids Res.</source><year>2004</year><volume>32</volume><fpage>e180</fpage><pub-id pub-id-type="pmid">15598820</pub-id></citation></ref><ref id="b50"><label>50</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Sorek</surname><given-names>R.</given-names></name><name><surname>Basechess</surname><given-names>O.</given-names></name><name><surname>Safer</surname><given-names>H.M.</given-names></name></person-group><article-title>Expressed sequence tags: clean before using. Correspondence re: Z. Wang <italic>et al</italic>., computational analysis and experimental validation of tumor-associated alternative RNA splicing in human cancer. Cancer Res., <bold>63</bold>: 655&#x02013;657, 2003</article-title><source>Cancer Res.</source><year>2003</year><volume>63</volume><fpage>6996</fpage><comment>author reply 6996&#x02013;6997</comment><pub-id pub-id-type="pmid">14583502</pub-id></citation></ref><ref id="b51"><label>51</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Sorek</surname><given-names>R.</given-names></name><name><surname>Safer</surname><given-names>H.M.</given-names></name></person-group><article-title>A novel algorithm for computational identification of contaminated EST libraries</article-title><source>Nucleic Acids Res.</source><year>2003</year><volume>31</volume><fpage>1067</fpage><lpage>1074</lpage><pub-id pub-id-type="pmid">12560505</pub-id></citation></ref><ref id="b52"><label>52</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gupta</surname><given-names>S.</given-names></name><name><surname>Zink</surname><given-names>D.</given-names></name><name><surname>Korn</surname><given-names>B.</given-names></name><name><surname>Vingron</surname><given-names>M.</given-names></name><name><surname>Haas</surname><given-names>S.A.</given-names></name></person-group><article-title>Strengths and weaknesses of EST-based prediction of tissue-specific alternative splicing</article-title><source>BMC Genomics</source><year>2004</year><volume>5</volume><fpage>72</fpage><pub-id pub-id-type="pmid">15453915</pub-id></citation></ref><ref id="b53"><label>53</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>Q.</given-names></name><name><surname>Lee</surname><given-names>C.</given-names></name></person-group><article-title>Discovery of novel splice forms and functional analysis of cancer-specific alternative splicing in human expressed sequences</article-title><source>Nucleic Acids Res.</source><year>2003</year><volume>31</volume><fpage>5635</fpage><lpage>5643</lpage><pub-id pub-id-type="pmid">14500827</pub-id></citation></ref><ref id="b54"><label>54</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Z.</given-names></name><name><surname>Lo</surname><given-names>H.S.</given-names></name><name><surname>Yang</surname><given-names>H.</given-names></name><name><surname>Gere</surname><given-names>S.</given-names></name><name><surname>Hu</surname><given-names>Y.</given-names></name><name><surname>Buetow</surname><given-names>K.H.</given-names></name><name><surname>Lee</surname><given-names>M.P.</given-names></name></person-group><article-title>Computational analysis and experimental validation of tumor-associated alternative RNA splicing in human cancer</article-title><source>Cancer Res.</source><year>2003</year><volume>63</volume><fpage>655</fpage><lpage>657</lpage><pub-id pub-id-type="pmid">12566310</pub-id></citation></ref><ref id="b55"><label>55</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>C.</given-names></name><name><surname>Roy</surname><given-names>M.</given-names></name></person-group><article-title>Analysis of alternative splicing with microarrays: successes and challenges</article-title><source>Genome Biol.</source><year>2004</year><volume>5</volume><fpage>231</fpage><pub-id pub-id-type="pmid">15239822</pub-id></citation></ref></ref-list><sec sec-type="display-objects"><title>Figures and Tables</title><fig id="fig1" position="float"><label>Figure 1</label><caption><p>Splice graph of a three-exon alternatively spliced gene. (<bold>a</bold>) Gene structure for a three-exon gene. The second exon is a cassette exon. (<bold>b</bold>) The splice graph representation of the gene structure. The exon skipping event is represented by a directed edge from node 1 to node 3.</p></caption><graphic xlink:href="gkl396f1"/></fig><fig id="fig2" position="float"><label>Figure 2</label><caption><p>Probabilistic isoform reconstruction for a simulated gene. Left panel: sequence observations; right panel: results of probabilistic isoform reconstruction. The upper graph indicates the overall log likelihood; the lower graph shows the estimated probabilities for individual isoforms until convergence. <bold>A</bold>&#x02013;<bold>D</bold> represents different situations of sequence observations.</p></caption><graphic xlink:href="gkl396f2a"/><graphic xlink:href="gkl396f2b"/></fig><fig id="fig3" position="float"><label>Figure 3</label><caption><p>Simulation study to test the robustness of the EM algorithm. X-axis: the total number of sequence observations being simulated; Y-axis: the total variation distance between the true probabilities and the estimated probabilities (see Materials and Methods). (<bold>A</bold>) Simulation studies using fixed probabilities of four isoforms. The probabilities are listed in <xref ref-type="table" rid="tbl1">Table 1</xref>. (<bold>B</bold>) A simulation study using randomized probabilities of four isoforms.</p></caption><graphic xlink:href="gkl396f3"/></fig><fig id="fig4" position="float"><label>Figure 4</label><caption><p>Probabilistic isoform reconstruction for HLA-DMB. (<bold>A</bold>) Gene structure and alternative splicing of HLA-DMB. Exon 4 encodes the TM domain. Exon 5 encodes the LT signal. (<bold>B</bold>) Four putative isoforms of HLA-DMB. (<bold>C</bold>) Probabilistic isoform reconstruction of HLA-DMB. The upper graph indicates the overall log likelihood; the lower graph shows the estimated probabilities for individual isoforms until convergence. The FL form has the highest estimated probability, followed by &#x00394;-LT, &#x00394;-TM and &#x00394;-TM,LT. (<bold>D</bold>) RT&#x02013;PCR analysis of HLA-DMB isoforms in pooled human tissues (see Appendix 3 of the online supplements for details of the experiment). Left lane: marker; Right lane: HLA-DMB.</p></caption><graphic xlink:href="gkl396f4"/></fig><fig id="fig5" position="float"><label>Figure 5</label><caption><p>Probabilistic isoform reconstruction for TPM1. (<bold>A</bold>) The gene structure of TPM1 from exon 4 to exon 11. (<bold>B</bold>) EST evidence indicates coupled alternative splicing events in TPM1. (<bold>C</bold>) Probabilistic isoform reconstruction of TPM1. The upper graph indicates the overall log likelihood; the lower graph shows the estimated probabilities for individual isoforms until convergence. Only isoforms with &#x0003e;0.05 probability are shown in the graph.</p></caption><graphic xlink:href="gkl396f5"/></fig><fig id="fig6" position="float"><label>Figure 6</label><caption><p>CPU time of probabilistic isoform reconstruction for 186 genes on human chromosome 22. X-axis: numbers of putative isoforms. Y-axis: CPU time on a PC (AMD Athlon 1500+ with 320MB of RAM).</p></caption><graphic xlink:href="gkl396f6"/></fig><table-wrap id="tbl1" position="float"><label>Table 1</label><caption><p>The simulation study to test the robustness of the EM algorithm</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" colspan="1" rowspan="1">Isoform</th><th align="left" colspan="1" rowspan="1">Probability in set a</th><th align="left" colspan="1" rowspan="1">Probability in set b</th><th align="left" colspan="1" rowspan="1">Probability in set c</th><th align="left" colspan="1" rowspan="1">Probability in set d</th></tr></thead><tbody><tr><td align="left" colspan="1" rowspan="1">1-2-3-4-5-6-7-8-9-10</td><td align="left" colspan="1" rowspan="1">0.25</td><td align="left" colspan="1" rowspan="1">0.5</td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1">0.95</td></tr><tr><td align="left" colspan="1" rowspan="1">1-3-4-5-6-7-8-9-10</td><td align="left" colspan="1" rowspan="1">0.25</td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1">0.5</td><td align="left" colspan="1" rowspan="1">0</td></tr><tr><td align="left" colspan="1" rowspan="1">1-2-3-4-5-6-7-8-10</td><td align="left" colspan="1" rowspan="1">0.25</td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1">0.5</td><td align="left" colspan="1" rowspan="1">0</td></tr><tr><td align="left" colspan="1" rowspan="1">1-3-4-5-6-7-8-10</td><td align="left" colspan="1" rowspan="1">0.25</td><td align="left" colspan="1" rowspan="1">0.5</td><td align="left" colspan="1" rowspan="1">0</td><td align="left" colspan="1" rowspan="1">0.05</td></tr></tbody></table></table-wrap></sec></back></article>







<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id><journal-id journal-id-type="publisher-id">Nucleic Acids Research</journal-id><journal-title>Nucleic Acids Research</journal-title><issn pub-type="ppub">0305-1048</issn><issn pub-type="epub">1362-4962</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">16971460</article-id><article-id pub-id-type="pmc">PMC1635247</article-id><article-id pub-id-type="doi">10.1093/nar/gkl480</article-id><article-categories><subj-group subj-group-type="heading"><subject>Methods Online</subject></subj-group></article-categories><title-group><article-title>Homology modeling using parametric alignment ensemble generation with consensus and energy-based model selection</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Chivian</surname><given-names>Dylan</given-names></name><xref rid="au1" ref-type="aff">1</xref></contrib><contrib contrib-type="author"><name><surname>Baker</surname><given-names>David</given-names></name><xref rid="au1" ref-type="aff">1</xref><xref rid="au2" ref-type="aff">2</xref><xref ref-type="corresp" rid="cor1">*</xref></contrib><aff id="au1"><sup>1</sup><institution>Department of Biochemistry, University of Washington</institution><addr-line>Seattle, WA, USA</addr-line></aff><aff id="au2"><sup>2</sup><institution>Howard Hughes Medical Institute, Seattle</institution><addr-line>WA, USA</addr-line></aff></contrib-group><author-notes><corresp id="cor1"><sup>*</sup>To whom correspondence should be addressed at Department of Biochemistry and HHMI, University of Washington, Box 357350, Seattle, WA 98195, USA. Tel: +1 206 543 1295; Fax: +1 206 685 1792; Email: <email>dabaker@u.washington.edu</email></corresp><fn><p>Present address: Dylan Chivian, Lawrence Berkeley National Laboratory, Physical Biosciences Division, 1 Cyclotron Road, Mailstop 977-152, Berkeley, CA 94720, USA.</p></fn></author-notes><!--For NAR: both ppub and collection dates generated for PMC processing 1/27/05 beck--><pub-date pub-type="collection"><month>10</month><year>2006</year></pub-date><pub-date pub-type="ppub"><month>10</month><year>2006</year></pub-date><pub-date pub-type="epub"><day>13</day><month>8</month><year>2006</year></pub-date><volume>34</volume><issue>17</issue><fpage>e112</fpage><lpage>e112</lpage><history><date date-type="received"><day>31</day><month>12</month><year>2005</year></date><date date-type="rev-recd"><day>20</day><month>6</month><year>2006</year></date><date date-type="accepted"><day>21</day><month>6</month><year>2006</year></date></history><copyright-statement>&#x000a9; 2006 The Author(s)</copyright-statement><copyright-year>2006</copyright-year><license license-type="openaccess"><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/"/>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license><abstract><p>The accuracy of a homology model based on the structure of a distant relative or other topologically equivalent protein is primarily limited by the quality of the alignment. Here we describe a systematic approach for sequence-to-structure alignment, called &#x02018;K*Sync&#x02019;, in which alignments are generated by dynamic programming using a scoring function that combines information on many protein features, including a novel measure of how obligate a sequence region is to the protein fold. By systematically varying the weights on the different features that contribute to the alignment score, we generate very large ensembles of diverse alignments, each optimal under a particular constellation of weights. We investigate a variety of approaches to select the best models from the ensemble, including consensus of the alignments, a hydrophobic burial measure, low- and high-resolution energy functions, and combinations of these evaluation methods. The effect on model quality and selection resulting from loop modeling and backbone optimization is also studied. The performance of the method on a benchmark set is reported and shows the approach to be effective at both generating and selecting accurate alignments. The method serves as the foundation of the homology modeling module in the Robetta server.</p></abstract></article-meta></front><body><sec><title>INTRODUCTION</title><p>The millions of proteins that have been sequenced to date appear to have domains that are limited in the topologies they adopt to perhaps only a few thousand folds. Homology modeling, also called comparative modeling, takes advantage of topologically equivalent experimental structures and frequently is the best method for obtaining an accurate model of a protein. Identification of the correct relationship between similar regions of the two proteins, the alignment step, is critical to the accuracy of the model, and has proven difficult to accomplish well consistently for distant relatives. As a consequence, structural genomics initiatives, which will attempt to provide experimental structures or homology models for all proteins in genomes of interest, will have to solve many more structures experimentally in order to provide a reliable basis set of close homologs upon which to model the remainder of sequences (<xref ref-type="bibr" rid="b1">1</xref>). A homology modeling method that could provide higher quality models at greater evolutionary distance would allow for far fewer experimental structures to be solved, significantly reducing the expenditure of resources. The efforts in this study are focused on analyzing methods for improving the alignments between remote protein pairs.</p><p>The best techniques currently for remote homolog detection and alignment start with the comparison of acceptable residue substitutions (a frequency &#x02018;profile&#x02019;) at each position determined from multiple sequence alignments (<xref ref-type="bibr" rid="b2">2</xref>&#x02013;<xref ref-type="bibr" rid="b11">11</xref>), because such methods better span evolutionary space than single sequence comparisons. Fold-recognition methods, which attempt to identify topologically similar structures that are not necessarily evolutionarily related to the query, often also utilize structural information to their benefit. They incorporate such terms as predicted secondary structure (<xref ref-type="bibr" rid="b12">12</xref>&#x02013;<xref ref-type="bibr" rid="b14">14</xref>), solvent accessibility (<xref ref-type="bibr" rid="b13">13</xref>,<xref ref-type="bibr" rid="b15">15</xref>), use information from structurally aligned homologs (<xref ref-type="bibr" rid="b16">16</xref>) or score alignments with threading potentials (<xref ref-type="bibr" rid="b17">17</xref>,<xref ref-type="bibr" rid="b18">18</xref>).</p><p>Additionally, groups have investigated the ability to obtain improved alignments and models through generation of ensembles by genetic (<xref ref-type="bibr" rid="b19">19</xref>,<xref ref-type="bibr" rid="b20">20</xref>), suboptimal (<xref ref-type="bibr" rid="b21">21</xref>&#x02013;<xref ref-type="bibr" rid="b26">26</xref>) and parametric (<xref ref-type="bibr" rid="b24">24</xref>,<xref ref-type="bibr" rid="b27">27</xref>&#x02013;<xref ref-type="bibr" rid="b29">29</xref>) approaches. Such approaches have the goal of first generating high-quality alignments, and then selecting the best in the set, usually by evaluating the resultant models for protein-like characteristics (<xref ref-type="bibr" rid="b19">19</xref>,<xref ref-type="bibr" rid="b20">20</xref>,<xref ref-type="bibr" rid="b26">26</xref>,<xref ref-type="bibr" rid="b29">29</xref>,<xref ref-type="bibr" rid="b30">30</xref>). These methods primarily select from their ensembles by evaluating the models (also called &#x02018;decoys&#x02019;) with various energy functions, and do not incorporate consensus information.</p><p>Other methods, rather than generating their own set of alignments, utilize a set of models from fold-recognition servers to develop a consensus from which models are either selected or derived (<xref ref-type="bibr" rid="b31">31</xref>&#x02013;<xref ref-type="bibr" rid="b36">36</xref>). The principle behind these methods is essentially one of increasing the signal-to-noise: there are so many incorrect folds, that if several different methods report similar fold assignments, then that fold is far more likely to be correct.</p><p>Once a fold and an alignment to it is obtained, modeling the complete protein including insertion and deletion events and other variable regions requires turning to other techniques to find the conformation of such missing portions. Various methods exist for this task, commonly called &#x02018;loop modeling&#x02019; (<xref ref-type="bibr" rid="b37">37</xref>&#x02013;<xref ref-type="bibr" rid="b41">41</xref>), from purely <italic>de novo</italic> to application of fragments from experimental structures.</p><p>It is commonly accepted that sequence changes more rapidly than structure. However, this statement is mostly made from a low-resolution perspective, such as the consideration of the topology of a protein domain. One complication present in homology modeling, especially when the scaffold utilized is a distant relative of the query protein, results from the perturbations to the backbone that result from differing sequences. Even in the circumstance that two proteins share the same topology and approximate arrangement of residues in the core, the local and global perturbations that result from the specific sequence may make identification of the true conformation challenging. Clashes may exist between contacting residues, or bad backbone torsional arrangements may arise such as from changing a residue at a given position from a glycine or proline (<xref ref-type="bibr" rid="b37">37</xref>). Such imperfections, although the model may be topologically correct, require &#x02018;refinement&#x02019; of the model to make it more native-like (<xref ref-type="bibr" rid="b42">42</xref>&#x02013;<xref ref-type="bibr" rid="b44">44</xref>).</p><p>Here we describe a method for aligning sequences to known structures by parametrically generating an alignment ensemble and its derivative model ensemble. The method includes a novel approach for incorporation of information about regions likely to be obligate to a given fold. We generate very large ensembles that are quite diverse and usually approach the approximate upper bound obtainable with a structure&#x02013;structure alignment between the query native structure and the best parent structure. In addition to sampling better alignments, these large ensembles allow for derivation of a more reliable consensus that provides for the ability to select quite good models from each ensemble. Additionally, we have investigated the ability to discriminate the best models using hydrophobic burial and energy functions based on low- and high-resolution representations and have examined techniques for combining these approaches to allow for improved selection. The impact of loop modeling and backbone optimization on model quality and selection is also studied. The approach has many different inputs and stages, and we therefore chose to call our method &#x02018;K*Sync&#x02019;, inspired by the expression &#x02018;everything but the kitchen sink&#x02019;.</p></sec><sec sec-type="materials|methods"><title>MATERIALS AND METHODS</title><sec><title>Availability</title><p>K*Sync is integrated into the Robetta server (<ext-link ext-link-type="uri" xlink:href="http://robetta.org/"/>), and can be used there as the foundation of the homology modeling protocol. Additionally, the K*Sync program itself and supporting programs are freely available to non-commercial users under license, and can be downloaded from the Robetta server.</p></sec><sec><title>Modeling complete domains</title><p>Complete domains are the best scaffolds to use for homology modeling (<xref ref-type="bibr" rid="b15">15</xref>). Extra pieces from peripheral domains, or incomplete scaffolds, may mislead both alignment methods and the ability to discriminate models using energy methods that expect well-formed cores. Therefore, after a parent structure has been detected, we apply a consensus structure-based parsing method that we have developed which applies Taylor's domain parsing method (<xref ref-type="bibr" rid="b45">45</xref>) to the parent and PSI-BLAST (4,47) detectable structural homologs (D. Chivian, manuscript in preparation) to automatically divide the parent structure into domains. Even when using an experimental structure to assign the domains of a protein chain, the exact definition of the locations of the domains varies depending on the method used or the member of the protein family examined. The application of consensus to the parses determined from a set of homologous structures allows for a more consistent definition of the edges of the domains within the protein family (and sometimes even the number of domains). We compared the agreement between our consensus based on homologous structures with the domain definitions in the CATH domain structure database (<xref ref-type="bibr" rid="b46">46</xref>) (which itself uses a consensus obtained with several domain parsing methods), and found our agreement to be improved over the already quite good agreement from domain parsing with a single structure (D. Chivian, manuscript in preparation). Fortunately, most of the disagreement between methods is with regard to the precise boundary (&#x0223c;30% of boundaries with an identical edge definition, &#x0223c;67% within 5 residues and &#x0223c;85% within 20 residues), so large errors in the alignment that result from inaccurate domain boundaries are usually not introduced.</p><p>Further modeling considers the entirety of those domains from the homologous parent structure that the detection method indicates are present in our query. This has the advantage of including regions of the parent that may be obligate to the fold, but may not have been included in the detection. Additionally, knowledge of the domain boundary allows us to perform an alignment that favors the ends of the parent structure to be aligned for those positions that are found to be obligate to the fold in a multiple alignment. We therefore refer to alignments that are &#x02018;local&#x02019; (not penalizing unaligned ends) with respect to the query and &#x02018;global&#x02019; (penalizing unaligned ends) with respect to the parent as &#x02018;domain&#x02019; scope alignments.</p></sec><sec><title>Detection of suitable parents</title><p>We use established methods for the detection of parent scaffolds to use for modeling. PSI-BLAST (<xref ref-type="bibr" rid="b4">4</xref>,<xref ref-type="bibr" rid="b47">47</xref>) is used for the more closely related proteins, FFAS03 (<xref ref-type="bibr" rid="b48">48</xref>) for the detection of intermediate distance proteins that are not detectable with a reasonable confidence by PSI-BLAST and the 3D-Jury (<xref ref-type="bibr" rid="b32">32</xref>) consensus method for the most remote fold-recognition regime (thresholds for confidence are given in the description of the LiveBench-8 set below). The K*Sync alignment method then seeks to generate alignments better than those produced by the detection method.</p></sec><sec><title>Single K*Sync default alignment</title><p>The K*Sync default method uses dynamic programming (<xref ref-type="bibr" rid="b49">49</xref>&#x02013;<xref ref-type="bibr" rid="b54">54</xref>), together with a combination of sequence-based and structure-based scoring terms. We used the K*Sync default method in CASP4 and CASP5, as described previously (<xref ref-type="bibr" rid="b55">55</xref>). It uses a linear combination of terms derived from (i) sequence profile to sequence profile comparison, (ii) matches of predicted secondary structure of the query to known secondary structure of the parent and (iii) matches of regions that appear to be obligate in multiple alignments. Also included are (iv) gap terms: a base gap initiation and extension penalty, as well as a term to avoid gapping in regular secondary structure of the parent as well as regions that appear to be contiguous in multiple alignments.
<list list-type="roman-lower"><list-item><p><italic>Sequence information</italic>: PSI-BLAST generated position-specific residue substitution profiles (from searching for sequence homologs in the NR non-redundant sequence database from the NCBI) for the query and the parent are compared by inner product in K*Sync's default mode. This produces a pair score distribution which is adjusted to possess a mean below zero (&#x02212;0.12) and a standard deviation of 1.0 in the same fashion as FFAS (<xref ref-type="bibr" rid="b5">5</xref>,<xref ref-type="bibr" rid="b6">6</xref>). Residue profiles are adjusted to include counts from multiple structural alignments [either FSSP (<xref ref-type="bibr" rid="b56">56</xref>) alignments or our &#x02018;StrAD-Stack&#x02019; alignments, see Supplementary Data] to allow for more distant residue sampling than might be available with sequence-only homolog detections (<xref ref-type="bibr" rid="b16">16</xref>). In all development and benchmarking, the query and its close sequence relatives are not included in the multiple structural alignment.</p></list-item><list-item><p><italic>Secondary structure</italic>: Secondary structure is added into the pair scores by giving a bonus to matches of PSIPRED (<xref ref-type="bibr" rid="b57">57</xref>) predicted query regular secondary structure (helix and strand only) with DSSP (<xref ref-type="bibr" rid="b58">58</xref>) assigned parent regular secondary structure, with a penalty for mismatches, weighted by the confidence of the prediction. The base secondary structure pair score for each combination of positions ranges between &#x02212;1.0 and 1.0.</p></list-item><list-item><p><italic>Obligate elements</italic>: A novel pair term is included to attempt to match positions that appear to be obligate to the fold. Positions that are usually occupied in a multiple alignment are more likely to be obligate to the fold, whereas infrequently aligned positions are likely insertions (or at least conformationally variable). The &#x02018;occupancy obligateness&#x02019; of a position in the parent sequence is therefore based on the fraction of aligned residues at that position in the multiple structural alignment, and with less reliability the occupancy in the PSI-BLAST multiple sequence alignment. A bonus is given to matches of occupancy obligate positions with each other and a penalty to matches of occupancy obligate positions with insertions, with weighting based on the degree of occupancy of the obligate position. The base obligate pair score for each combination of positions ranges between &#x02212;1.0 and 1.0. Additionally, to increase the fidelity for obligate positions of the parent, a multiplier is applied to the sequence-based pair scores for such positions. Finally, the pair distribution is adjusted to restore the desired mean and standard deviation.</p></list-item><list-item><p><italic>Gaps</italic>: Gaps are penalized with position-specific initiation and extension penalties for the query and parent. Each position starts with the base value that is appropriate to a sequence-only alignment (which are 4.02 for gap initiation and 0.40 for gap extension when using inner product for residue substitution profile comparison), to which are added the structurally determined penalties. In addition to penalizing the introduction of a gap into regular secondary structure in the parent, structural gap penalties are determined from the multiple alignments. Highly occupied positions that never have insertions between them are considered &#x02018;contiguous obligate&#x02019;. The values are adjusted to penalize failure to align obligate positions (by increasing the gap extension penalty at such positions) and for inserting a gap between two contiguous obligate positions (by increasing the gap initiation penalty between such positions). The gap initiation penalty is reduced for positions that tolerate insertions in the multiple alignment. The final distributions of gap values are not adjusted.</p></list-item></list></p><p>Dynamic programming is then performed to produce a single default alignment that captures all of the sequence and structural information that has been embodied in the pair and gap terms (<xref ref-type="fig" rid="fig1">Figure 1</xref>). Quantitative details for the pair and gap terms and the procedure for determining the weights on the individual terms are provided in Supplementary Data.</p></sec><sec><title>Parametric alignment ensemble generation</title><p>Alignment ensembles for each of up to 5 parents are generated by varying the weights on each of the contributions to the alignment score, as well as the source of input information, following the approach we used to obtain alignment ensembles in CASP5 (<xref ref-type="bibr" rid="b55">55</xref>,<xref ref-type="bibr" rid="b59">59</xref>) and CASP6 (<xref ref-type="bibr" rid="b60">60</xref>). Weights on each structure-based pair and gap term are varied in isolation, taking on the values zero, half the optimal value for a single default alignment, the optimal value itself, 1.5 times the optimal value, and finally twice the optimal value. Additional variation comes from allowing the alignments to be either local&#x02013;local or local&#x02013;global in scope.</p><p>We also allow the method for sequence comparison to vary. Methods include a direct lookup from the BLOSUM62 score matrix (<xref ref-type="bibr" rid="b61">61</xref>) (single sequence against single sequence), looking up the score for the parent residue in the position-specific score matrix (PSSM) obtained for the query by several rounds of PSI-BLAST (profile against single sequence), or the reverse lookup of the query residue in the parent's PSSM (single sequence against profile), as well as the average of the scores from these latter two lookups. The profile&#x02013;profile comparison methods that we use include the inner product of the pseudo-counted residue frequencies from PSI-BLAST or a city-block frequency vector comparison (with a distribution adjusted in a similar fashion as in the inner product method). Lastly, a &#x02018;PSSM cross&#x02019; consisting of a linear combination of the PSSM scores for the query sequence with the effective frequencies for the parent sequence, and vice versa [similar to the approaches of PICASSO (<xref ref-type="bibr" rid="b7">7</xref>) and COMPASS (<xref ref-type="bibr" rid="b9">9</xref>)], was employed (see Supplementary Data).</p><p>Other means of obtaining variation are inspired by the inability to determine a priori the best method for secondary structure prediction for a given target, the best stringency for residue substitution profile generation, or the degree of structural variation to permit in the multiple structural alignment. We use three secondary structure prediction methods in the parametric ensemble generation, PSIPRED (<xref ref-type="bibr" rid="b57">57</xref>), SAM-T99 (<xref ref-type="bibr" rid="b62">62</xref>,<xref ref-type="bibr" rid="b63">63</xref>) and JUFO (<ext-link ext-link-type="uri" xlink:href="http://www.jens-meiler.de/"/>). Various residue frequency profiles are also obtained for the sequence comparisons, such as a stringent profile from two rounds of PSI-BLAST at an <italic>E</italic>-value for inclusion of 10<sup>&#x02212;9</sup>, a looser profile started from the stringent checkpoint with one round at <italic>E</italic>-value 10<sup>&#x02212;6</sup>, followed by another at <italic>E</italic>-value 10<sup>&#x02212;3</sup>. Two even looser profiles, for a total of four PSI-BLAST multiple sequence alignments, are obtained by single additional rounds at <italic>E</italic>-value 10<sup>&#x02212;3</sup>. In the case of multiple structural alignment derived profiles of the parent, we used FSSP multiple alignments for the early development of the method, but have switched over to our in-house StrAD-Stack method. With the FSSP multiple alignments, we used non-redundant structural homologs that had at least <italic>Z</italic>-scores of 10.0, 7.0 and 4.0 when aligned to the parent PDB structure. With StrAD&#x02013;Stacdk alignments the <italic>Z</italic>-scores for non-redundant structures were 3.5, 2.5 and 1.5 (which are lower due to the tighter but more meaningful distribution as described in the Supplementary Data).</p><p>The above inputs and weights on terms are grid sampled as described above to produce initial alignment ensembles of 46 083 members for each parent [taking &#x0223c;10 min on a computer cluster with 54 AMD Athlon&#x02122; MP 1600+ processors], yielding initial ensembles with up to 230&#x02009;415 members for those targets with five candidate parents. Alignment ensembles are then reduced to a non-redundant set, with redundancy defined as those alignments that are identical in all aligned and gapped positions to a given parent. This yields a non-redundant ensemble of typically a few thousand members per parent (e.g. in the LiveBench-8 set of targets, the ensembles for each parent were reduced, on average, to a size of &#x0223c;2500 members, with the greatest size being 8226 members, and the bulk of the distribution roughly between 500 and 4000 members). In order to minimize the expenditure of resources during more expensive modeling phases of the protocol, to allow for analysis less complicated by variable ensemble sizes, and potentially to enrich the consensus derived from the set of alignments for the more remote pairs (discussed for Figure 8 below), ensembles are further reduced to no more than 1000 members per parent (yielding combined ensembles no larger than 5000 members) by discarding alignments produced with information expected to be less likely to introduce diversity (such as profiles produced by intermediate rounds of PSI-BLAST) or less likely to be reliable for remote pairs (such as sequence comparison by straightforward BLOSUM lookup). For each parent, a series of reduction steps is applied until the ensemble size for each given parent is below the threshold of 1000, beginning with the variation in the bias term for highly occupied positions, followed by the variation of the weight on secondary structure gap terms, the inclusion of the sequence comparison by the BLOSUM matrix alone and so on (the full succession of stages is described in Supplementary Data).</p></sec><sec><title>Loop modeling</title><p>We have modified the Rosetta <italic>de novo</italic> fragment-replacement approach to make a hybrid loop modeling method (<xref ref-type="bibr" rid="b40">40</xref>) that models structurally variable regions that are not provided by the template.</p><p>Regions of the template that adjoin loop regions, called &#x02018;stems&#x02019;, are trimmed back to allow for spatially reasonable insertions. Since the ability to model a loop well often depends on the choice of which residues should be the edge of each stem, we added two variants to the trimmed ensemble for modeling. The first variant trims two residues into each stem, or as many as necessary to ensure that at least seven residues are unaligned in both the query and the parent. The second method trims back by at least one residue (extending until the modeled region corresponds to at least five residues for both the query and the parent), but continues to trim until it is at least one residue into a regular secondary structural element, since such &#x02018;well-anchored&#x02019; positions are expected to usually be more stable within folds.</p><p>Loop regions are then modeled in the context of the fixed template using Rosetta (<xref ref-type="bibr" rid="b40">40</xref>). For short and medium loops (&#x02264;11 residues and &#x02264;16 residues, respectively), &#x0223c;200 initial conformations are selected from a database of known structures using similarity of sequence, secondary structure and stem geometry. The closure of the loops is then optimized using cyclic coordinate descent (<xref ref-type="bibr" rid="b64">64</xref>), followed by optimization of the conformations in the context of the template by use of the standard Rosetta potential (<xref ref-type="bibr" rid="b65">65</xref>). PSI-BLAST level targets are optimized with a full-atom representation of the side-chains using a rotamer library (<xref ref-type="bibr" rid="b66">66</xref>). The loops of the more remote targets are optimized using the side-chain centroid representation. Conformations that have already passed filters based on their fit with the stems and the template are then selected in combination by simultaneous optimization starting from a random selection of initial conformations to try to achieve a combination of loop conformations compatible the other loops. Decoys that do not possess loops that close with the stem are removed from the ensemble. Long loops (&#x02265;17 residues) are then modeled using a modified version of Rosetta's <italic>de novo</italic> protocol similar to the short and medium loops, but without a starting conformation (40).</p></sec><sec><title>Modeling perturbations to the backbone</title><p>In an effort to make the models more similar to the query native structure and resolve steric clashes and bad backbone torsional arrangements, we have developed a protocol to allow for refining the entire model conformation using a low-resolution side-chain centroid-based energy function. The process begins by modifying the coordinates of the backbone structures to possess idealized bond lengths and angles to simplify sampling of conformations in torsional space. The entire length of the model is then perturbed in a Monte Carlo search procedure to find a lower energy conformation. In order to prevent the structure from diverging too far as a result of fragment-replacement or excessive expansion of the structure in an effort to alleviate steric clashes, distance restraints for non-local contacts based on the starting conformation are applied.</p></sec><sec><title>SCOP1.38 training and test sets</title><p>Following an earlier study (<xref ref-type="bibr" rid="b67">67</xref>), we built a training set of 524 mostly low identity pairs (&#x0003c;40% identity upon a structure&#x02013;structure alignment) with one pair per family and one per superfamily from SCOP1.38 (<xref ref-type="bibr" rid="b68">68</xref>). This training set was used to obtain the optimal values for the sequence-only profile&#x02013;profile pair score distribution mean and gap initiation and extension penalties, as measured by the similarity to &#x02018;gold standard&#x02019; CE (<xref ref-type="bibr" rid="b69">69</xref>) structure&#x02013;structure alignments between the query native and the parent native structures. Comparison of a predicted alignment with a &#x02018;gold-standard&#x02019; alignment may be viewed from either the perspective of &#x02018;accuracy&#x02019; (equivalent to &#x02018;specificity&#x02019;: the fraction of the predicted alignment that agrees exactly with the gold-standard alignment, with no tolerance for alignment to neighboring residues) or &#x02018;completeness&#x02019; (equivalent to &#x02018;sensitivity&#x02019;: the fraction of the gold-standard alignment achieved exactly by the predicted alignment. Accuracy and completeness are discussed further in Supplementary Data). Since we wished our alignments to be both complete and accurate, we used the sum of the accuracy and completeness as the tuning metric. We then obtained the optimal values for the weights on the structural guidance terms (as described in Supplementary Data).</p><p>We also built a test set (that had no overlaps with the training set and were also mostly low identity) of 356 pairs from SCOP1.38 (168 families and superfamilies that were in the training set were not represented in the test set as they were the only pair in the family or superfamily). The single pair per family or superfamily requirement allowed us to avoid bias towards well-represented folds, in particular immunoglobulins and globins.</p></sec><sec><title>LiveBench-8 benchmark target set</title><p>In order to assess the performance of our ensemble generating and selection approach with a more standard benchmark, we turned to the set of targets from the LiveBench-8 experiment (<xref ref-type="bibr" rid="b70">70</xref>). These targets were newly released PDB structures that lacked BLAST-level similarity with any previously released structure. We selected for analysis those targets for which a homologous structure was detectable with sufficient confidence by PSI-BLAST (<italic>E</italic>-value &#x02264; 0.001), FFAS03 (ffas score &#x02264; &#x02212;20.0) or 3D-Jury (3djury score &#x02265; 25.0). We additionally limited the targets to those for which the top confidence parent provided at least 40% of the query native structure by MAMMOTH's (<xref ref-type="bibr" rid="b71">71</xref>) implementation of MaxSub (<xref ref-type="bibr" rid="b72">72</xref>) (which reveals the percentage of the native structure that is captured by the model. Greater detail on MAMMOTH MaxSub is provided in Supplementary Data) so that spurious hits would not complicate our analysis. This left us with 98 targets: 27 targets at the most challenging 3D-Jury level, 9 targets at the intermediate FFAS03 level and 62 targets at the PSI-BLAST level (for the list of targets see Supplementary Table SI).</p></sec><sec><title>Ensembles built from multiple parents</title><p>While the highest confidence homolog provided by the detection method is often the best parent on which to build a homology model, there are situations where alternate parents that have detection confidence scores close to the top scoring parent may provide a scaffold that is more similar to the native structure of the query. When we allowed up to five non-identical parents that are not dramatically different in confidence but possesses as much diversity in sequence as possible from the top scoring parent (at least an <italic>E</italic>-value of 10<sup>&#x02212;3</sup> and within 10<sup>&#x02212;15</sup> of the top hit for PSI-BLAST detections, at least &#x02212;8.0 and within 12.0 of the top confidence hit for FFAS03 detections, and at least 20.0 and within 30.0 of the top hit for 3D-Jury detections), we found that the best possible parent (as measured by the MAMMOTH MaxSub quality of the best 3D-Pair (<xref ref-type="bibr" rid="b73">73</xref>) structural alignment derived template) on average increased from 70.6 to 73.4% coverage for PSI-BLAST level targets, from 63.8 to 65.5% for FFAS03 level targets, and from 60.4 to 62.1% for 3D-Jury level targets. Thus, building ensembles derived from these parents is sometimes advantageous for improved sampling of near-native models.</p><p>Although the improvement from allowing alternate parents is not enormous when viewed with respect to the ability to optimally build a model, using multiple parents becomes more significant when generating and selecting from model ensembles. The ability of the parametric alignment protocol to sample the best alignments may be affected by the choice of parent. Additionally, selection from the model ensemble may be easier for some parents due to the details of the backbone and the arrangement of non-local contacts that may lend some parent scaffolds to be better suited upon which to drape the query sequence. Rather than attempt to determine the best parent at the outset with which to perform subsequent modeling, ensembles are built for each parent. Those ensembles are then simultaneously selected from using both an alignment consensus score and using energy functions (as discussed below in Results) with the hope that at least one of the parents has provided high-quality alignments and possesses a scaffold that fits well with the query sequence and therefore can be discerned. Additionally, as will be discussed in Results, multiple parents are particularly valuable when scoring alignments by consensus.</p></sec></sec><sec><title>RESULTS</title><p>As described in Materials and Methods, the K*Sync default alignment method combines information from a broad range of sources, including sequence information from homologous sequences, predicted and known secondary structure, and information from multiple alignments that indicates regions corresponding to core elements that are required for the fold. Mathematically optimal alignments are found by dynamic programming (<xref ref-type="bibr" rid="b49">49</xref>&#x02013;<xref ref-type="bibr" rid="b54">54</xref>), which may be compared from the perspective of &#x02018;accuracy&#x02019; and &#x02018;completeness&#x02019; with &#x02018;gold-standard&#x02019; alignments achieved by structure&#x02013;structure alignment methods (Supplementary Data), or by MAMMOTH MaxSub comparison of the model produced by the alignment with the native structure of the query (Supplementary Data). Alignments superior to the single default K*Sync alignment may be obtained parametrically by varying the source of the input information and the weights on terms in the alignment to produce an alignment ensemble (and its derivative model ensemble). Selection of superior models may be achieved by examination of the resultant models for protein-like characteristics as well as consistency with respect to the consensus of ensemble.</p><p>Below we test the default K*Sync method on a benchmark created from the SCOP1.38 (<xref ref-type="bibr" rid="b68">68</xref>) structure database using CE (<xref ref-type="bibr" rid="b69">69</xref>) structure&#x02013;structure alignments as the &#x02018;gold standard&#x02019;. Then, employing a benchmark of targets from the LiveBench-8 (<xref ref-type="bibr" rid="b70">70</xref>) experiment, we evaluate the ability of the K*Sync parametric alignment ensemble approach to sample the best possible alignments, as measured by comparison to the native structure of the query. We then analyze strategies for selection of superior models from the ensemble. The impact on model quality and selection resulting from loop modeling and backbone refinement is also discussed.</p><sec><title>Performance of K*Sync default method</title><p>A sustained improvement in alignment quality was found by the application of our structural guidance terms. The performance on our SCOP1.38 test set (Materials and Methods) using &#x02018;domain-scope&#x02019; alignments of baseline profile-sequence alignments (using a position-specific scoring matrix, or &#x02018;PSSM&#x02019; built by PSI-BLAST), the baseline profile&#x02013;profile alignments (using an inner product comparison of frequencies from PSI-BLAST) and the K*Sync default alignments is reported in <xref ref-type="fig" rid="fig2">Figure 2</xref>. The &#x02018;accuracy&#x02019; and &#x02018;completeness&#x02019; of alignments (as described in Materials and Methods under the SCOP1.38 training and test sets, as well as in Supplementary Data) are shown with respect to the CE structure&#x02013;structure alignment between the query native and the parent structure. Also shown is the overlap of Dali structure&#x02013;structure alignments (<xref ref-type="bibr" rid="b56">56</xref>) with the CE structure&#x02013;structure alignments.</p><p>As has been shown previously by other groups (<xref ref-type="bibr" rid="b3">3</xref>,<xref ref-type="bibr" rid="b5">5</xref>&#x02013;<xref ref-type="bibr" rid="b11">11</xref>) alignment quality is improved on average for distant pairs by the use of profile&#x02013;profile alignments over profile-sequence methods such as PSI-BLAST (<xref ref-type="bibr" rid="b4">4</xref>,<xref ref-type="bibr" rid="b47">47</xref>). We find that the addition of structural terms boosts this performance when measured by both accuracy and completeness. Although the K*Sync default alignment does improve over the sequence-only approaches in the remote regime, it is not at the level of similarity between the Dali and CE alignments, and even with these crude measures of alignment quality, it is clear that there is more room for improvement over the K*Sync default.</p><p>The Dali structural alignments do not agree exactly with the CE structural alignments as the sequences diverge. This discrepancy is due to the requirement in the accuracy and completeness measures that correctly aligned residues are exactly the same as in the &#x02018;gold-standard&#x02019; alignment, and not aligned to neighboring residues. As the neighbor requirement is relaxed, the structure&#x02013;structure alignment methods do show more agreement in accuracy and completeness (data not shown), indicating that the alignments are at least close (such as to neighboring residues on a helix) and highlighting the weakness with using agreement with a structure&#x02013;structure alignment to measure of the quality of an alignment.</p><p>Comparison of the K*Sync default alignments with and without the obligate terms (<xref ref-type="table" rid="tbl1">Table 1</xref>) reveals that inclusion of obligate terms introduces the greatest variation in the remote identity regime. The impact seems to be greatest below 30% sequence identity, where &#x0223c;10&#x02013;20% of alignments may benefit a significant amount (&#x0003e;5%) from the inclusion of the obligate terms at their default weighting. However, about an equal number of targets are better off without the use of the obligate terms. Not surprisingly, multiple alignments that lack sufficient variation in occupancy are responsible for the majority of the cases where the alignment is superior without the obligate terms. Unfortunately, not all of the cases where the alignment suffered from inclusion of the obligate terms at the default weighting could be explained by the occupancy information-poor targets, and it proved difficult to find a rule that works in all cases for when to include the obligate terms or how much to weigh them. Similar results were observed for the other terms and parameters in K*Sync and were the inspiration for considering alignment ensembles rather than single alignments.</p></sec><sec><title>K*Sync alignment ensemble generation</title><p>Although it is certainly desirable for a method that produces, on average, improved alignments for remote protein pairs, often a still better alignment could have been achieved had one used a different way to score the sequence similarity of positions, a different scope of the alignment (local&#x02013;local or local&#x02013;global), different input information such as an alternate secondary structure prediction method, different stringencies and/or rounds of PSI-BLAST when generating the residue substitution profiles, different stringencies on which parents to include in the multiple structural alignment of the parent, or different weights on the structure terms when including them in the pair or gap scores of the alignment. We followed this approach (shown in <xref ref-type="fig" rid="fig1">Figure 1</xref>, and described in Materials and Methods) to parametrically generate large ensembles of alignments. We reasoned that adjusting the way in which the input information affects the alignment might allow us to obtain even better alignments and more dramatic variation than alignment methods based only on sequence information for more remote targets.</p></sec><sec><title>Sampling of the best possible alignment</title><p>Examination of the quality of K*Sync ensembles reveals that they are quite good at sampling close to the best possible alignment. <xref ref-type="fig" rid="fig3">Figure 3</xref> shows that, for the majority of targets in our LiveBench-8 benchmark, the ensemble samples alignments of quality equal to or quite close to the 3D-Pair structure&#x02013;structure alignments between the query native structure and the best parent. Only for a few of the most challenging targets does the initial K*Sync ensemble not manage to sample near the best possible alignment. We find that for 21 of the 27 targets in the 3D-Jury regime, the K*Sync ensemble achieves at least one model of quality close to that of the model produced by the 3D-Pair alignment to the best parent (within &#x0223c;10% of the full query length by MAMMOTH MaxSub). In the FFAS03 regime, all 9 of the targets are within this threshold, and in the PSI-BLAST regime it is 58 of the 62 targets. These values contrast with the quality of the best models from the detection methods themselves, for which only 5 of the 27 targets are within 10% of the optimal in the 3D-Jury regime, 1 of 9 in the FFAS03 regime, and 27 of 62 in the PSI-BLAST regime. We discuss the most challenging targets in detail in Supplementary Data, and address some of the reasons for the failure of the K*Sync ensemble to sample near the best possible alignments in Discussion.</p></sec><sec><title>Improving the quality of model ensembles</title><p><xref ref-type="fig" rid="fig4">Figure 4</xref> shows the best and average MAMMOTH MaxSub quality of the K*Sync ensembles at various stages in the modeling process as well as the overall quality of models available from the detection methods and the quality of models derived from the 3D-Pair structure&#x02013;structure alignments. The stages in the modeling process examined consist of obtaining the alignment ensemble, enriching the ensemble, loop modeling and, in the more remote regime, backbone optimization.</p><p>In order to avoid expensive loop modeling for all members of the initial ensemble, we enriched the template-only ensemble using a combination of the simple hydrophobic burial and full-atom energy functions (see discussion of selection below). This enrichment reduced the size of each ensemble from up to 1000 members per parent for up to 5 parents (allowing initial ensemble sizes of up to 5000 members for each target) to the lowest scoring 500 members of the ensemble (requiring at least 50 members from each parent). This allows us to increase the average quality of the ensembles without a significant loss of the best members in the ensembles. Loop modeling of the shorter loops (&#x02264;16 residues) improves the best models, but does not alter the average quality of the ensembles, consistent with our expectation that a model must already be correct in alignment in the region of the loop to gain any benefit from loop modeling. Longer loops (&#x02265;17 residues) were then modeled for the more remote 3D-Jury and FFAS03 regime targets to allow for subsequent backbone optimization. <xref ref-type="fig" rid="fig4">Figure 4</xref> shows that the addition of long loops to incomplete models does indeed improve the best models, in keeping with our results for shorter loops. Backbone optimization additionally modifies the models in the ensemble to provide more native-like conformations, but unfortunately also frequently disrupts native-like features that should have been retained, leading to a reduction in the average quality of the ensembles. Additionally, as will be discussed below, this disruption makes selection more challenging for many of the more remote targets. The improvement in quality tends to be from larger perturbations to the models, rather than finer shifts in conformation.</p></sec><sec><title>Selection from the ensemble</title><p>After generating an ensemble with high-quality alignments, we then need to be able to select out the best models. We examined the straightforward approach of rescoring the alignments after their creation using just the sequence scoring methods described above. Not surprisingly, although the sequence-based scoring methods were able to discriminate in the near regime, they were not as successful for the more remote targets, and did not compete with the consensus and energy-based evaluation approaches (data not shown), so were not considered further.</p></sec><sec><title>Comparison of strategies for selection</title><p>We investigated the ability of various strategies for selection of near-native models from the ensembles. <xref ref-type="fig" rid="fig5">Figure 5</xref> reveals the performance of each of the techniques. On the left is the best and average quality of the 3D-Pair structure&#x02013;structure alignments to all parents and to the most confident parent (where the best of the 3D-Pair alignments serves as the approximate upper-bound to template-only modeling), the best and average quality of the alignments from the detection methods, the quality of the top confidence alignment from the detection method, and the best and average quality of the initial non-redundant K*Sync ensemble. The quality of the default K*Sync alignment is shown. On the right is the average quality of the model selected by hydrophobic burial, the side-chain centroid representation energy function, the full-atom energy function, the consensus score from the alignment ensemble as well as &#x02018;sum-of-rank&#x02019; combinations of these measures (measures discussed below). Selection measures are applied to the models before and after modeling of short loop regions. In order to distinguish the contribution to the quality of the selected model resulting from the addition of short loops, we also report the quality of the model that was selected after loop modeling but with a quality determined from the initial template without loops.</p></sec><sec><title>The impact of loop modeling on model quality and selection</title><p><xref ref-type="fig" rid="fig6">Figure 6</xref> illustrates the impact that loop modeling can have on both the quality of the best models in the ensemble and the ability to select superior models. The plots report the side-chain centroid energy of each decoy (<italic>y</italic>-axis) versus structural similarity (<italic>x</italic>-axis), where 0.0 indicates a complete match to the native structure, and 1.0 no similarity (see the Supplementary Data for a more complete description and a discussion of the issues inherent to the MAMMOTH MaxSub evaluation measure). Two representative ensembles are shown, one from the 3D-Jury regime and one from the FFAS03 regime (a full set of plots is provided in Supplementary Data). The native structure of the query and the model with the lowest energy after loop modeling are shown, with those residues in the model that correspond to template positions (taken directly from the parent structure based on the alignment) shown with a colored cartoon representation, and those residues that were modeled using Rosetta indicated by a gray backbone trace.</p><p>As can be seen in these two examples, the majority of the core is provided by the template (with the exception of the green helix on the left of the low-energy model for target 20888), but even so the template-only models alone may not provide the ability to select the very best models. For regions of models where the alignment is accurate, loops that are reasonably well modeled will contribute additional native-like residues and this is what we observe for both target 20888 and target 20415, for which the very best models achieve MaxSub scores closer to the native after loop modeling (we used MAMMOTH MaxSub evaluation of the whole model rather than a more &#x02018;loop-centric&#x02019; metric in order to focus on the effect on the overall quality of the models. The performance of the Rosetta loop modeling protocol itself is described in Rohl <italic>et al</italic>. (<xref ref-type="bibr" rid="b40">40</xref>)).</p><p>Additionally, and from the perspective of getting the alignment right, more importantly, the loops provide interactions that were not available in the template-only model. Although the loops in these examples are not all perfectly modeled, the burial they provide to otherwise exposed core positions and the additional pair interactions they offer contribute to improved discrimination of the most native-like models using energy functions. The whole of the protein (except for any long loops) becomes available for consistent evaluation and comparison of the models.</p></sec><sec><title>Selection using energy functions</title><p>We explored the use of energy-based measures to select out the native-like conformations from the ensemble. We utilized the Rosetta program (<xref ref-type="bibr" rid="b65">65</xref>,<xref ref-type="bibr" rid="b74">74</xref>) to evaluate the energies of template-only models with varying levels of detail: a coarse hydrophobic burial preference, a side-chain centroid representation that includes an empirical pair potential and van der Waals energies, and a full-atom representation in which side-chains are modeled using a backbone-dependent rotamer library (<xref ref-type="bibr" rid="b75">75</xref>) with a Monte Carlo conformational search procedure (<xref ref-type="bibr" rid="b66">66</xref>).</p><p>We compare the scores for ensembles of template-only models with their quality for three representative targets in <xref ref-type="fig" rid="fig7">Figure 7</xref>, one for each difficulty regime (a full set of plots is provided in the Supplementary Data). The coarsest energy function, called &#x02018;hydrophobic burial&#x02019;, captures hydrophobic-polar partitioning, and is often effective in discriminating the better models (for targets that are monomeric and globular) and is quite good at identifying the worst models that usually exhibit poorly formed hydrophobic cores. <xref ref-type="fig" rid="fig7">Figure 7a</xref> shows ensembles scored by hydrophobic burial. As can be seen in <xref ref-type="fig" rid="fig5">Figure 5</xref>, selection with the hydrophobic burial function is aided by loop modeling, probably owing to the additional interactions provided by the loops.</p><p><xref ref-type="fig" rid="fig7">Figure 7b</xref> shows the same three targets, but evaluated using Rosetta's full-atom energy function. We see that there can be quite good correlation between the energy of the model and its quality, especially in the sequence detectable regime, when we expect the packing of the core is largely similar. Interestingly, even in the 3D-Jury regime, the full-atom energy can sometimes discriminate near-native from wrong models. We found that the discrimination with the full-atom energy improves upon reduction of the Lennard-Jones repulsive weight in the energy function because of clashes when placing the query sequence onto the parent backbone (this reduced repulsive form was used in all analysis). As with hydrophobic burial, selection using the full-atom energy function benefits from modeling of short loops (<xref ref-type="fig" rid="fig5">Figure 5</xref>).</p></sec><sec><title>Selection by consensus</title><p>Consensus is a powerful approach that has been applied by other protein structure prediction methods, both <italic>de novo</italic> (<xref ref-type="bibr" rid="b76">76</xref>,<xref ref-type="bibr" rid="b77">77</xref>) and fold-recognition (<xref ref-type="bibr" rid="b31">31</xref>&#x02013;<xref ref-type="bibr" rid="b36">36</xref>,<xref ref-type="bibr" rid="b78">78</xref>,<xref ref-type="bibr" rid="b79">79</xref>). In the case of fold-recognition, it is based on the idea that since there are so many incorrect answers, the convergence is likely to indicate native features (essentially boosting signal-to-noise). The K*Sync alignment ensembles are well suited for obtaining consensus information and one can score each alignment from this perspective. Our approach consists of finding the frequency with which each position &#x02018;<italic>i</italic>&#x02019; of the query maps to a given position &#x02018;<italic>j</italic>&#x02019; in the parent. This signal can be increased by using multiple parents. The top confidence parent (the &#x02018;reference&#x02019; parent) can be structurally aligned to the other parents, allowing alignments to alternate parents to be translated to the reference parent. This permits their rapid comparison without resorting to the more expensive, but otherwise essentially equivalent, process of structurally aligning each template-only model to the reference (e.g. our approach can score an ensemble of thousands of alignments in just a few seconds on a single processor). The consensus score is determined by summing the frequency of the observed mapping at each position that is aligned and then dividing by the length of the query. One advantage of this approach is that it allows some signal for alternate modes in the alignments, unlike approaches that give points only for the dominant mode. We also examined another approach for selection by consensus, in which alignments that did not possess the most dominant mappings were discarded, and found this approach to be inferior as it often resulted in discarding the best alignments, even when the dominant mode possessed a fairly high frequency of occurance in the ensemble (&#x02265;&#x0223c;40%) (data not shown).</p><p><xref ref-type="fig" rid="fig8">Figure 8</xref> reveals that the performance is better and more stable when the consensus score is derived using alignments to multiple parents and when the number of alignments is above a few hundred. <xref ref-type="fig" rid="fig8">Figure 8</xref> also shows that when we derive the consensus signal from a filtered ensemble that favors alignments expected to be better for more remote pairs (see Supplementary Data) instead of from a random set of the same size, the performance is slightly better for the more remote 3D-Jury targets. We find the performance from the filtered ensemble to be about the same for the intermediate FFAS03 targets, and slightly worse for the PSI-BLAST targets (data not shown).</p><p><xref ref-type="fig" rid="fig7">Figure 7c</xref> shows the same three targets scored by our alignment consensus score. The correlation between consensus score and model quality can be quite strong, and may be almost linear for those targets for which the correct alignment is strongly dominant in the consensus mappings (owing to ensemble members receiving points for both quality and consensus score only from correct positions). Frequently, for targets that produce ensembles that are challenging to select from using energy functions, the consensus score can discriminate the superior models. Comparison of selection methods when used in isolation (<xref ref-type="fig" rid="fig5">Figure 5</xref>) reveals consensus to be the best single technique.</p></sec><sec><title>Selection by combining scores</title><p>In order to make selection of high-quality models even more consistent, we investigated several ways of combining the model scores and energies. As an example of improved selection by combining rankings, the full-atom score alone fails to consistently separate the better models from those that are very wrong for target 20906 (<xref ref-type="fig" rid="fig7">Figure 7b</xref>). Hydrophobic burial alone (Figure 7a), although better at separating the extremes than the full-atom energies, scores many of the middling quality alignments as among the lowest energy. Combination of these scores proves more robust. Rather than confront complications of scaling and weighting inherent in combining different measures, we implemented a straightforward &#x02018;sum-of-ranks&#x02019; approach instead, where the scores are sorted and then summed, with the lowest summed rank being used for selection. We additionally investigated &#x02018;purge-and-pick&#x02019; approaches, where the lower scoring ensemble members by one measure are discarded, followed by selection from the remaining set by another scoring method. We found that the purge-and-pick approach, although sometimes accomplishing the goal of improved selection, was not as robust as the sum-of-ranks approach (data not shown).</p><p>We also examined combining Rosetta energy functions with the consensus score using a sum-of-ranks approach and found such combinations were indeed very good at selection. The consensus score by itself provides such good discrimination that we did not find a huge improvement in selection upon combining it with the other measures when applied to the initial template models (<xref ref-type="fig" rid="fig5">Figure 5</xref>). However, the selection of models that have the loops modeled well does benefit somewhat from combining the energy functions with the consensus score, perhaps owing to subtle differences in the alignments and trimming of the stems that are not distinguishable with the consensus score alone, which may be responsible for the ability to better model the loops.</p><p>If we consider all three regimes in <xref ref-type="fig" rid="fig5">Figure 5</xref>, the single best approach appears to be the sum-of-ranks of the full-atom energy function with the hydrophobic burial preference and the alignment consensus score. This selection method significantly outperforms the alignments from the detection method and the default K*Sync method. Unfortunately, although a large improvement over the baseline methods, none of the selection measures by itself is able to consistently select the very best alignments that are present in the ensemble.</p></sec><sec><title>The impact of backbone optimization on model quality and selection</title><p><xref ref-type="fig" rid="fig9">Figure 9</xref> shows selection for the 3D-Jury regime targets after modeling of long loops and backbone optimization. For comparison, the template-only and short loop modeled stages are also reported. Also shown is the quality of the selected model at each stage, but as determined from the initial template before any loop modeling and backbone optimization of the entire model. We find that perturbation of the models allows for better selection with energy functions (full-atom energies were not examined as the backbone optimization was performed with the side-chain centroid energy function). Although the best overall selection of the optimized models is accomplished using the sum-of-ranks &#x02018;centroid + consensus&#x02019; measure, we do not find improved selection by this combination of measures in the FFAS03 regime, where selection from ensembles that have undergone backbone optimization yields significantly inferior models to those selected from frozen-backbone templates (data not shown). Examination of the 3D-Jury targets reveals that the more distant pairs tend to be the ones that reap the greatest benefit from the backbone optimization (Supplementary Data). This is likely a consequence of the greater deviation between the more remote pairs that may be aided by backbone perturbation, whereas more similar pairs are already close to the correct conformation and can only be disrupted. PSI-BLAST regime targets were not examined due to the expense of the procedure combined with the large number of targets in this set, as well as the expectation that the more remote pairs would be the most likely to benefit from low-resolution backbone optimization.</p><p>Instances of improved selection appear to have been mostly due to larger perturbations on unrestrained regions of the decoys, rather than high-resolution improvements. Other complications included targets that had a native structure and templates that did not possess tight hydrophobic cores. Optimization of the side-chain centroid energy function caused these structures to collapse in an attempt to bury the hydrophobic residues, misleading discrimination of the superior decoys. Combination of pre-optimization hydrophobic burial scores with post-optimization centroid energies also did not provide a consistent improvement (data not shown). The challenge presented by refinement of homology models remains an ongoing area of research.</p></sec></sec><sec><title>DISCUSSION</title><p>We have pursued several avenues in our research with the goal of obtaining high-quality homology models. We found that we can improve alignments by the incorporation of structural guidance terms with sequence information, including a novel approach to utilize information about regions that are likely obligate to the fold. We generated large alignment ensembles by varying the contributions to the alignment cost function and found that the ensembles frequently sample near the best possible alignment from a structural perspective. We were able to select superior alignments from the ensembles by evaluating the models using energy functions. Completion of the models by loop modeling often had a positive impact on both model quality and selection, and to some extent so did adjusting the backbone to account for perturbations from the different sequences for more distant targets. We additionally developed an approach to derive a consensus score from the large K*Sync ensembles, and found that discrimination using our alignment consensus score benefited from having a large number of diverse alignments and became more accurate by building a consensus from ensembles derived from multiple parents. Additionally, combining different scoring techniques to select models proved the most robust. Although, on average, those combinations that included the consensus score were slightly better than consensus alone, the consensus score provided the majority of the signal with which better models were selected. In the following sections we discuss some of the issues in sampling and model selection that remain to be overcome.</p><sec><title>Challenges in sampling</title><p>Although the K*Sync alignment ensemble generating approach is usually quite successful at producing alignments close to the best possible, it does not always manage to do so (<xref ref-type="fig" rid="fig3">Figure 3</xref>). When we investigated the causes for the most egregious of these failures (those &#x0003e;10% by MAMMOTH MaxSub away from the best possible), we found that our reduction of the ensemble size from the initial large ensemble to at most 1000 unique alignments per parent was not responsible (see Supplementary Data for the order in which the ensemble was filtered). Investigation of the most challenging targets in <xref ref-type="fig" rid="fig3">Figure 3</xref> revealed that near best possible alignments were never sampled even in the initial large ensemble for these targets.</p><p>There proved to be several reasons for the failure of the K*Sync ensemble to sample near best possible alignments for some of the targets (for a detailed discussion of the most challenging targets see Supplementary Data). The most straightforward of these was when the parents were incorrect. Although we have not included in the analysis those targets that did not have a parent that provided a reasonable amount of backbone upon which to model, there were some examples where our threshold was exceeded even with a wrong parent, such as for a helical bundle with a mirror topology to the target (target 20436: 1p68A). There were also cases where the topology was fundamentally correct, but variations in the parents, such as the replacement of the C-terminal strand with an extra strand at the N-terminus for a canonical beta-propeller (target 17574: 1ofzA), proved insurmountable. Other variations in moieties (extra helices, dropped hairpins or even missing density), occasionally were not corrected for even in the best alignments.</p><p>Another misdirection in the alignments frequently resulted from inaccurate secondary structure predictions. Although not all alignments in the ensemble give full weight to the secondary structure predictions, it was telling that misalignment was consistently wrong in regions of targets with inaccurate secondary structure predictions by all three methods (PSIPRED, SAM-T99 and JUFO). In addition to incorrect guidance from the secondary structure predictions, the sequence signature itself was probably not reliable (hence the incorrect secondary structure predictions), exacerbating the difficulty to recover. This 2-fold challenge was especially pronounced for edge strands, where the hydrophobic patterning is often not as clear as for more central strands. The challenge of different hydrophobic patterning is especially great for those targets that are monomers but are being modeled with parents that are multimers (or vice versa). The residue substitution profiles in such cases will include polar residues for the exposed positions of the monomer, but may very well be hydrophobic for the multimer at positions that comprise a largely hydrophobic interface. Since the majority of the signal in producing the alignments derives from the hydrophobic patterning, the altered pattern can greatly disrupt the ability to obtain the correct alignment.</p><p>We were interested to discover that four of the seven most challenging targets (20436, 20241, 17574 and 18863) had alignment ensembles that did not possess any real agreement, yielding unusually weak consensus scores. In such easily identifiable circumstances (except for 20436, which does not have any correct parents), additional sampling by introduction of additional variation in weights and potentially by additional terms (such as predicted solvent accessibility or more specific conformational preferences than just 3-state secondary structure) may allow for better sampling of near best possible alignments which might be discriminated using energy functions even in the absence of alignment consensus.</p><p>The K*Sync ensemble generating approach has good success in generating optimal alignments, but frequently only obtains near best possible alignments, and for a small fraction of the targets does not manage to obtain high-quality alignments. Future modifications to the protocol, such as additional sampling that enforces greater diversity may remedy some of these cases.</p></sec><sec><title>Challenges in selection</title><p>Even in the circumstance that a high-quality alignment and model is generated, selection of the best models in the ensemble can be complicated by several factors. For example, sometimes a consensus is obtained that has a portion with the greatest frequency to an incorrect part of the parent. Sometimes a less frequent alternate mode (that is still somewhat common in the ensemble) is in fact the correct alignment. For this reason, our consensus score also gives points to alignments that are not necessarily the dominant frequency at all positions. In such circumstances, scoring the models in the ensemble using energy functions hopefully complements the misdirection from the alignment consensus, but is not always successful in doing so (e.g. target 20672, 1mzgA). Given that the consensus score is usually the most discriminating, and therefore should usually be included in selection of the best models, determining when to trust the consensus score and when to down-weight it has proven difficult (at least when it is above a reasonable threshold and indicates some degree of convergence in the alignment ensemble).</p><p>The energy functions have as their foundation the assumption that the proteins to be modeled are soluble monomeric domains with well-packed hydrophobic cores and largely soluble surfaces. The mostly non-hydrophobic surface assumption does not hold as well for targets that are obligate multimers with hydrophobic interfaces, and thus complicates selection of models using the hydrophobic burial score. Also, those targets that do not have tightly packed hydrophobic cores can mislead the burial energy score. Again, as with the consensus score, incorporation of the other scoring terms makes selection more robust, but does not work in all cases.</p><p>As discussed previously, van der Waals clashes and other high-energy features may result from placing a sequence onto a backbone that is not the same as that which determined the conformation of that backbone. Although we have alleviated this effect somewhat for the van der Waals clashes by reducing the repulsive term in the full-atom energy function used to evaluate such models, this <italic>ad hoc</italic> solution is not ideal as it sometimes misleads the energy function.</p><p>We also encountered some degree of favoritism for shorter templates in the energy functions when scoring models after loop modeling. If we are evaluating models that have frozen-backbone templates and loops that have been built under the influence of a given potential, then we must exercise caution that selection from among those models does not overly emphasize that same potential. The danger in so doing is that models that have fewer residues provided by the template (and correspondingly more residues optimized under the given potential) will be selected since the template regions have not been optimized under this potential, incorrectly yielding shorter and less complete alignments. Our goal is to further the early success shown here (<xref ref-type="fig" rid="fig9">Figure 9</xref>) in combining alignments that are both accurate and complete with conformational optimization to both template-derived and loop-modeled regions to consistently allow for selection of the most native-like models.</p></sec><sec><title>Comparison with other approaches</title><p>The protocol we have described has similarities to other methods. For example, generation of alignment ensembles and selection from them has been explored by other groups (<xref ref-type="bibr" rid="b19">19</xref>,<xref ref-type="bibr" rid="b20">20</xref>,<xref ref-type="bibr" rid="b26">26</xref>). However, we believe that the diversity of the initial ensembles generated by most of these methods may often not be as great as that available in the K*Sync ensembles due to the large degree to which we vary the input information and terms in producing the alignments, as well as our use of a novel approach for inclusion of obligate terms, as evidenced by the large number of unique alignments achieved by our parametric ensemble generation. This contrasts with those autonomous methods for ensemble generation that are largely dependent on variation of sequence-only terms for initial diversity. Additionally, most methods that autonomously generate their own ensembles rely upon selection approaches that only examine the models for protein-like features, and do not incorporate consensus information for scoring models.</p><p>Unlike K*Sync, other automatic consensus methods (<xref ref-type="bibr" rid="b31">31</xref>&#x02013;<xref ref-type="bibr" rid="b34">34</xref>,<xref ref-type="bibr" rid="b36">36</xref>) are dependent on external fold recognition servers for their ensembles (with the exception of the local version of the SHOTGUN method (<xref ref-type="bibr" rid="b31">31</xref>)). They may therefore utilize more diverse initial ensembles than those available from variation of sequence-only alignment terms. However, we have found, at least in the case of our K*Sync ensembles, that the signal from the consensus score derived from an ensemble improves rapidly with the size of the ensemble and also when ensembles from multiple parents are considered. In our implementation, it usually does not stabilize until a fairly large number of alignments are considered, roughly on the order of several hundred (<xref ref-type="fig" rid="fig8">Figure 8</xref>). This is usually more than the number of alignments considered by existing consensus methods, which may have input on the order of up to 10 or so servers with usually up to &#x0223c;10 models from each server, frequently not all with the correct topology. Therefore, the ensembles used by other methods likely do not sample alignments to a degree that allows for as robust a consensus. This supposition is supported by comparison of the models from the 3D-Jury method with the K*Sync initial template-only consensus-selected models in <xref ref-type="fig" rid="fig5">Figure 5</xref>, which shows a significant increase in quality by the use of our consensus approach with K*Sync ensembles.</p><p>Additionally, most consensus methods do not incorporate model evaluation. To the best of our knowledge, only two other automated methods currently reported combine a consensus score directly with model evaluation to select the best models (<xref ref-type="bibr" rid="b33">33</xref>,<xref ref-type="bibr" rid="b36">36</xref>), but again, are limited in the pool from which they select and in the robustness of their consensus by the richness of the initial ensemble provided by external fold recognition servers. We hope to be able to compare the complete version of our method with other methods in future public benchmarking experiments.</p></sec><sec><title>The performance of the method in public benchmarking experiments</title><p>The K*Sync and Rosetta homology modeling protocol has been in development for several years. We have participated in several rounds of CASP using various incarnations of the method. We have also implemented the method, and updated it along the way, in the Robetta server (<xref ref-type="bibr" rid="b55">55</xref>,<xref ref-type="bibr" rid="b60">60</xref>,<xref ref-type="bibr" rid="b80">80</xref>). We have participated in both CASP and LiveBench with the Robetta server. We fared quite well in CASP4 with a mostly manual implementation of the K*Sync default method, placing in the top groups in both the comparative modeling (<xref ref-type="bibr" rid="b81">81</xref>) and the fold recognition (<xref ref-type="bibr" rid="b82">82</xref>) categories.</p><p>We then fully automated the K*Sync single default alignment and created the Robetta server and used it to participate in CASP5 and CAFASP3. Excitingly, Robetta was one of the better methods in the fold recognition regime in CASP5 (<xref ref-type="bibr" rid="b83">83</xref>), including human groups. Robetta also ranked highly in CAFASP3 (<xref ref-type="bibr" rid="b84">84</xref>), indicating that the K*Sync default method was performing very well. We also used K*Sync to generate alignment ensembles from which we selected from using a combination of energy functions and human intuition for our human group in CASP5 (<xref ref-type="bibr" rid="b59">59</xref>). This method proved among the best in the fold recognition regime (<xref ref-type="bibr" rid="b83">83</xref>), which supported our continued research into ensemble generation and selection.</p><p>We then implemented automatic ensemble generation (for the top confidence parent only) and selection using only energy functions in the Robetta server, returning the energy-picked model as the first model (burial for remote targets and full-atom + burial for PSI-BLAST detectable targets) and made model 2 the one from the default alignment. We then participated with Robetta in LiveBench-6, LiveBench-7 and LiveBench-8, (<xref ref-type="bibr" rid="b70">70</xref>,<xref ref-type="bibr" rid="b85">85</xref>) and did not fare as well as we had anticipated, ranking reasonably well in the remote regime for which we designed our method, but being outperformed by the meta consensus servers when just considering the first model. We attribute some of these less stellar results to the less robust energy selection that we were using and the fact that we were using only one parent. We did not include consensus, and for some targets did a poor job selecting the first model. When considering all models, Robetta was among the best methods.</p><p>We also participated in CASP6 and CAFASP4 with Robetta (again, with only the top confidence parent and without consensus scoring) and also with a newer version of the automatic protocol that we called &#x02018;Robetta_04&#x02019; (<xref ref-type="bibr" rid="b60">60</xref>) that utilized multiple parents as well as backbone optimization, but did not utilize consensus scoring. Robetta ranked highest among the servers in CASP6 in the fold recognition category (<xref ref-type="bibr" rid="b86">86</xref>), and Robetta_04 was among the top 10 methods among all groups, including humans. Interestingly, although Robetta_04 compared favorably against other automated methods, Robetta was not evaluated by the CAFASP criteria as among the best servers in the CAFASP4 experiment (<ext-link ext-link-type="uri" xlink:href="http://www.cs.bgu.ac.il/~dfischer/CAFASP4/"/>), which may be attributable to the parents available at the time of execution of Robetta (when the targets were initially released by CASP, whereas other servers were run later for CAFASP) as well as the different scoring schemes used by each of the experiments. CASP uses several measures (primarily GDT_TS (87)) which can be forgiving for more low-resolution accuracy, whereas CAFASP uses the higher-resolution version of the MaxSub (<xref ref-type="bibr" rid="b72">72</xref>) method, which does not count positions that are not very close.</p><p>Based on the findings in this study, we have added generation of K*Sync ensembles using multiple parents and selection using our alignment consensus score and energy-based approaches to our development Robetta server that is participating in CASP7. We look forward to the results from CASP7, and will be making the method available to the public via the Robetta server soon.</p></sec></sec><sec><title>SUPPLEMENTARY DATA</title><p>Supplementary Data are available at NAR Online.</p></sec></body><back><ack><p>The authors thank Carol Rohl, Charlie Strauss, Philip Bradley and Bin Qian for their help with Rosetta loop modeling. We would also like to thank Richard Bonneau, Jack Schonbrun, Leszek Rychlewski and Kevin Karplus for helpful discussions. We thank Leszek Rychlewski, Adam Godzik, David Jones, Kevin Karplus, Jens Meiler, William Taylor, Dani Fischer, Michael Sternberg, Lawrence Kelley and Tom Blundell for the use of their servers and software. We express our gratitude to two anonymous reviewers for their helpful advice. We additionally appreciate Guoli Wang and Roland Dunbrack for their provision of the CE alignments of the SCOP domains. We also thank Keith Laidig for his effective design and implementation of the computational resources used in performing this research, and David Kim for his assistance with the Robetta infrastructure. The authors acknowledge the support of the NIH and the HHMI. D.C. was a National Fellow of the Program in Mathematics and Molecular Biology, with funding from the Burroughs-Wellcome Fund, during the completion of part of this work, whose aid was greatly appreciated. Funding to pay the Open Access publication charges for this article was provided by the HHMI.</p><p><italic>Conflict of interest statement.</italic> None declared.</p></ack><ref-list><title>REFERENCES</title><ref id="b1"><label>1</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Vitkup</surname><given-names>D.</given-names></name><name><surname>Melamud</surname><given-names>E.</given-names></name><name><surname>Moult</surname><given-names>J.</given-names></name><name><surname>Sander</surname><given-names>C.</given-names></name></person-group><article-title>Completeness in structural genomics</article-title><source>Nature Struct. Biol.</source><year>2001</year><volume>8</volume><fpage>559</fpage><lpage>566</lpage><pub-id pub-id-type="pmid">11373627</pub-id></citation></ref><ref id="b4"><label>2</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gribskov</surname><given-names>M.</given-names></name><name><surname>McLachlan</surname><given-names>A.D.</given-names></name><name><surname>Eisenberg</surname><given-names>D.</given-names></name></person-group><article-title>Profile analysis: detection of distantly related proteins</article-title><source>Proc. Natl Acad. Sci. USA</source><year>1987</year><volume>84</volume><fpage>4355</fpage><lpage>4358</lpage><pub-id pub-id-type="pmid">3474607</pub-id></citation></ref><ref id="b7"><label>3</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pietrokovski</surname><given-names>S.</given-names></name></person-group><article-title>Searching databases of conserved sequence regions by aligning protein multiple-alignments</article-title><source>Nucleic Acids Res.</source><year>1996</year><volume>24</volume><fpage>3836</fpage><lpage>3845</lpage><pub-id pub-id-type="pmid">8871566</pub-id></citation></ref><ref id="b2"><label>4</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Altschul</surname><given-names>S.F.</given-names></name><name><surname>Madden</surname><given-names>T.L.</given-names></name><name><surname>Schaffer</surname><given-names>A.A.</given-names></name><name><surname>Zhang</surname><given-names>J.</given-names></name><name><surname>Zhang</surname><given-names>Z.</given-names></name><name><surname>Miller</surname><given-names>W.</given-names></name><name><surname>Lipman</surname><given-names>D.J.</given-names></name></person-group><article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title><source>Nucleic Acids Res.</source><year>1997</year><volume>25</volume><fpage>3389</fpage><lpage>3402</lpage><pub-id pub-id-type="pmid">9254694</pub-id></citation></ref><ref id="b8"><label>5</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rychlewski</surname><given-names>L.</given-names></name><name><surname>Jaroszewski</surname><given-names>L.</given-names></name><name><surname>Li</surname><given-names>W.</given-names></name><name><surname>Godzik</surname><given-names>A.</given-names></name></person-group><article-title>Comparison of sequence profiles. Strategies for structural predictions using sequence information</article-title><source>Protein Sci.</source><year>2000</year><volume>9</volume><fpage>232</fpage><lpage>241</lpage><pub-id pub-id-type="pmid">10716175</pub-id></citation></ref><ref id="b6"><label>6</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Jaroszewski</surname><given-names>L.</given-names></name><name><surname>Rychlewski</surname><given-names>L.</given-names></name><name><surname>Godzik</surname><given-names>A.</given-names></name></person-group><article-title>Improving the quality of twilight-zone alignments</article-title><source>Protein Sci.</source><year>2000</year><volume>9</volume><fpage>1487</fpage><lpage>1496</lpage><pub-id pub-id-type="pmid">10975570</pub-id></citation></ref><ref id="b5"><label>7</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Heger</surname><given-names>A.</given-names></name><name><surname>Holm</surname><given-names>L.</given-names></name></person-group><article-title>Picasso: generating a covering set of protein family profiles</article-title><source>Bioinformatics</source><year>2001</year><volume>17</volume><fpage>272</fpage><lpage>279</lpage><pub-id pub-id-type="pmid">11294792</pub-id></citation></ref><ref id="b10"><label>8</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yona</surname><given-names>G.</given-names></name><name><surname>Levitt</surname><given-names>M.</given-names></name></person-group><article-title>Within the twilight zone: a sensitive profile-profile comparison tool based on information theory</article-title><source>J. Mol. Biol.</source><year>2002</year><volume>315</volume><fpage>1257</fpage><lpage>1275</lpage><pub-id pub-id-type="pmid">11827492</pub-id></citation></ref><ref id="b9"><label>9</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Sadreyev</surname><given-names>R.</given-names></name><name><surname>Grishin</surname><given-names>N.</given-names></name></person-group><article-title>COMPASS: a tool for comparison of multiple protein alignments with assessment of statistical significance</article-title><source>J. Mol. Biol.</source><year>2003</year><volume>326</volume><fpage>317</fpage><lpage>336</lpage><pub-id pub-id-type="pmid">12547212</pub-id></citation></ref><ref id="b3"><label>10</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Edgar</surname><given-names>R.C.</given-names></name><name><surname>Sjolander</surname><given-names>K.</given-names></name></person-group><article-title>COACH: profile&#x02013;profile alignment of protein families using hidden Markov models</article-title><source>Bioinformatics</source><year>2004</year><volume>20</volume><fpage>1309</fpage><lpage>1318</lpage><pub-id pub-id-type="pmid">14962937</pub-id></citation></ref><ref id="b11"><label>11</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Marti-Renom</surname><given-names>M.A.</given-names></name><name><surname>Madhusudhan</surname><given-names>M.S.</given-names></name><name><surname>Sali</surname><given-names>A.</given-names></name></person-group><article-title>Alignment of protein sequences by their profiles</article-title><source>Protein Sci.</source><year>2004</year><volume>13</volume><fpage>1071</fpage><lpage>1087</lpage><pub-id pub-id-type="pmid">15044736</pub-id></citation></ref><ref id="b12"><label>12</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Fischer</surname><given-names>D.</given-names></name><name><surname>Eisenberg</surname><given-names>D.</given-names></name></person-group><article-title>Protein fold recognition using sequence-derived predictions</article-title><source>Protein Sci.</source><year>1996</year><volume>5</volume><fpage>947</fpage><lpage>955</lpage><pub-id pub-id-type="pmid">8732766</pub-id></citation></ref><ref id="b14"><label>13</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Jaroszewski</surname><given-names>L.</given-names></name><name><surname>Rychlewski</surname><given-names>L.</given-names></name><name><surname>Zhang</surname><given-names>B.</given-names></name><name><surname>Godzik</surname><given-names>A.</given-names></name></person-group><article-title>Fold prediction by a hierarchy of sequence, threading, and modeling methods</article-title><source>Protein Sci.</source><year>1998</year><volume>7</volume><fpage>1431</fpage><lpage>1440</lpage><pub-id pub-id-type="pmid">9655348</pub-id></citation></ref><ref id="b13"><label>14</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Karplus</surname><given-names>K.</given-names></name><name><surname>Karchin</surname><given-names>R.</given-names></name><name><surname>Barrett</surname><given-names>C.</given-names></name><name><surname>Tu</surname><given-names>S.</given-names></name><name><surname>Cline</surname><given-names>M.</given-names></name><name><surname>Diekhans</surname><given-names>M.</given-names></name><name><surname>Grate</surname><given-names>L.</given-names></name><name><surname>Casper</surname><given-names>J.</given-names></name><name><surname>Hughey</surname><given-names>R.</given-names></name></person-group><article-title>What is the value added by human intervention in protein structure prediction?</article-title><source>Proteins</source><year>2001</year><issue>Suppl 5</issue><fpage>86</fpage><lpage>91</lpage><pub-id pub-id-type="pmid">11835485</pub-id></citation></ref><ref id="b15"><label>15</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Shi</surname><given-names>J.</given-names></name><name><surname>Blundell</surname><given-names>T.L.</given-names></name><name><surname>Mizuguchi</surname><given-names>K.</given-names></name></person-group><article-title>FUGUE: sequence&#x02013;structure homology recognition using environment-specific substitution tables and structure-dependent gap penalties</article-title><source>J. Mol. Biol.</source><year>2001</year><volume>310</volume><fpage>243</fpage><lpage>257</lpage><pub-id pub-id-type="pmid">11419950</pub-id></citation></ref><ref id="b16"><label>16</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kelley</surname><given-names>L.A.</given-names></name><name><surname>MacCallum</surname><given-names>R.M.</given-names></name><name><surname>Sternberg</surname><given-names>M.J.</given-names></name></person-group><article-title>Enhanced genome annotation using structural profiles in the program 3D-PSSM</article-title><source>J. Mol. Biol.</source><year>2000</year><volume>299</volume><fpage>499</fpage><lpage>520</lpage><pub-id pub-id-type="pmid">10860755</pub-id></citation></ref><ref id="b17"><label>17</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>D.T.</given-names></name></person-group><article-title>GenTHREADER: an efficient and reliable protein fold recognition method for genomic sequences</article-title><source>J. Mol. Biol.</source><year>1999</year><volume>287</volume><fpage>797</fpage><lpage>815</lpage><pub-id pub-id-type="pmid">10191147</pub-id></citation></ref><ref id="b18"><label>18</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Panchenko</surname><given-names>A.R.</given-names></name><name><surname>Marchler-Bauer</surname><given-names>A.</given-names></name><name><surname>Bryant</surname><given-names>S.H.</given-names></name></person-group><article-title>Combination of threading potentials and sequence profiles improves fold recognition</article-title><source>J. Mol. Biol.</source><year>2000</year><volume>296</volume><fpage>1319</fpage><lpage>1331</lpage><pub-id pub-id-type="pmid">10698636</pub-id></citation></ref><ref id="b19"><label>19</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Contreras-Moreira</surname><given-names>B.</given-names></name><name><surname>Fitzjohn</surname><given-names>P.W.</given-names></name><name><surname>Bates</surname><given-names>P.A.</given-names></name></person-group><article-title><italic>In silico</italic> protein recombination: enhancing template and sequence alignment selection for comparative protein modelling</article-title><source>J. Mol. Biol.</source><year>2003</year><volume>328</volume><fpage>593</fpage><lpage>608</lpage><pub-id pub-id-type="pmid">12706719</pub-id></citation></ref><ref id="b20"><label>20</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>John</surname><given-names>B.</given-names></name><name><surname>Sali</surname><given-names>A.</given-names></name></person-group><article-title>Comparative protein structure modeling by iterative alignment, model building and model assessment</article-title><source>Nucleic Acids Res.</source><year>2003</year><volume>31</volume><fpage>3982</fpage><lpage>3992</lpage><pub-id pub-id-type="pmid">12853614</pub-id></citation></ref><ref id="b21"><label>21</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Saqi</surname><given-names>M.A.</given-names></name><name><surname>Sternberg</surname><given-names>M.J.</given-names></name></person-group><article-title>A simple method to generate non-trivial alternate alignments of protein sequences</article-title><source>J. Mol. Biol.</source><year>1991</year><volume>219</volume><fpage>727</fpage><lpage>732</lpage><pub-id pub-id-type="pmid">1905360</pub-id></citation></ref><ref id="b22"><label>22</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Zuker</surname><given-names>M.</given-names></name></person-group><article-title>Suboptimal sequence alignment in molecular biology. Alignment with error analysis</article-title><source>J. Mol. Biol.</source><year>1991</year><volume>221</volume><fpage>403</fpage><lpage>420</lpage><pub-id pub-id-type="pmid">1920426</pub-id></citation></ref><ref id="b23"><label>23</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Naor</surname><given-names>D.</given-names></name><name><surname>Brutlag</surname><given-names>D.L.</given-names></name></person-group><article-title>On near best possible alignments of biological sequences</article-title><source>J. Comput. Biol.</source><year>1994</year><volume>1</volume><fpage>349</fpage><lpage>366</lpage><pub-id pub-id-type="pmid">8790476</pub-id></citation></ref><ref id="b24"><label>24</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Jaroszewski</surname><given-names>L.</given-names></name><name><surname>Li</surname><given-names>W.</given-names></name><name><surname>Godzik</surname><given-names>A.</given-names></name></person-group><article-title>In search for more accurate alignments in the twilight zone</article-title><source>Protein Sci.</source><year>2002</year><volume>11</volume><fpage>1702</fpage><lpage>1713</lpage><pub-id pub-id-type="pmid">12070323</pub-id></citation></ref><ref id="b25"><label>25</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Muckstein</surname><given-names>U.</given-names></name><name><surname>Hofacker</surname><given-names>I.L.</given-names></name><name><surname>Stadler</surname><given-names>P.F.</given-names></name></person-group><article-title>Stochastic pairwise alignments</article-title><source>Bioinformatics</source><year>2002</year><volume>18</volume><fpage>S153</fpage><lpage>S160</lpage><pub-id pub-id-type="pmid">12385998</pub-id></citation></ref><ref id="b26"><label>26</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Petrey</surname><given-names>D.</given-names></name><name><surname>Xiang</surname><given-names>Z.</given-names></name><name><surname>Tang</surname><given-names>C.L.</given-names></name><name><surname>Xie</surname><given-names>L.</given-names></name><name><surname>Gimpelev</surname><given-names>M.</given-names></name><name><surname>Mitros</surname><given-names>T.</given-names></name><name><surname>Soto</surname><given-names>C.S.</given-names></name><name><surname>Goldsmith-Fischman</surname><given-names>S.</given-names></name><name><surname>Kernytsky</surname><given-names>A.</given-names></name><name><surname>Schlessinger</surname><given-names>A.</given-names></name><etal/></person-group><article-title>Using multiple structure alignments, fast model building, and energetic analysis in fold recognition and homology modeling</article-title><source>Proteins</source><year>2003</year><volume>53</volume><fpage>430</fpage><lpage>435</lpage><pub-id pub-id-type="pmid">14579332</pub-id></citation></ref><ref id="b27"><label>27</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Waterman</surname><given-names>M.S.</given-names></name><name><surname>Eggert</surname><given-names>M.</given-names></name><name><surname>Lander</surname><given-names>E.</given-names></name></person-group><article-title>Parametric sequence comparisons</article-title><source>Proc. Natl Acad. Sci. USA</source><year>1992</year><volume>89</volume><fpage>6090</fpage><lpage>6093</lpage><pub-id pub-id-type="pmid">1631095</pub-id></citation></ref><ref id="b28"><label>28</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Waterman</surname><given-names>M.S.</given-names></name></person-group><article-title>Parametric and ensemble sequence alignment algorithms</article-title><source>Bull. Math. Biol.</source><year>1994</year><volume>56</volume><fpage>743</fpage><lpage>767</lpage><pub-id pub-id-type="pmid">8054893</pub-id></citation></ref><ref id="b29"><label>29</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pawlowski</surname><given-names>K.</given-names></name><name><surname>Jaroszewski</surname><given-names>L.</given-names></name><name><surname>Bierzynski</surname><given-names>A.</given-names></name><name><surname>Godzik</surname><given-names>A.</given-names></name></person-group><article-title>Multiple model approach&#x02014;dealing with alignment ambiguities in protein modeling</article-title><source>Pac. Symp. Biocomput.</source><year>1997</year><fpage>328</fpage><lpage>339</lpage><pub-id pub-id-type="pmid">9390303</pub-id></citation></ref><ref id="b30"><label>30</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Saqi</surname><given-names>M.A.</given-names></name><name><surname>Bates</surname><given-names>P.A.</given-names></name><name><surname>Sternberg</surname><given-names>M.J.</given-names></name></person-group><article-title>Towards an automatic method of predicting protein structure by homology: an evaluation of suboptimal sequence alignments</article-title><source>Protein Eng.</source><year>1992</year><volume>5</volume><fpage>305</fpage><lpage>311</lpage><pub-id pub-id-type="pmid">1409552</pub-id></citation></ref><ref id="b31"><label>31</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Fischer</surname><given-names>D.</given-names></name></person-group><article-title>3D-SHOTGUN: a novel, cooperative, fold-recognition meta-predictor</article-title><source>Proteins</source><year>2003</year><volume>51</volume><fpage>434</fpage><lpage>441</lpage><pub-id pub-id-type="pmid">12696054</pub-id></citation></ref><ref id="b32"><label>32</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ginalski</surname><given-names>K.</given-names></name><name><surname>Elofsson</surname><given-names>A.</given-names></name><name><surname>Fischer</surname><given-names>D.</given-names></name><name><surname>Rychlewski</surname><given-names>L.</given-names></name></person-group><article-title>3D-Jury: a simple approach to improve protein structure predictions</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><fpage>1015</fpage><lpage>1018</lpage><pub-id pub-id-type="pmid">12761065</pub-id></citation></ref><ref id="b33"><label>33</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kosinski</surname><given-names>J.</given-names></name><name><surname>Gajda</surname><given-names>M.J.</given-names></name><name><surname>Cymerman</surname><given-names>I.A.</given-names></name><name><surname>Kurowski</surname><given-names>M.A.</given-names></name><name><surname>Pawlowski</surname><given-names>M.</given-names></name><name><surname>Boniecki</surname><given-names>M.</given-names></name><name><surname>Obarska</surname><given-names>A.</given-names></name><name><surname>Papaj</surname><given-names>G.</given-names></name><name><surname>Sroczynska-Obuchowicz</surname><given-names>P.</given-names></name><name><surname>Tkaczuk</surname><given-names>K.L.</given-names></name><etal/></person-group><article-title>FRankenstein becomes a cyborg: the automatic recombination and realignment of fold recognition models in CASP6</article-title><source>Proteins</source><year>2005</year><volume>61</volume><fpage>106</fpage><lpage>113</lpage><pub-id pub-id-type="pmid">16187351</pub-id></citation></ref><ref id="b34"><label>34</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Prasad</surname><given-names>J.C.</given-names></name><name><surname>Vajda</surname><given-names>S.</given-names></name><name><surname>Camacho</surname><given-names>C.J.</given-names></name></person-group><article-title>Consensus alignment server for reliable comparative modeling with distant templates</article-title><source>Nucleic Acids Res.</source><year>2004</year><volume>32</volume><fpage>W50</fpage><lpage>W54</lpage><pub-id pub-id-type="pmid">15215349</pub-id></citation></ref><ref id="b35"><label>35</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Venclovas</surname><given-names>C.</given-names></name><name><surname>Margelevicius</surname><given-names>M.</given-names></name></person-group><article-title>Comparative modeling in CASP6 using consensus approach to template selection, sequence&#x02013;structure alignment and structure assessment</article-title><source>Proteins</source><year>2005</year><volume>61</volume><fpage>99</fpage><lpage>105</lpage><pub-id pub-id-type="pmid">16187350</pub-id></citation></ref><ref id="b36"><label>36</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wallner</surname><given-names>B.</given-names></name><name><surname>Elofsson</surname><given-names>A.</given-names></name></person-group><article-title>Pcons5: combining consensus, structural evaluation and fold recognition scores</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>4248</fpage><lpage>4254</lpage><pub-id pub-id-type="pmid">16204344</pub-id></citation></ref><ref id="b37"><label>37</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Summers</surname><given-names>N.L.</given-names></name><name><surname>Karplus</surname><given-names>M.</given-names></name></person-group><article-title>Modeling of globular proteins. A distance-based data search procedure for the construction of insertion/deletion regions and Pro-&#x02013;non-Pro mutations</article-title><source>J. Mol. Biol.</source><year>1990</year><volume>216</volume><fpage>991</fpage><lpage>1016</lpage><pub-id pub-id-type="pmid">2266566</pub-id></citation></ref><ref id="b38"><label>38</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Fiser</surname><given-names>A.</given-names></name><name><surname>Do</surname><given-names>R.K.</given-names></name><name><surname>Sali</surname><given-names>A.</given-names></name></person-group><article-title>Modeling of loops in protein structures</article-title><source>Protein Sci.</source><year>2000</year><volume>9</volume><fpage>1753</fpage><lpage>1773</lpage><pub-id pub-id-type="pmid">11045621</pub-id></citation></ref><ref id="b39"><label>39</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>de Bakker</surname><given-names>P.I.</given-names></name><name><surname>DePristo</surname><given-names>M.A.</given-names></name><name><surname>Burke</surname><given-names>D.F.</given-names></name><name><surname>Blundell</surname><given-names>T.L.</given-names></name></person-group><article-title><italic>Ab initio</italic> construction of polypeptide fragments: accuracy of loop decoy discrimination by an all-atom statistical potential and the AMBER force field with the Generalized Born solvation model</article-title><source>Proteins</source><year>2003</year><volume>51</volume><fpage>21</fpage><lpage>40</lpage><pub-id pub-id-type="pmid">12596261</pub-id></citation></ref><ref id="b40"><label>40</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rohl</surname><given-names>C.A.</given-names></name><name><surname>Strauss</surname><given-names>C.E.</given-names></name><name><surname>Chivian</surname><given-names>D.</given-names></name><name><surname>Baker</surname><given-names>D.</given-names></name></person-group><article-title>Modeling structurally variable regions in homologous proteins with rosetta</article-title><source>Proteins</source><year>2004</year><volume>55</volume><fpage>656</fpage><lpage>677</lpage><pub-id pub-id-type="pmid">15103629</pub-id></citation></ref><ref id="b41"><label>41</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Jacobson</surname><given-names>M.P.</given-names></name><name><surname>Pincus</surname><given-names>D.L.</given-names></name><name><surname>Rapp</surname><given-names>C.S.</given-names></name><name><surname>Day</surname><given-names>T.J.</given-names></name><name><surname>Honig</surname><given-names>B.</given-names></name><name><surname>Shaw</surname><given-names>D.E.</given-names></name><name><surname>Friesner</surname><given-names>R.A.</given-names></name></person-group><article-title>A hierarchical approach to all-atom protein loop prediction</article-title><source>Proteins</source><year>2004</year><volume>55</volume><fpage>351</fpage><lpage>367</lpage><pub-id pub-id-type="pmid">15048827</pub-id></citation></ref><ref id="b42"><label>42</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>M.R.</given-names></name><name><surname>Tsai</surname><given-names>J.</given-names></name><name><surname>Baker</surname><given-names>D.</given-names></name><name><surname>Kollman</surname><given-names>P.A.</given-names></name></person-group><article-title>Molecular dynamics in the endgame of protein structure prediction</article-title><source>J. Mol. Biol.</source><year>2001</year><volume>313</volume><fpage>417</fpage><lpage>430</lpage><pub-id pub-id-type="pmid">11800566</pub-id></citation></ref><ref id="b43"><label>43</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Fan</surname><given-names>H.</given-names></name><name><surname>Mark</surname><given-names>A.E.</given-names></name></person-group><article-title>Refinement of homology-based protein structures by molecular dynamics simulation techniques</article-title><source>Protein Sci.</source><year>2004</year><volume>13</volume><fpage>211</fpage><lpage>220</lpage><pub-id pub-id-type="pmid">14691236</pub-id></citation></ref><ref id="b44"><label>44</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Misura</surname><given-names>K.M.</given-names></name><name><surname>Baker</surname><given-names>D.</given-names></name></person-group><article-title>Progress and challenges in high-resolution refinement of protein structure models</article-title><source>Proteins</source><year>2005</year><volume>59</volume><fpage>15</fpage><lpage>29</lpage><pub-id pub-id-type="pmid">15690346</pub-id></citation></ref><ref id="b45"><label>45</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Taylor</surname><given-names>W.R.</given-names></name></person-group><article-title>Protein structural domain identification</article-title><source>Protein Eng.</source><year>1999</year><volume>12</volume><fpage>203</fpage><lpage>216</lpage><pub-id pub-id-type="pmid">10235621</pub-id></citation></ref><ref id="b46"><label>46</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pearl</surname><given-names>F.</given-names></name><name><surname>Todd</surname><given-names>A.</given-names></name><name><surname>Sillitoe</surname><given-names>I.</given-names></name><name><surname>Dibley</surname><given-names>M.</given-names></name><name><surname>Redfern</surname><given-names>O.</given-names></name><name><surname>Lewis</surname><given-names>T.</given-names></name><name><surname>Bennett</surname><given-names>C.</given-names></name><name><surname>Marsden</surname><given-names>R.</given-names></name><name><surname>Grant</surname><given-names>A.</given-names></name><name><surname>Lee</surname><given-names>D.</given-names></name><etal/></person-group><article-title>The CATH Domain Structure Database and related resources Gene3D and DHS provide comprehensive domain family information for genome analysis</article-title><source>Nucleic Acids Res.</source><year>2005</year><volume>33</volume><fpage>D247</fpage><lpage>D251</lpage><pub-id pub-id-type="pmid">15608188</pub-id></citation></ref><ref id="b47"><label>47</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Schaffer</surname><given-names>A.A.</given-names></name><name><surname>Aravind</surname><given-names>L.</given-names></name><name><surname>Madden</surname><given-names>T.L.</given-names></name><name><surname>Shavirin</surname><given-names>S.</given-names></name><name><surname>Spouge</surname><given-names>J.L.</given-names></name><name><surname>Wolf</surname><given-names>Y.I.</given-names></name><name><surname>Koonin</surname><given-names>E.V.</given-names></name><name><surname>Altschul</surname><given-names>S.F.</given-names></name></person-group><article-title>Improving the accuracy of PSI-BLAST protein database searches with composition-based statistics and other refinements</article-title><source>Nucleic Acids Res.</source><year>2001</year><volume>29</volume><fpage>2994</fpage><lpage>3005</lpage><pub-id pub-id-type="pmid">11452024</pub-id></citation></ref><ref id="b48"><label>48</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Jaroszewski</surname><given-names>L.</given-names></name><name><surname>Rychlewski</surname><given-names>L.</given-names></name><name><surname>Li</surname><given-names>Z.</given-names></name><name><surname>Li</surname><given-names>W.</given-names></name><name><surname>Godzik</surname><given-names>A.</given-names></name></person-group><article-title>FFAS03: a server for profile&#x02013;profile sequence alignments</article-title><source>Nucleic Acids Res.</source><year>2005</year><volume>33</volume><fpage>W284</fpage><lpage>W288</lpage><pub-id pub-id-type="pmid">15980471</pub-id></citation></ref><ref id="b49"><label>49</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bellman</surname><given-names>R.</given-names></name></person-group><article-title>On the theory of dynamic programming</article-title><source>Proc. Natl Acad. Sci. USA</source><year>1952</year><volume>38</volume><fpage>716</fpage><lpage>719</lpage><pub-id pub-id-type="pmid">16589166</pub-id></citation></ref><ref id="b50"><label>50</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Needleman</surname><given-names>S.B.</given-names></name><name><surname>Wunsch</surname><given-names>C.D.</given-names></name></person-group><article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins</article-title><source>J. Mol. Biol.</source><year>1970</year><volume>48</volume><fpage>443</fpage><lpage>453</lpage><pub-id pub-id-type="pmid">5420325</pub-id></citation></ref><ref id="b51"><label>51</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hirschberg</surname><given-names>D.S.</given-names></name></person-group><article-title>Linear space algorithm for computing maximal common subsequences</article-title><source>Commun. ACM</source><year>1975</year><volume>18</volume><fpage>341</fpage><lpage>343</lpage></citation></ref><ref id="b52"><label>52</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>T.F.</given-names></name><name><surname>Waterman</surname><given-names>M.S.</given-names></name></person-group><article-title>Identification of common molecular subsequences</article-title><source>J. Mol. Biol.</source><year>1981</year><volume>147</volume><fpage>195</fpage><lpage>197</lpage><pub-id pub-id-type="pmid">7265238</pub-id></citation></ref><ref id="b53"><label>53</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Altschul</surname><given-names>S.F.</given-names></name><name><surname>Erickson</surname><given-names>B.W.</given-names></name></person-group><article-title>Optimal sequence alignment using affine gap costs</article-title><source>Bull. Math. Biol.</source><year>1986</year><volume>48</volume><fpage>603</fpage><lpage>616</lpage><pub-id pub-id-type="pmid">3580642</pub-id></citation></ref><ref id="b54"><label>54</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Myers</surname><given-names>E.W.</given-names></name><name><surname>Miller</surname><given-names>W.</given-names></name></person-group><article-title>Optimal alignments in linear space</article-title><source>Comput. Appl. Biosci.</source><year>1988</year><volume>4</volume><fpage>11</fpage><lpage>17</lpage><pub-id pub-id-type="pmid">3382986</pub-id></citation></ref><ref id="b55"><label>55</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Chivian</surname><given-names>D.</given-names></name><name><surname>Kim</surname><given-names>D.E.</given-names></name><name><surname>Malmstrom</surname><given-names>L.</given-names></name><name><surname>Bradley</surname><given-names>P.</given-names></name><name><surname>Robertson</surname><given-names>T.</given-names></name><name><surname>Murphy</surname><given-names>P.</given-names></name><name><surname>Strauss</surname><given-names>C.E.</given-names></name><name><surname>Bonneau</surname><given-names>R.</given-names></name><name><surname>Rohl</surname><given-names>C.A.</given-names></name><name><surname>Baker</surname><given-names>D.</given-names></name></person-group><article-title>Automated prediction of CASP-5 structures using the Robetta server</article-title><source>Proteins</source><year>2003</year><volume>53</volume><fpage>524</fpage><lpage>533</lpage><pub-id pub-id-type="pmid">14579342</pub-id></citation></ref><ref id="b56"><label>56</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Holm</surname><given-names>L.</given-names></name><name><surname>Sander</surname><given-names>C.</given-names></name></person-group><article-title>Mapping the protein universe</article-title><source>Science</source><year>1996</year><volume>273</volume><fpage>595</fpage><lpage>603</lpage><pub-id pub-id-type="pmid">8662544</pub-id></citation></ref><ref id="b57"><label>57</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>D.T.</given-names></name></person-group><article-title>Protein secondary structure prediction based on position-specific scoring matrices</article-title><source>J. Mol. Biol.</source><year>1999</year><volume>292</volume><fpage>195</fpage><lpage>202</lpage><pub-id pub-id-type="pmid">10493868</pub-id></citation></ref><ref id="b58"><label>58</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kabsch</surname><given-names>W.</given-names></name><name><surname>Sander</surname><given-names>C.</given-names></name></person-group><article-title>Dictionary of protein secondary structure: pattern recognition of hydrogen-bonded and geometrical features</article-title><source>Biopolymers</source><year>1983</year><volume>22</volume><fpage>2577</fpage><lpage>2637</lpage><pub-id pub-id-type="pmid">6667333</pub-id></citation></ref><ref id="b59"><label>59</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bradley</surname><given-names>P.</given-names></name><name><surname>Chivian</surname><given-names>D.</given-names></name><name><surname>Meiler</surname><given-names>J.</given-names></name><name><surname>Misura</surname><given-names>K.M.</given-names></name><name><surname>Rohl</surname><given-names>C.A.</given-names></name><name><surname>Schief</surname><given-names>W.R.</given-names></name><name><surname>Wedemeyer</surname><given-names>W.J.</given-names></name><name><surname>Schueler-Furman</surname><given-names>O.</given-names></name><name><surname>Murphy</surname><given-names>P.</given-names></name><name><surname>Schonbrun</surname><given-names>J.</given-names></name><etal/></person-group><article-title>Rosetta predictions in CASP5: successes, failures, and prospects for complete automation</article-title><source>Proteins</source><year>2003</year><volume>53</volume><fpage>457</fpage><lpage>468</lpage><pub-id pub-id-type="pmid">14579334</pub-id></citation></ref><ref id="b60"><label>60</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Chivian</surname><given-names>D.</given-names></name><name><surname>Kim</surname><given-names>D.E.</given-names></name><name><surname>Malmstrom</surname><given-names>L.</given-names></name><name><surname>Schonbrun</surname><given-names>J.</given-names></name><name><surname>Rohl</surname><given-names>C.A.</given-names></name><name><surname>Baker</surname><given-names>D.</given-names></name></person-group><article-title>Prediction of CASP6 structures using automated Robetta protocols</article-title><source>Proteins</source><year>2005</year><volume>61</volume><fpage>157</fpage><lpage>166</lpage><pub-id pub-id-type="pmid">16187358</pub-id></citation></ref><ref id="b61"><label>61</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Henikoff</surname><given-names>S.</given-names></name><name><surname>Henikoff</surname><given-names>J.G.</given-names></name></person-group><article-title>Amino acid substitution matrices from protein blocks</article-title><source>Proc. Natl Acad. Sci. USA</source><year>1992</year><volume>89</volume><fpage>10915</fpage><lpage>10919</lpage><pub-id pub-id-type="pmid">1438297</pub-id></citation></ref><ref id="b62"><label>62</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Karplus</surname><given-names>K.</given-names></name><name><surname>Barrett</surname><given-names>C.</given-names></name><name><surname>Hughey</surname><given-names>R.</given-names></name></person-group><article-title>Hidden Markov models for detecting remote protein homologies</article-title><source>Bioinformatics</source><year>1998</year><volume>14</volume><fpage>846</fpage><lpage>856</lpage><pub-id pub-id-type="pmid">9927713</pub-id></citation></ref><ref id="b63"><label>63</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Park</surname><given-names>J.</given-names></name><name><surname>Karplus</surname><given-names>K.</given-names></name><name><surname>Barrett</surname><given-names>C.</given-names></name><name><surname>Hughey</surname><given-names>R.</given-names></name><name><surname>Haussler</surname><given-names>D.</given-names></name><name><surname>Hubbard</surname><given-names>T.</given-names></name><name><surname>Chothia</surname><given-names>C.</given-names></name></person-group><article-title>Sequence comparisons using multiple sequences detect three times as many remote homologues as pairwise methods</article-title><source>J. Mol. Biol.</source><year>1998</year><volume>284</volume><fpage>1201</fpage><lpage>1210</lpage><pub-id pub-id-type="pmid">9837738</pub-id></citation></ref><ref id="b64"><label>64</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Canutescu</surname><given-names>A.A.</given-names></name><name><surname>Dunbrack</surname><given-names>R.L.</given-names><suffix>Jr</suffix></name></person-group><article-title>Cyclic coordinate descent: a robotics algorithm for protein loop closure</article-title><source>Protein Sci.</source><year>2003</year><volume>12</volume><fpage>963</fpage><lpage>972</lpage><pub-id pub-id-type="pmid">12717019</pub-id></citation></ref><ref id="b65"><label>65</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rohl</surname><given-names>C.A.</given-names></name><name><surname>Strauss</surname><given-names>C.E.</given-names></name><name><surname>Misura</surname><given-names>K.M.</given-names></name><name><surname>Baker</surname><given-names>D.</given-names></name></person-group><article-title>Protein structure prediction using Rosetta</article-title><source>Methods Enzymol.</source><year>2004</year><volume>383</volume><fpage>66</fpage><lpage>93</lpage><pub-id pub-id-type="pmid">15063647</pub-id></citation></ref><ref id="b66"><label>66</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kuhlman</surname><given-names>B.</given-names></name><name><surname>Baker</surname><given-names>D.</given-names></name></person-group><article-title>Native protein sequences are close to optimal for their structures</article-title><source>Proc. Natl Acad. Sci. USA</source><year>2000</year><volume>97</volume><fpage>10383</fpage><lpage>10388</lpage><pub-id pub-id-type="pmid">10984534</pub-id></citation></ref><ref id="b67"><label>67</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Sauder</surname><given-names>J.M.</given-names></name><name><surname>Arthur</surname><given-names>J.W.</given-names></name><name><surname>Dunbrack</surname><given-names>R.L.</given-names><suffix>Jr</suffix></name></person-group><article-title>Large-scale comparison of protein sequence alignment algorithms with structure alignments</article-title><source>Proteins</source><year>2000</year><volume>40</volume><fpage>6</fpage><lpage>22</lpage><pub-id pub-id-type="pmid">10813826</pub-id></citation></ref><ref id="b68"><label>68</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Murzin</surname><given-names>A.G.</given-names></name><name><surname>Brenner</surname><given-names>S.E.</given-names></name><name><surname>Hubbard</surname><given-names>T.</given-names></name><name><surname>Chothia</surname><given-names>C.</given-names></name></person-group><article-title>SCOP: a structural classification of proteins database for the investigation of sequences and structures</article-title><source>J. Mol. Biol.</source><year>1995</year><volume>247</volume><fpage>536</fpage><lpage>540</lpage><pub-id pub-id-type="pmid">7723011</pub-id></citation></ref><ref id="b69"><label>69</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Shindyalov</surname><given-names>I.N.</given-names></name><name><surname>Bourne</surname><given-names>P.E.</given-names></name></person-group><article-title>Protein structure alignment by incremental combinatorial extension (CE) of the optimal path</article-title><source>Protein Eng.</source><year>1998</year><volume>11</volume><fpage>739</fpage><lpage>747</lpage><pub-id pub-id-type="pmid">9796821</pub-id></citation></ref><ref id="b70"><label>70</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rychlewski</surname><given-names>L.</given-names></name><name><surname>Fischer</surname><given-names>D.</given-names></name></person-group><article-title>LiveBench-8: the large-scale, continuous assessment of automated protein structure prediction</article-title><source>Protein Sci.</source><year>2005</year><volume>14</volume><fpage>240</fpage><lpage>245</lpage><pub-id pub-id-type="pmid">15608124</pub-id></citation></ref><ref id="b71"><label>71</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ortiz</surname><given-names>A.R.</given-names></name><name><surname>Strauss</surname><given-names>C.E.</given-names></name><name><surname>Olmea</surname><given-names>O.</given-names></name></person-group><article-title>MAMMOTH (matching molecular models obtained from theory): an automated method for model comparison</article-title><source>Protein Sci.</source><year>2002</year><volume>11</volume><fpage>2606</fpage><lpage>2621</lpage><pub-id pub-id-type="pmid">12381844</pub-id></citation></ref><ref id="b72"><label>72</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Siew</surname><given-names>N.</given-names></name><name><surname>Elofsson</surname><given-names>A.</given-names></name><name><surname>Rychlewski</surname><given-names>L.</given-names></name><name><surname>Fischer</surname><given-names>D.</given-names></name></person-group><article-title>MaxSub: an automated measure for the assessment of protein structure prediction quality</article-title><source>Bioinformatics</source><year>2000</year><volume>16</volume><fpage>776</fpage><lpage>785</lpage><pub-id pub-id-type="pmid">11108700</pub-id></citation></ref><ref id="b73"><label>73</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Plewczynski</surname><given-names>D.</given-names></name><name><surname>Pas</surname><given-names>J.</given-names></name><name><surname>von Grotthuss</surname><given-names>M.</given-names></name><name><surname>Rychlewski</surname><given-names>L.</given-names></name></person-group><article-title>3D-Hit: fast structural comparison of proteins</article-title><source>Appl. Bioinformatics</source><year>2002</year><volume>1</volume><fpage>223</fpage><lpage>225</lpage><pub-id pub-id-type="pmid">15130838</pub-id></citation></ref><ref id="b74"><label>74</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Simons</surname><given-names>K.T.</given-names></name><name><surname>Kooperberg</surname><given-names>C.</given-names></name><name><surname>Huang</surname><given-names>E.</given-names></name><name><surname>Baker</surname><given-names>D.</given-names></name></person-group><article-title>Assembly of protein tertiary structures from fragments with similar local sequences using simulated annealing and Bayesian scoring functions</article-title><source>J. Mol. Biol.</source><year>1997</year><volume>268</volume><fpage>209</fpage><lpage>225</lpage><pub-id pub-id-type="pmid">9149153</pub-id></citation></ref><ref id="b75"><label>75</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dunbrack</surname><given-names>R.L.</given-names><suffix>Jr</suffix></name><name><surname>Cohen</surname><given-names>F.E.</given-names></name></person-group><article-title>Bayesian statistical analysis of protein side-chain rotamer preferences</article-title><source>Protein Sci.</source><year>1997</year><volume>6</volume><fpage>1661</fpage><lpage>1681</lpage><pub-id pub-id-type="pmid">9260279</pub-id></citation></ref><ref id="b76"><label>76</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Shortle</surname><given-names>D.</given-names></name><name><surname>Simons</surname><given-names>K.T.</given-names></name><name><surname>Baker</surname><given-names>D.</given-names></name></person-group><article-title>Clustering of low-energy conformations near the native structures of small proteins</article-title><source>Proc. Natl Acad. Sci. USA</source><year>1998</year><volume>95</volume><fpage>11158</fpage><lpage>11162</lpage><pub-id pub-id-type="pmid">9736706</pub-id></citation></ref><ref id="b77"><label>77</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bonneau</surname><given-names>R.</given-names></name><name><surname>Strauss</surname><given-names>C.E.</given-names></name><name><surname>Baker</surname><given-names>D.</given-names></name></person-group><article-title>Improving the performance of Rosetta using multiple sequence alignment information and global measures of hydrophobic core formation</article-title><source>Proteins</source><year>2001</year><volume>43</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="pmid">11170209</pub-id></citation></ref><ref id="b78"><label>78</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wallner</surname><given-names>B.</given-names></name><name><surname>Fang</surname><given-names>H.</given-names></name><name><surname>Elofsson</surname><given-names>A.</given-names></name></person-group><article-title>Automatic consensus-based fold recognition using Pcons, ProQ, and Pmodeller</article-title><source>Proteins</source><year>2003</year><volume>53</volume><fpage>534</fpage><lpage>541</lpage><pub-id pub-id-type="pmid">14579343</pub-id></citation></ref><ref id="b79"><label>79</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Prasad</surname><given-names>J.C.</given-names></name><name><surname>Comeau</surname><given-names>S.R.</given-names></name><name><surname>Vajda</surname><given-names>S.</given-names></name><name><surname>Camacho</surname><given-names>C.J.</given-names></name></person-group><article-title>Consensus alignment for reliable framework prediction in homology modeling</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><fpage>1682</fpage><lpage>1691</lpage><pub-id pub-id-type="pmid">12967965</pub-id></citation></ref><ref id="b80"><label>80</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>D.E.</given-names></name><name><surname>Chivian</surname><given-names>D.</given-names></name><name><surname>Baker</surname><given-names>D.</given-names></name></person-group><article-title>Protein structure prediction and analysis using the Robetta server</article-title><source>Nucleic Acids Res.</source><year>2004</year><volume>32</volume><fpage>W526</fpage><lpage>W531</lpage><pub-id pub-id-type="pmid">15215442</pub-id></citation></ref><ref id="b81"><label>81</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Tramontano</surname><given-names>A.</given-names></name><name><surname>Leplae</surname><given-names>R.</given-names></name><name><surname>Morea</surname><given-names>V.</given-names></name></person-group><article-title>Analysis and assessment of comparative modeling predictions in CASP4</article-title><source>Proteins</source><year>2001</year><issue>Suppl 5</issue><fpage>22</fpage><lpage>38</lpage><pub-id pub-id-type="pmid">11835479</pub-id></citation></ref><ref id="b82"><label>82</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Sippl</surname><given-names>M.J.</given-names></name><name><surname>Lackner</surname><given-names>P.</given-names></name><name><surname>Domingues</surname><given-names>F.S.</given-names></name><name><surname>Prlic</surname><given-names>A.</given-names></name><name><surname>Malik</surname><given-names>R.</given-names></name><name><surname>Andreeva</surname><given-names>A.</given-names></name><name><surname>Wiederstein</surname><given-names>M.</given-names></name></person-group><article-title>Assessment of the CASP4 fold recognition category</article-title><source>Proteins</source><year>2001</year><issue>Suppl 5</issue><fpage>55</fpage><lpage>67</lpage><pub-id pub-id-type="pmid">11835482</pub-id></citation></ref><ref id="b83"><label>83</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kinch</surname><given-names>L.N.</given-names></name><name><surname>Wrabl</surname><given-names>J.O.</given-names></name><name><surname>Krishna</surname><given-names>S.S.</given-names></name><name><surname>Majumdar</surname><given-names>I.</given-names></name><name><surname>Sadreyev</surname><given-names>R.I.</given-names></name><name><surname>Qi</surname><given-names>Y.</given-names></name><name><surname>Pei</surname><given-names>J.</given-names></name><name><surname>Cheng</surname><given-names>H.</given-names></name><name><surname>Grishin</surname><given-names>N.V.</given-names></name></person-group><article-title>CASP5 assessment of fold recognition target predictions</article-title><source>Proteins</source><year>2003</year><volume>53</volume><fpage>395</fpage><lpage>409</lpage><pub-id pub-id-type="pmid">14579328</pub-id></citation></ref><ref id="b84"><label>84</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Fischer</surname><given-names>D.</given-names></name><name><surname>Rychlewski</surname><given-names>L.</given-names></name><name><surname>Dunbrack</surname><given-names>R.L.</given-names><suffix>Jr</suffix></name><name><surname>Ortiz</surname><given-names>A.R.</given-names></name><name><surname>Elofsson</surname><given-names>A.</given-names></name></person-group><article-title>CAFASP3: the third critical assessment of fully automated structure prediction methods</article-title><source>Proteins</source><year>2003</year><volume>53</volume><fpage>503</fpage><lpage>516</lpage><pub-id pub-id-type="pmid">14579340</pub-id></citation></ref><ref id="b85"><label>85</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rychlewski</surname><given-names>L.</given-names></name><name><surname>Fischer</surname><given-names>D.</given-names></name><name><surname>Elofsson</surname><given-names>A.</given-names></name></person-group><article-title>LiveBench-6: large-scale automated evaluation of protein structure prediction servers</article-title><source>Proteins</source><year>2003</year><volume>53</volume><fpage>542</fpage><lpage>547</lpage><pub-id pub-id-type="pmid">14579344</pub-id></citation></ref><ref id="b86"><label>86</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>G.</given-names></name><name><surname>Jin</surname><given-names>Y.</given-names></name><name><surname>Dunbrack</surname><given-names>R.L.</given-names><suffix>Jr</suffix></name></person-group><article-title>Assessment of fold recognition predictions in CASP6</article-title><source>Proteins</source><year>2005</year><volume>61</volume><fpage>46</fpage><lpage>66</lpage><pub-id pub-id-type="pmid">16187346</pub-id></citation></ref><ref id="b87"><label>87</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Zemla</surname><given-names>A.</given-names></name></person-group><article-title>LGA: A method for finding 3D similarities in protein structures</article-title><source>Nucleic Acids Res.</source><year>2003</year><volume>31</volume><fpage>3370</fpage><lpage>3374</lpage><pub-id pub-id-type="pmid">12824330</pub-id></citation></ref></ref-list><sec sec-type="display-objects"><title>Figures and Tables</title><fig id="fig1" position="float"><label>Figure 1</label><caption><p>Inputs to K*Sync alignment method. K*Sync combines sequence information with structural information to produce an alignment by dynamic programming. The inputs and weights on terms may be varied. The default alignment uses secondary structure predicted by PSIPRED and sequence comparison by the inner product of the residue substitution frequency profiles. In the diagram, &#x02018;+&#x02019; indicates a bonus, &#x02018;&#x02212;&#x02019; a penalty, &#x02018;&#x0003c;=&#x0003e;&#x02019; an alignment between two positions with the given characteristic.</p></caption><graphic xlink:href="gkl480f1"/></fig><fig id="fig2" position="float"><label>Figure 2</label><caption><p>Evaluation of K*Sync default alignments. Average accuracy and completeness of alignments for targets in SCOP1.38 test set with respect to a structure&#x02013;structure alignment (CE) are shown for profile&#x02013;sequence alignment (PSSM, in dashed gray), profile&#x02013;profile alignment (Inner Product, in solid gray), the combination of profile&#x02013;profile and structural information (K*Sync, in solid black), and another structure&#x02013;structure alignment method (Dali, in dashed black). Targets are grouped into 5% identity bins (based on the CE alignment). Note that the Dali alignment diverges from the CE alignment as the pairs become more remote, owing to our strict alignment equivalence requirement.</p></caption><graphic xlink:href="gkl480f2"/></fig><fig id="fig3" position="float"><label>Figure 3</label><caption><p>Sampling of near best possible alignments. Histogram of number of targets with a member of the K*Sync ensemble with a model close in quality to the model derived from the 3D-Pair alignment of the query native structure to the structure of the best parent (that provides the most coordinates similar to the query). Horizontal axis represents the difference in the MAMMOTH MaxSub score of the 3D-Pair model and the best model in the ensemble (with values indicating the upper bound for the bin), and <italic>y</italic>-axis is the number of targets that are within that upper bound.</p></caption><graphic xlink:href="gkl480f3"/></fig><fig id="fig4" position="float"><label>Figure 4</label><caption><p>Evaluation of ensemble quality. Comparisons in ensemble quality, as measured by MAMMOTH MaxSub (black, best in set; gray, average of set) are shown for 3D-Pair alignments between query native structure and parents from detection method, alignments from detection method (3D-Jury, FFAS03 or PSI-BLAST), and progressive stages in modeling.</p></caption><graphic xlink:href="gkl480f4"/></fig><fig id="fig5" position="float"><label>Figure 5</label><caption><p>Comparison of strategies for selection from the ensemble. Average MAMMOTH MaxSub scores for 3D-Pair set of alignments, detection method set of alignments, K*Sync ensemble set of alignments and models selected by various measures from K*Sync ensemble both before and after loop modeling. Best in set shown in black, average of set in gray, selection of a template-only model in red, selection of a model after modeling short loops (but with a quality evaluated prior to loop modeling) in orange, and selection of a model including short loops (and with a quality evaluated with the loops present) in blue. The average of the models resulting from the K*Sync default alignment is shown as well as those selected from the ensemble using the hydrophobic burial preference (&#x02018;h&#x003c6;_burial&#x02019;), the side-chain centroid representation energy function (&#x02018;centroid&#x02019;), the full-atom representation energy function (&#x02018;full_atom&#x02019;), and the alignment consensus score (&#x02018;consensus&#x02019;). Also shown is the average of the models selected using sum-of-ranks combination scores of these measures (indicated by those scores with a &#x02018;+&#x02019; in the name).</p></caption><graphic xlink:href="gkl480f5"/></fig><fig id="fig6" position="float"><label>Figure 6</label><caption><p>Loop modeling can improve both sampling and selection. The side-chain centroid energy score with respect the similarity of each model to the query's native structure, as measured by 1.0-MAMMOTH MaxSub (for description see Supplementary Data), both before and after modeling of short loops for targets 20888 (1q4mA) and 20415 (1j0sA). Each point represents a model, with the first parent shown with red points and up to four alternate parents with the other colors. For comparison, the quality of the model that would have resulted from the detection's alignment is shown with a vertical line with a circle on the end, with a solid line for the first parent and a dashed line for the best alternate (target 20415's first detection was the best). The vertical lines with boxes at the ends indicate the quality of the 3D-Pair alignment between the query native structure and the first parent (for both target 20888 and 20415 the first parent was the best) and approximates the upper bound. The quality of the model from the default K*Sync alignment is indicated with a blue asterisk. The native structure of each query and the lowest energy model after loop modeling are shown with colored cartoons for the template regions (with blue at the N-terminus and red at the C-terminus), and gray backbone representation for the regions that were modeled with loops in the low energy model.</p></caption><graphic xlink:href="gkl480f6"/></fig><fig id="fig7" position="float"><label>Figure 7</label><caption><p>Scoring of alignment ensembles. The similarity to the query native structure of each model in the initial template-only ensemble (before loop modeling) with respect to a selection score, with (<bold>a</bold>) the hydrophobic burial score, (<bold>b</bold>) the full-atom energy and (<bold>c</bold>) the consensus score. An example target in each of the three difficulty regimes (3D-Jury, FFAS03 and PSI-BLAST) is shown, in the same scheme as Figure 6. Targets are: 3D-Jury regime, 20906 (1uocA); FFAS03 regime, 20415 (1j0sA); and PSI-BLAST regime, 17597 (1iyzA). The negative of the consensus score is shown so the trend in (c) is similar to that in (a) and (b).</p></caption><graphic xlink:href="gkl480f7"/></fig><fig id="fig8" position="float"><label>Figure 8</label><caption><p>Consensus score as a function of ensemble size. Selection by consensus score for the 3D-Jury regime targets is shown, with consensus frequencies derived from a randomized ensemble. The ensemble from which models were selected was held constant, whereas the ensemble from which the consensus frequencies were derived was varied. The size of the randomized ensemble is varied (<italic>x</italic>-axis), so that the members of smaller ensembles are subsets of the larger ensembles, with the smallest ensemble comprised solely of the K*Sync default alignment to each parent. The <italic>y</italic>-axis reports the similarity to the query native structure of the selected model, as measured by MAMMOTH MaxSub. (<bold>a</bold>) Ensembles of size up to 500 members. (<bold>b</bold>) Ensembles of size up to &#x0223c;3500 members [so (a) is a &#x02018;close-up&#x02019; of the first part of (b)]. The power of the consensus score when the frequencies are determined separately for each parent (&#x02018;random-separate&#x02019;) or with respect to the reference parent (&#x02018;random-combined&#x02019;) is shown. Also shown in (b) is the power of the consensus score when determined from the filtered ensemble, both with frequencies determined separately for each parent (&#x02018;ensemble-separate&#x02019;) and with respect to the reference parent (&#x02018;ensemble-combined&#x02019;). The &#x02018;ensemble-combined&#x02019; is the form of the consensus score that was actually used.</p></caption><graphic xlink:href="gkl480f8"/></fig><fig id="fig9" position="float"><label>Figure 9</label><caption><p>Selection from backbone optimized ensembles. Scheme is the same as that used in <xref ref-type="fig" rid="fig5">Figure 5</xref>, with additional average quality scores for models selected from ensembles after addition of long loops (&#x02018;+ Long Loops&#x02019;, in magenta) and full-length backbone optimization (&#x02018;+ Backbone Optimization&#x02019;, in green). Also shown are the quality of the initial template of the selected model for the long loop model (&#x02018;+ Long Loops (IT)&#x02019;, in turquoise) and the initial template for the backbone optimized model (&#x02018;+ Backbone Optimization (IT)&#x02019;, in yellow).</p></caption><graphic xlink:href="gkl480f9"/></fig><table-wrap id="tbl1" position="float"><label>Table 1</label><caption><p>Inclusion of obligate terms has greatest impact in low identity regime</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="1" colspan="1">Identity (%)</th><th align="left" rowspan="1" colspan="1">Targets</th><th align="left" rowspan="1" colspan="1">Threshold</th><th colspan="3" align="left" rowspan="1">Accuracy</th><th colspan="3" align="left" rowspan="1">Completeness</th></tr><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"/><th align="left" rowspan="1" colspan="1">Better</th><th align="left" rowspan="1" colspan="1">Unchanged</th><th align="left" rowspan="1" colspan="1">Worse</th><th align="left" rowspan="1" colspan="1">Better</th><th align="left" rowspan="1" colspan="1">Unchanged</th><th align="left" rowspan="1" colspan="1">Worse</th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">0&#x02013;5</td><td align="left" rowspan="1" colspan="1">22</td><td align="char" char="." rowspan="1" colspan="1">0.05</td><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1">18</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">4</td><td align="left" rowspan="1" colspan="1">17</td><td align="left" rowspan="1" colspan="1">1</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td align="char" char="." rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1">19</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1">18</td><td align="left" rowspan="1" colspan="1">1</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td align="char" char="." rowspan="1" colspan="1">0.20</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">21</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">21</td><td align="left" rowspan="1" colspan="1">0</td></tr><tr><td align="left" rowspan="1" colspan="1">5&#x02013;10</td><td align="left" rowspan="1" colspan="1">69</td><td align="char" char="." rowspan="1" colspan="1">0.05</td><td align="left" rowspan="1" colspan="1">11</td><td align="left" rowspan="1" colspan="1">49</td><td align="left" rowspan="1" colspan="1">9</td><td align="left" rowspan="1" colspan="1">10</td><td align="left" rowspan="1" colspan="1">45</td><td align="left" rowspan="1" colspan="1">14</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td align="char" char="." rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">7</td><td align="left" rowspan="1" colspan="1">57</td><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1">58</td><td align="left" rowspan="1" colspan="1">6</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td align="char" char="." rowspan="1" colspan="1">0.20</td><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1">65</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1">64</td><td align="left" rowspan="1" colspan="1">2</td></tr><tr><td align="left" rowspan="1" colspan="1">10&#x02013;15</td><td align="left" rowspan="1" colspan="1">58</td><td align="char" char="." rowspan="1" colspan="1">0.05</td><td align="left" rowspan="1" colspan="1">11</td><td align="left" rowspan="1" colspan="1">38</td><td align="left" rowspan="1" colspan="1">9</td><td align="left" rowspan="1" colspan="1">10</td><td align="left" rowspan="1" colspan="1">38</td><td align="left" rowspan="1" colspan="1">10</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td align="char" char="." rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1">47</td><td align="left" rowspan="1" colspan="1">6</td><td align="left" rowspan="1" colspan="1">4</td><td align="left" rowspan="1" colspan="1">46</td><td align="left" rowspan="1" colspan="1">8</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td align="char" char="." rowspan="1" colspan="1">0.20</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">53</td><td align="left" rowspan="1" colspan="1">4</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">55</td><td align="left" rowspan="1" colspan="1">2</td></tr><tr><td align="left" rowspan="1" colspan="1">15&#x02013;20</td><td align="left" rowspan="1" colspan="1">47</td><td align="char" char="." rowspan="1" colspan="1">0.05</td><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1">38</td><td align="left" rowspan="1" colspan="1">4</td><td align="left" rowspan="1" colspan="1">4</td><td align="left" rowspan="1" colspan="1">40</td><td align="left" rowspan="1" colspan="1">3</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td align="char" char="." rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1">41</td><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1">43</td><td align="left" rowspan="1" colspan="1">2</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td align="char" char="." rowspan="1" colspan="1">0.20</td><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1">43</td><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">44</td><td align="left" rowspan="1" colspan="1">2</td></tr><tr><td align="left" rowspan="1" colspan="1">20&#x02013;25</td><td align="left" rowspan="1" colspan="1">35</td><td align="char" char="." rowspan="1" colspan="1">0.05</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">32</td><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">32</td><td align="left" rowspan="1" colspan="1">2</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td align="char" char="." rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">33</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">34</td><td align="left" rowspan="1" colspan="1">0</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td align="char" char="." rowspan="1" colspan="1">0.20</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">35</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">35</td><td align="left" rowspan="1" colspan="1">0</td></tr><tr><td align="left" rowspan="1" colspan="1">25&#x02013;30</td><td align="left" rowspan="1" colspan="1">27</td><td align="char" char="." rowspan="1" colspan="1">0.05</td><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1">23</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1">25</td><td align="left" rowspan="1" colspan="1">0</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td align="char" char="." rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">27</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">27</td><td align="left" rowspan="1" colspan="1">0</td></tr><tr><td align="left" rowspan="1" colspan="1">30&#x02013;35</td><td align="left" rowspan="1" colspan="1">20</td><td align="char" char="." rowspan="1" colspan="1">0.05</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">20</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">20</td><td align="left" rowspan="1" colspan="1">0</td></tr><tr><td align="left" rowspan="1" colspan="1">35&#x02013;40</td><td align="left" rowspan="1" colspan="1">15</td><td align="char" char="." rowspan="1" colspan="1">0.05</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">15</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">15</td><td align="left" rowspan="1" colspan="1">0</td></tr></tbody></table><table-wrap-foot><fn><p>Evaluation of accuracy and completeness for K*Sync default alignments accomplished both with and without obligateness terms on SCOP1.38 test set. Targets are grouped into 5% identity bins, as in Figure 2. The number of &#x02018;targets&#x02019; in each bin is reported. Also shown is the number of targets that have alignments that change in quality as a result of inclusion of the obligate terms with default weights. Change is defined as having an &#x02018;accuracy&#x02019; or &#x02018;completeness&#x02019; deviating by more than a given threshold than that of the default alignment without obligate terms, and are categorized as &#x02018;better&#x02019;, &#x02018;unchanged&#x02019; or &#x02018;worse&#x02019;.</p></fn></table-wrap-foot></table-wrap></sec></back></article>







<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id><journal-id journal-id-type="publisher-id">Nucleic Acids Research</journal-id><journal-title>Nucleic Acids Research</journal-title><issn pub-type="ppub">0305-1048</issn><issn pub-type="epub">1362-4962</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">17068079</article-id><article-id pub-id-type="pmc">PMC1635310</article-id><article-id pub-id-type="doi">10.1093/nar/gkl731</article-id><article-categories><subj-group subj-group-type="heading"><subject>Computational Biology</subject></subj-group></article-categories><title-group><article-title>Retrieval accuracy, statistical significance and compositional similarity in protein sequence database searches</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Yu</surname><given-names>Yi-Kuo</given-names></name></contrib><contrib contrib-type="author"><name><surname>Gertz</surname><given-names>E. Michael</given-names></name></contrib><contrib contrib-type="author"><name><surname>Agarwala</surname><given-names>Richa</given-names></name></contrib><contrib contrib-type="author"><name><surname>Sch&#x000e4;ffer</surname><given-names>Alejandro A.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Altschul</surname><given-names>Stephen F.</given-names></name><xref ref-type="corresp" rid="cor1">*</xref></contrib><aff><institution>National Center for Biotechnology Information, National Library of Medicine</institution><addr-line>NIH, DHHS, Bethesda, MD 20894, USA</addr-line></aff></contrib-group><author-notes><corresp id="cor1"><sup>*</sup>To whom correspondence should be addressed. Tel: +301 435 7803; Fax: +301 480 2288; Email: <email>altschul@ncbi.nlm.nih.gov</email></corresp></author-notes><!--For NAR: both ppub and collection dates generated for PMC processing 1/27/05 beck--><pub-date pub-type="collection"><month>11</month><year>2006</year></pub-date><pub-date pub-type="ppub"><month>11</month><year>2006</year></pub-date><pub-date pub-type="epub"><day>26</day><month>10</month><year>2006</year></pub-date><volume>34</volume><issue>20</issue><fpage>5966</fpage><lpage>5973</lpage><history><date date-type="received"><day>27</day><month>7</month><year>2006</year></date><date date-type="rev-recd"><day>15</day><month>9</month><year>2006</year></date><date date-type="accepted"><day>21</day><month>9</month><year>2006</year></date></history><copyright-statement>Published by Oxford University Press 2006</copyright-statement><copyright-year>2006</copyright-year><license license-type="openaccess"><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/2.0/uk/) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license><abstract><p>Protein sequence database search programs may be evaluated both for their retrieval accuracy&#x02014;the ability to separate meaningful from chance similarities&#x02014;and for the accuracy of their statistical assessments of reported alignments. However, methods for improving statistical accuracy can degrade retrieval accuracy by discarding compositional evidence of sequence relatedness. This evidence may be preserved by combining essentially independent measures of alignment and compositional similarity into a unified measure of sequence similarity. A version of the BLAST protein database search program, modified to employ this new measure, outperforms the baseline program in both retrieval and statistical accuracy on ASTRAL, a SCOP-based test set.</p></abstract></article-meta></front><body><sec><title>INTRODUCTION</title><p>Computer programs that search protein or DNA databases often are evaluated by their ability to distinguish true biological relationships from chance similarities. Such an evaluation requires a test query set and database for which the true relationships are known. Given a query sequence, a database search program returns alignments in some specific order, often ranked using an objective measure such as an alignment score, <italic>E</italic>-value or <italic>P</italic>-value. One way to evaluate search accuracy is with ROC (receiver operating characteristic) analysis (<xref ref-type="bibr" rid="b1">1</xref>). To produce a ROC curve, the number of true positives is plotted against the number of false positives returned as one descends the retrieval list. The ROC<italic><sub>n</sub></italic> score, the normalized area under this curve up to the first <italic>n</italic> false positives, has become a popular measure of search accuracy. ROC<italic><sub>n</sub></italic> scores may be calculated for individual queries or, if objective scores render distinct database searches comparable, the search results from many different queries may be pooled to produce a single combined ROC curve and score (<xref ref-type="bibr" rid="b2">2</xref>).</p><p>Although ROC<italic><sub>n</sub></italic> scores capture one aspect of search method quality, they ignore an important issue. In practice, most database searches return results for which the true and false positives are not known. Even a perfect ordering, with all the true results preceding all the false ones, may be of limited use if a user has no effective method for drawing a line between the two classes. Most protein database search programs now provide, in addition to an ordered list, <italic>E</italic>- or <italic>P</italic>-values with which to assess whether any given result can be explained by chance. Many applications rely critically upon these values for further analyses. For example, PSI-BLAST (<xref ref-type="bibr" rid="b3">3</xref>) and related iterative protein profile search programs use an <italic>E</italic>-value threshold to automatically include alignments in further rounds of analysis; a single false positive below this threshold can corrupt all subsequent results (<xref ref-type="bibr" rid="b4">4</xref>). Although unreliable <italic>E</italic>-values may be countered by setting a very stringent threshold, this can squander efforts that have gone into improving retrieval accuracy. Accordingly, as important a consideration for a program's utility as the degree to which it separates true from chance similarities may be the accuracy with which it calculates <italic>E</italic>-values (<xref ref-type="bibr" rid="b5">5</xref>).</p><p>A central question in calculating alignment <italic>E</italic>-values is defining the random distribution to which they refer. The simplest approach is to calculate <italic>E</italic>-values with reference to a random protein model, based on standard amino acid frequencies; this is the baseline behavior of the BLAST programs (<xref ref-type="bibr" rid="b3">3</xref>,<xref ref-type="bibr" rid="b6">6</xref>). The most immediate problem arises from &#x02018;low-complexity&#x02019; segments&#x02014;protein regions with extremely restricted amino acid usage&#x02014;which depart drastically from the random model. It is usually not of interest to align such segments, and they may be filtered out of consideration using a program such as SEG (<xref ref-type="bibr" rid="b7">7</xref>). However, even after low-complexity segments have been removed, many proteins have distinctly biased amino acid compositions. Such biases are typical of some protein families, but particular organisms also have AT- or CG-biased genomes, leading by means of the genetic code to characteristically biased proteomes (<xref ref-type="bibr" rid="b8">8</xref>,<xref ref-type="bibr" rid="b9">9</xref>). Accordingly, many authors have proposed calculating the significance of an alignment of two proteins by considering their amino acid compositions within some model for generating random sequences (<xref ref-type="bibr" rid="b2">2</xref>,<xref ref-type="bibr" rid="b10">10</xref>,<xref ref-type="bibr" rid="b11">11</xref>). If one does not account for compositional bias, the reported <italic>E</italic>-values or <italic>P</italic>-values may be orders of magnitude too low. As we show below, an implementation of this basic idea within BLAST greatly improves the accuracy of its statistical evaluations.</p><p>One might expect that adopting a more accurate calculation of <italic>E</italic>-values would yield improved retrieval accuracy as well. However, retrieval accuracy actually decreases, even when the search results from many queries are pooled (<xref ref-type="bibr" rid="b2">2</xref>). A possible explanation is that similar amino acid compositional biases for two proteins constitutes, in itself, some evidence of protein relationship. The challenge, then, is to produce a mathematically justified way of taking compositional similarity into account when assessing sequence relationships.</p><p>The approach we take here is to consider two distinct measures of sequence similarity: the traditional measure of alignment similarity and a new measure of compositional bias similarity. We investigate empirically the distribution of compositional similarity among unrelated proteins. This allows us to define an associated compositional <italic>P</italic>-value distinct from an alignment <italic>P</italic>-value. We find that, on average, related proteins have a greater compositional similarity than unrelated proteins. Furthermore, we find that for unrelated sequence pairs, alignment and compositional <italic>P</italic>-values are effectively independent. Therefore, we can combine these <italic>P</italic>-values into a single, unified <italic>P</italic>-value (<xref ref-type="bibr" rid="b12">12</xref>&#x02013;<xref ref-type="bibr" rid="b14">14</xref>), which can serve as a new measure for assessing sequence similarity. We show that this measure recaptures the previously forfeited retrieval accuracy, while at the same time yielding accurate statistics. By also employing the previously described compositional score adjustment (<xref ref-type="bibr" rid="b15">15</xref>&#x02013;<xref ref-type="bibr" rid="b17">17</xref>), we generate a program that substantially outperforms the baseline BLAST program on an ASTRAL test set (<xref ref-type="bibr" rid="b18">18</xref>,<xref ref-type="bibr" rid="b19">19</xref>) both in retrieval accuracy and in the accuracy of its reported <italic>E</italic>-values.</p></sec><sec><title>THEORY</title><sec><title>Variants of BLAST</title><p>We will compare five variants of the gapped protein-query, protein-database BLAST program (<xref ref-type="bibr" rid="b3">3</xref>), which we distinguish in this paper with different prefixes: B-BLAST, S-BLAST, SU-BLAST, C-BLAST and CU-BLAST (<xref ref-type="table" rid="tbl1">Table 1</xref>). The baseline program B-BLAST is modified in a few minor ways from the default protein&#x02013;protein BLAST program available on the web site of the National Center for Biotechnology Information (NCBI) (<xref ref-type="bibr" rid="b20">20</xref>). As noted below, some of these changes are for testing purposes only, in order to minimize the number of confounding factors when comparing B-BLAST to the other BLAST variants, while others may be retained in future web versions of BLAST.</p><p>The program S-BLAST scales the scores of a standard matrix, for each alignment reported, based upon the compositions of the two sequences compared. This approach, which improves statistical evaluations, was introduced by Sch&#x000e4;ffer <italic>et al.</italic> (<xref ref-type="bibr" rid="b2">2</xref>). The program SU-BLAST, which is new to this paper, combines the alignment similarity of S-BLAST with compositional similarity, described below, to produce a unified measure of sequence similarity.</p><p>The program C-BLAST conditionally adjusts the scores of a standard matrix, for each alignment reported, based upon the compositions of the two sequences compared. The approach is described in Altschul <italic>et al.</italic> (<xref ref-type="bibr" rid="b15">15</xref>), and is based on methods from Yu <italic>et al.</italic> (<xref ref-type="bibr" rid="b17">17</xref>) and Yu and Altschul (<xref ref-type="bibr" rid="b16">16</xref>). The program CU-BLAST, which is new to this paper, combines the alignment similarity of C-BLAST with compositional similarity, described below, to produce a unified measure of sequence similarity.</p><p>All five variants use the program SEG (<xref ref-type="bibr" rid="b7">7</xref>) to filter database sequences for low-complexity regions. SEG replaces certain amino acids with the character &#x02018;X&#x02019;, which is also used to signify an unknown amino acid. Past default versions of BLAST have assigned a fixed negative score to the aligned pair (&#x003b1;, X), where &#x003b1; is a standard amino acid. Here, all five variants assign to (&#x003b1;, X) a weighted average of the scores for &#x003b1; aligned to the twenty standard amino acids. The new way to score aligned letter pairs involving X may be retained in future default versions of BLAST. Here, the calculated composition of any sequence that is filtered using SEG ignores those amino acids that are replaced with &#x02018;X&#x02019;.</p><p>All five variants use the optional Smith-Waterman algorithm (<xref ref-type="bibr" rid="b21">21</xref>) to generate all local alignments actually reported. Also, in this final alignment step, all five variants use five more bits of precision for their substitution scores than are used by the standard BLOSUM-62 matrix (<xref ref-type="bibr" rid="b22">22</xref>). In both respects, B-BLAST differs from past default versions of BLAST.</p><p>Except for its extra precision in the final step, B-BLAST uses the standard BLOSUM-62 matrix in conjunction with scores of &#x02212;11&#x02009;&#x02212;&#x02009;<italic>k</italic> for gaps of length <italic>k</italic>. For its <italic>E</italic>-value calculations, it employs gapped statistical parameters that are estimated (<xref ref-type="bibr" rid="b23">23</xref>) for a set of standard amino acid frequencies (<xref ref-type="bibr" rid="b24">24</xref>). S-BLAST uses &#x02018;composition-based statistics&#x02019; (<xref ref-type="bibr" rid="b2">2</xref>) to scale the BLOSUM-62 substitution scores for any pair of sequences, while leaving the gap scores fixed. The program SU-BLAST, introduced here, combines a measure of compositional bias similarity with S-BLAST's measure of alignment similarity to produce a unified measure of sequence similarity. C-BLAST and CU-BLAST replace the scaled BLOSUM-62 scores of S-BLAST and SU-BLAST with the conditionally compositionally adjusted scores described by Altschul <italic>et al.</italic> (<xref ref-type="bibr" rid="b15">15</xref>).</p><p>There is one additional change we made for testing purposes only. The implementation of composition-based statistics, available for many years on the web-site of the NCBI, places upper and lower bounds of 1.0 and 0.5 on the factor by which a substitution matrix can be scaled. The upper bound is imposed to improve slightly the program's retrieval accuracy and speed (<xref ref-type="bibr" rid="b2">2</xref>). The lower bound, rarely invoked, improves the utility of the program's output for certain applications. However, these artificial bounds confound the issues we wish to study here, and so we have removed the upper bound entirely, and reduced the lower bound to 0.05.</p><p>Finally, since the publication of the paper introducing &#x02018;conditional compositional adjustment&#x02019; to derive a new substitution matrix (<xref ref-type="bibr" rid="b15">15</xref>), we have found that in addition to the three criteria therein described, a fourth is appropriate for invoking compositional adjustment. Specifically, compositional adjustment should be used for any comparison involving a protein of length at least 50 amino acids and whose two most abundant residues constitute at least 40% of the protein. The implementations of C-BLAST and CU-BLAST studied here employ this additional criterion, but it has no measurable effect on the paper's results.</p></sec><sec><title>BLAST heuristics</title><p>All variants of BLAST we study involve scaling or adjusting the substitution matrix for each alignment reported. BLAST is a heuristic program, not guaranteed always to find the optimal alignments, and scaling or adjusting the substitution matrix separately for each database sequence would unduly increase execution time. Accordingly, we re-evaluate only those database sequences which pass an initial screen. Specifically, the standard gap scores, BLOSUM-62 matrix, and statistical parameters for standard amino acid frequencies (<xref ref-type="bibr" rid="b24">24</xref>) are used to calculate preliminary <italic>E</italic>-values. Any database sequence producing an alignment with a preliminary <italic>E</italic>-value less than or equal to a set threshold, here taken to be 100, is retained for further evaluation. The substitution and gap scores are rescaled or adjusted, and an optimal local alignment is generated using the rigorous Smith-Waterman algorithm.</p><p>SU-BLAST and CU-BLAST calculate compositional <italic>P</italic>-values to combine with alignment <italic>P</italic>-values in order to produce unified <italic>P</italic>- and <italic>E</italic>-values for reporting. Because alignments are produced only for database sequences that pass the initial screen, SU-BLAST and CU-BLAST calculate compositional <italic>P</italic>-values for only these sequences.</p></sec><sec><title>Statistics</title><p>For the comparison of random sequences, an analytic, asymptotic statistical theory has been developed for the distribution of scores of ungapped local alignments (<xref ref-type="bibr" rid="b25">25</xref>,<xref ref-type="bibr" rid="b26">26</xref>). In brief, for the comparison of two random sequences of lengths <italic>m</italic> and <italic>n</italic>, the number of distinct local alignments with score at least <italic>S</italic> is approximately Poisson distributed, with expected value
<disp-formula id="e1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mi>K</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi><mml:mtext>&#x02009;</mml:mtext><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>&#x003bb;</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>K</italic> and &#x003bb; are calculable parameters dependent upon the scoring system and amino acid distribution. The Poisson distribution implies that the <italic>maximum</italic> score follows an extreme value distribution (<xref ref-type="bibr" rid="b27">27</xref>), with the probability of achieving a score at least <italic>S</italic> given by
<disp-formula id="e2"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mtext>exp</mml:mtext><mml:mo>(</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi>K</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi><mml:mtext>&#x02009;</mml:mtext><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>&#x003bb;</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
This formula may be inverted, yielding
<disp-formula id="e3"><label>(3)</label><mml:math id="M3"><mml:mrow><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mtext>ln</mml:mtext><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mtext>&#x02009;</mml:mtext><mml:mo>&#x02212;</mml:mo><mml:mtext>&#x02009;</mml:mtext><mml:mi>P</mml:mi><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
For ungapped alignments, &#x003bb; is defined only for scoring systems with negative expected score. It is the unique positive solution to the equation
<disp-formula id="e4"><label>(4)</label><mml:math id="M4"><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:munder></mml:mstyle><mml:mtext>&#x02009;</mml:mtext><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mtext>&#x02009;</mml:mtext><mml:msubsup><mml:mi>p</mml:mi><mml:mi>j</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mtext>&#x02009;</mml:mtext><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mtext>&#x02009;</mml:mtext><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>s<sub>ij</sub></italic> is the score for aligning amino acids <italic>i</italic> and <italic>j</italic>, and <italic>p<sub>i</sub></italic> and <italic>p</italic>&#x02032;<sub>j</sub> are the background probabilities, respectively, for amino acid <italic>i</italic> in the first sequence and amino acid <italic>j</italic> in the second (<xref ref-type="bibr" rid="b25">25</xref>,<xref ref-type="bibr" rid="b26">26</xref>). Empirically, for typical scoring regimes, optimal gapped local alignments follow the same type of distribution as do ungapped local alignments (<xref ref-type="bibr" rid="b28">28</xref>), although the distribution's parameters &#x003bb; and <italic>K</italic> can not be calculated analytically but may be estimated by random simulation (<xref ref-type="bibr" rid="b23">23</xref>).</p><p>The <italic>E</italic>-value or <italic>P</italic>-value of an alignment score depends upon the lengths of the sequences compared. <italic>E</italic>- or <italic>P</italic>-values may be reported in the context of a pairwise comparison or in the context of a database search. For the database search context, the length <italic>n</italic> of a single sequence is replaced in formulas 1 and 2 by the aggregate length <italic>N</italic>, in residues, of all database sequences. By default, the BLAST programs report database <italic>E</italic>-values, but because we will discuss pairwise <italic>E</italic>- and <italic>P</italic>-values below, we will always use a hat symbol to indicate pairwise as opposed to database <italic>E</italic>- or <italic>P</italic>-values. The relationship between the pairwise and database <italic>E</italic>-values for an alignment involving a database sequence of length <italic>n</italic> (<xref ref-type="bibr" rid="b29">29</xref>) is given by the formula
<disp-formula id="e5"><label>(5)</label><mml:math id="M5"><mml:mrow><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>N</mml:mi><mml:mi>n</mml:mi></mml:mfrac><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></sec><sec><title>Unified <italic>P</italic>- and <italic>E</italic>-values</title><p>As described below, we will combine an alignment pairwise <italic>P</italic>-value <inline-formula><mml:math id="M6"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> with a compositional <italic>P</italic>-value <italic>P<sub>c</sub></italic> to calculate a unified pairwise <italic>P</italic>-value <inline-formula><mml:math id="M7"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>u</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> Because BLAST reports database <italic>E</italic>-values, it must perform the following calculations to convert an alignment database <italic>E</italic>-value <italic>E<sub>a</sub></italic> into a unified database <italic>E</italic>-value <italic>E<sub>u</sub></italic>:
<disp-formula><mml:math id="M8"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>a</mml:mi></mml:msub><mml:mo>&#x02254;</mml:mo></mml:mrow><mml:mrow><mml:mfrac><mml:mi>n</mml:mi><mml:mi>N</mml:mi></mml:mfrac></mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>&#x02003;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtext>Equation</mml:mtext><mml:mn>5</mml:mn><mml:mo>)</mml:mo><mml:mo>;</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="M9"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>a</mml:mi></mml:msub><mml:mo>&#x02254;</mml:mo></mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>&#x02003;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtext>Equation</mml:mtext><mml:mn>2</mml:mn><mml:mo>)</mml:mo><mml:mo>;</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="M10"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>u</mml:mi></mml:msub><mml:mo>&#x02254;</mml:mo></mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02003;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtext>see&#x000a0;below</mml:mtext><mml:mo>)</mml:mo><mml:mo>;</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="M11"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>u</mml:mi></mml:msub><mml:mo>&#x02254;</mml:mo></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mtext>ln</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>u</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtext>Equation</mml:mtext><mml:mn>3</mml:mn><mml:mo>)</mml:mo><mml:mo>;</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="M12"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>u</mml:mi></mml:msub><mml:mo>&#x02254;</mml:mo></mml:mrow><mml:mfrac><mml:mi>N</mml:mi><mml:mi>n</mml:mi></mml:mfrac><mml:msub><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>u</mml:mi></mml:msub><mml:mo>&#x02003;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtext>Equation</mml:mtext><mml:mn>5</mml:mn><mml:mo>)</mml:mo><mml:mo>;</mml:mo></mml:mrow></mml:math></disp-formula>
<italic>E<sub>u</sub></italic> is reported, and can be converted into a database <italic>P</italic>-value <italic>P<sub>u</sub></italic> using <xref ref-type="disp-formula" rid="e2">Equation 2</xref> if desired.</p></sec><sec><title>Program evaluation</title><p>We evaluate versions of BLAST both for the reliability of their statistics and for their retrieval accuracy. To study the reliability of the statistics produced, we compare 10 000 shuffled mouse sequences of length at least 150 with shuffled human RefSeq (<xref ref-type="bibr" rid="b20">20</xref>) sequences from Build 35 of the human genome. For each query, we record the lowest database <italic>P</italic>-value returned. We then plot the number of queries for which this <italic>P</italic>-value is &#x02264;<italic>x</italic>.</p><p>To study retrieval accuracy, we use the &#x02018;astral40&#x02019; data set (<xref ref-type="bibr" rid="b18">18</xref>,<xref ref-type="bibr" rid="b19">19</xref>), based upon the SCOP structural classification of proteins (<xref ref-type="bibr" rid="b30">30</xref>,<xref ref-type="bibr" rid="b31">31</xref>), for ROC analysis. Specifically, the 3586 astral40 sequences related to at least one other astral40 sequence are compared to the complete data set, and the results of all searches are pooled by <italic>E</italic>-value. For increasing <italic>E</italic>-value, the number of true positives is plotted against the number of false positives, and a ROC<sub>5000</sub> score is calculated.</p></sec></sec><sec><title>RESULTS</title><p>Here, we first study the statistical and retrieval accuracy of the previously described programs B-BLAST and S-BLAST. We then describe a measure of similarly biased amino acid compositions in two proteins and a method for combining this compositional similarity with alignment similarity to create a unified assessment of sequence similarity. We implement this unified measure in SU-BLAST, whose statistical and retrieval accuracies we study. Finally, we replace the compositional scaling employed by S-BLAST and SU-BLAST with conditional compositional matrix adjustment to create C-BLAST and CU-BLAST, and study the performance of these programs. The central idea behind such compositional matrix adjustment is to find target frequencies for aligned amino acid pairs that are consistent with the background frequencies of the sequences being compared, but as close as possible to the target frequencies implicit in a standard substitution matrix. For the comparison of sequences with different background frequencies, the resulting substitution matrix is asymmetric. It is fruitful to employ compositional adjustment only under certain conditions (<xref ref-type="bibr" rid="b15">15</xref>), with compositional scaling (<xref ref-type="bibr" rid="b2">2</xref>) used when these conditions fail.</p><sec><title>B-BLAST and S-BLAST</title><p>The proper statistical parameters &#x003bb; and <italic>K</italic> for the distributions of <xref ref-type="disp-formula" rid="e1">Equation 1</xref> and <xref ref-type="disp-formula" rid="e2">2</xref> depend upon the amino acid compositions of the sequences being compared. Thus the significance of alignments with the same nominal score can vary, dependent upon the context in which the alignments arise. For example, using BLOSUM-62 scores (<xref ref-type="bibr" rid="b22">22</xref>), a high-scoring alignment is much more likely to arise by chance from the comparison to two cysteine-rich proteins than from the comparison of two proteins with more typical amino acid compositions. Numerically, this is mediated in <xref ref-type="disp-formula" rid="e1">Equation 1</xref> primarily by the cysteine-rich compositions implying a smaller value of &#x003bb;, which discounts the nominal score.</p><p>The baseline B-BLAST program evaluates all alignments using gapped statistical parameters <inline-formula><mml:math id="M13"><mml:mrow><mml:msubsup><mml:mi>&#x003bb;</mml:mi><mml:mi>g</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M14"><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mi>g</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> estimated (<xref ref-type="bibr" rid="b23">23</xref>) for a standard amino acid composition (<xref ref-type="bibr" rid="b24">24</xref>). Thus, for alignments involving proteins whose compositions imply a gapped &#x003bb;<sub>g</sub> substantially smaller than <inline-formula><mml:math id="M15"><mml:mrow><mml:msubsup><mml:mi>&#x003bb;</mml:mi><mml:mi>g</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>, the <italic>E</italic>-values reported may be much smaller than justified.</p><p>BLAST estimates the number of alignments that are expected to achieve a given score by chance, i.e. from the comparison of unrelated proteins. Our test of BLAST statistics retains the compositions of real proteins, while scrambling the order of their amino acids. <xref ref-type="fig" rid="fig1">Figure 1</xref> shows that B-BLAST's statistics are far from accurate. For example, in 10 000 randomized B-BLAST database searches, 639 (6.4%) yield best matches with <italic>P</italic>-value &#x02264; 10<sup>&#x02212;4</sup>, when only one would be expected. Furthermore, some queries can yield best matches with extremely inaccurate statistical assessments: 143 queries (1.4%) returned best matches with <italic>P</italic>-value &#x02264; 10<sup>&#x02212;10</sup>. Note also that when the best random match has an extremely low <italic>P</italic>-value or <italic>E</italic>-value, many other matches frequently do as well. For example, a single query whose best match had a B-BLAST <italic>P</italic>-value of 10<sup>&#x02212;12</sup> yielded 101 matches with <italic>E</italic>-value &#x02264; 10<sup>&#x02212;4</sup>.</p><p>This problem with BLAST statistics is understood to be due primarily to similarly biased compositions among many protein sequences and is largely mitigated by the &#x02018;composition-based statistics&#x02019; (<xref ref-type="bibr" rid="b2">2</xref>) employed by S-BLAST. To estimate rapidly the statistical parameters for gapped alignments, S-BLAST multiplies the standard BLOSUM-62 matrix by a distinct constant for each pair of sequences, so that the scaled matrix has the same ungapped scale parameter &#x003bb; in the new compositional context that the unscaled matrix has in the standard context. The gap costs remain fixed. When the new scoring system is employed, the optimal local alignment may change. Therefore alignments must be recalculated, as described in the Theory section above, after the substitution matrix has been scaled.</p><p><xref ref-type="fig" rid="fig1">Figure 1</xref> shows that the statistics of S-BLAST are far more accurate that those of B-BLAST, and even slightly conservative. From 10 000 database searches, only six best matches are returned with <italic>P</italic>-value &#x02264; 10<sup>&#x02212;3</sup>, where ten are expected. In some applications it is crucial to exclude false positives reliably, for example when constructing a PSI-BLAST position-specific score matrix for further database searches (<xref ref-type="bibr" rid="b3">3</xref>). In these instances, S-BLAST is strongly preferred to B-BLAST (<xref ref-type="bibr" rid="b2">2</xref>). However, if one ignores the accuracy of reported statistics and pays attention only to the relative abilities of the two programs to separate true from chance similarities, then B-BLAST appears better; <xref ref-type="fig" rid="fig2">Figure 2</xref> shows that its ROC curve lies significantly above S-BLAST's. This seemingly paradoxical result can be understood by recognizing that similarly biased compositions can in themselves constitute evidence for sequence relatedness. This evidence is effectively discarded when one calculates the significance of an alignment given the compositions of the sequences being compared. The problem we now address is whether this evidence can be recaptured in a mathematically justified manner, thereby restoring the retrieval accuracy of B-BLAST while retaining the statistical accuracy of S-BLAST.</p></sec><sec><title>Compositional similarity</title><p>To study coordinated amino acid biases among related and unrelated proteins, we first require an appropriate measure. The difference between the substitution scores used by B-BLAST and S-BLAST, a difference that caused a sizable erosion in retrieval accuracy, was multiplication by a factor proportional to the ungapped scale parameter &#x003bb;. We therefore propose to use &#x003bb; itself, calculated for a fixed reference set of substitution scores, but using the observed amino acid frequencies of two proteins, as a measure of coordinated amino acid bias. An analysis of equation (4) whose solution is &#x003bb; (<xref ref-type="bibr" rid="b26">26</xref>) shows that &#x003bb; will be low for any pair of proteins with an unusually large number of amino acids having high mutual substitution scores as defined by the reference substitution matrix.</p><p>There is no model from which one may derive an accurate distribution of &#x003bb; for unrelated proteins. Accordingly, we proceed by calculating &#x003bb;, based on the BLOSUM-62 substitution scores (<xref ref-type="bibr" rid="b22">22</xref>), for all pairs of unrelated proteins from the astral40 data set (<xref ref-type="bibr" rid="b18">18</xref>,<xref ref-type="bibr" rid="b19">19</xref>). The resulting empirical probability density function for &#x003bb; is shown in <xref ref-type="fig" rid="fig3">Figure 3</xref>. We use this distribution to assign to any particular value of &#x003bb; an empirical compositional <italic>P</italic>-value, <italic>P<sub>c</sub></italic>(&#x003bb;), equal to the area under the density curve to the left of &#x003bb;. Because for small &#x003bb; the data supporting our empirical distribution become sparse, we set a lower bound on <italic>P<sub>c</sub></italic>(&#x003bb;) of 10<sup>&#x02212;6</sup>, which is returned whenever &#x003bb; less than equal to 0.068.</p><p><xref ref-type="fig" rid="fig3">Figure 3</xref> also shows the empirical probability density of &#x003bb; for pairs of related sequences from the astral40 data set. Our strategy is to glean from the separation between the distributions for related and unrelated sequences evidence of sequence relatedness based on compositional considerations alone.</p></sec><sec><title>Combining alignment and compositional significance</title><p>How may one combine <italic>P<sub>c</sub></italic> for a pair of sequences with a traditional alignment-score <italic>P</italic>-value, <italic>P<sub>a</sub></italic>, calculated using composition-corrected substitution scores, to derive a valid unified <italic>P</italic>-value, <italic>P<sub>u</sub></italic>, based upon both compositional and alignment evidence? One approach is to assume that <italic>P<sub>a</sub></italic> and <italic>P<sub>c</sub></italic> are independent random variables with a uniform distribution on the interval (0,1). Define a new random variable equal to the product of <italic>P<sub>a</sub></italic> and <italic>P<sub>c</sub></italic>, which has an easily calculated probability density over (0,1), from which a unified <italic>P</italic>-value may be derived (<xref ref-type="bibr" rid="b12">12</xref>&#x02013;<xref ref-type="bibr" rid="b14">14</xref>). The resulting <italic>P<sub>u</sub></italic> is given by
<disp-formula id="e6"><label>(6)</label><mml:math id="M16"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mtext>&#x02009;</mml:mtext><mml:mo>=</mml:mo><mml:mtext>&#x02009;</mml:mtext><mml:msub><mml:mi>P</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mtext>&#x02009;</mml:mtext><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mtext>ln</mml:mtext><mml:msub><mml:mi>P</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
For this formula to be valid, <italic>P<sub>a</sub></italic> and <italic>P<sub>c</sub></italic> should be accurate and independent. If we calculate <italic>P<sub>a</sub></italic> using composition-based statistics (<xref ref-type="bibr" rid="b2">2</xref>), as described above for S-BLAST, there should be little if any dependence between <italic>P<sub>c</sub></italic> and <italic>P<sub>a</sub></italic>. To test whether this is effectively the case, for each best match of a shuffled mouse sequence to a shuffled human RefSeq sequence, we calculated <italic>P<sub>a</sub></italic> and <italic>P<sub>c</sub></italic> and plotted their joint empirical probability density in <xref ref-type="fig" rid="fig4">Figure 4</xref>. There was close to no evident dependence between the values of <italic>P<sub>a</sub></italic> and <italic>P<sub>c</sub></italic>, although <italic>P<sub>a</sub></italic> was systematically high. For values of <italic>P<sub>a</sub></italic> &#x0003c; &#x0223c;0.3, the probability density shown in <xref ref-type="fig" rid="fig4">Figure 4</xref> is close to uniform, although appreciably &#x0003c; 1.0. This implies that for such <italic>P<sub>a</sub></italic>, <xref ref-type="disp-formula" rid="e6">Equation 6</xref> should yield values for <italic>P<sub>u</sub></italic> that are consistently conservative by a constant multiplicative factor. This is approximately what is observed in <xref ref-type="fig" rid="fig1">Figure 1</xref>.</p></sec><sec><title>SU-BLAST</title><p>We have implemented a program, here called SU-BLAST, that uses both compositional and alignment evidence to assess protein sequence similarity. Before we discuss this program's retrieval and statistical accuracy, two technical details bear comment.</p><p>First, because we wish to combine compositional similarity not just with the best hit from a database search, but in principle with the best hits for all sequences, it is appropriate to apply <xref ref-type="disp-formula" rid="e6">Equation 6</xref> with pairwise <italic>P</italic>-values <inline-formula><mml:math id="M17"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M18"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> in place of database <italic>P</italic>-values <italic>P<sub>a</sub></italic> and <italic>P<sub>u</sub></italic>. Therefore, to calculate a unified database <italic>E</italic>-value <italic>E<sub>u</sub></italic> from an alignment database <italic>E</italic>-value <italic>E<sub>a</sub></italic>, we have to perform the five-step calculation described above in the Theory section. Second, as described in the Theory section above, SU-BLAST returns a result only for those sequences whose preliminary alignment <italic>E</italic>-value is lower than a set threshold. This heuristic is unlikely to exclude many alignments with low unified <italic>E</italic>-values because alignment similarity generally carries much more information than compositional similarity.</p><p>We tested SU-BLAST for retrieval and statistical accuracy. As shown in <xref ref-type="fig" rid="fig1">Figure 1</xref>, SU-BLAST's reported statistics are noticeably more conservative than those of S-BLAST, but are still accurate within an order of magnitude. However, as shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>, by using &#x003bb; to measure and reward similar compositional bias, SU-BLAST recaptures the retrieval accuracy forfeited by S-BLAST. SU-BLAST and B-BLAST have very similar ROC curves and ROC<sub>5000</sub> scores. For the data set used, B-BLAST is slightly better at false positive rates &#x0003c; 0.3/query, and SU-BLAST is slightly better at false positive rates &#x0003e; 0.3/query. The major difference between SU-BLAST's and B-BLAST's performance is found in the far greater accuracy of SU-BLAST's statistics.</p></sec><sec><title>C-BLAST AND CU-BLAST</title><p>It has been argued that standard substitution matrices such as BLOSUM-62 are not ideal for comparing sequences with non-standard compositions, and an efficient method has been proposed for adjusting standard matrices for use in arbitrary compositional contexts (<xref ref-type="bibr" rid="b15">15</xref>&#x02013;<xref ref-type="bibr" rid="b17">17</xref>).</p><p>For protein database searching, Altschul <italic>et al.</italic> (<xref ref-type="bibr" rid="b15">15</xref>) have shown that conditional compositional substitution matrix adjustment yields better retrieval accuracy than does the substitution matrix scaling (<xref ref-type="bibr" rid="b2">2</xref>) embodied in S-BLAST. Like matrix scaling, compositional adjustment produces alignment statistics conditioned on the compositions of the sequences compared. Therefore, it is appropriate to replace the matrix scaling of S-BLAST and SU-BLAST with conditional compositional adjustment (<xref ref-type="bibr" rid="b15">15</xref>) to produce the programs C-BLAST and CU-BLAST. An analysis of the independence of <italic>P<sub>a</sub></italic> and <italic>P<sub>c</sub></italic> similar to that shown in <xref ref-type="fig" rid="fig4">Figure 4</xref>, but with S-BLAST replaced by C-BLAST, produces results nearly equivalent to those discussed above, and is omitted here.</p><p>The reliability of C-BLAST's and CU-BLAST's statistics is evaluated in <xref ref-type="fig" rid="fig1">Figure 1</xref>. As can be seen, the replacement of scaled by compositionally adjusted substitution matrices yields a somewhat improved agreement of statistical theory with experiment. Also, as shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>, CU-BLAST outperforms both B-BLAST and SU-BLAST in retrieval accuracy. In summary, evaluated from the baseline provided by B-BLAST, the integration of compositionally adjusted substitution matrices with a measure of similar compositional bias yields a program that is substantially improved from the standpoints of both statistical and retrieval accuracy.</p></sec></sec><sec><title>DISCUSSION AND CONCLUSION</title><p>It has been recognized for some time that a failure to account for biased amino acid compositions can lead to exaggerated claims of protein alignment statistical significance (<xref ref-type="bibr" rid="b2">2</xref>,<xref ref-type="bibr" rid="b10">10</xref>,<xref ref-type="bibr" rid="b11">11</xref>). It has not been widely recognized, however, that basing alignment statistics upon sequence composition can erode retrieval accuracy. We have argued that such erosion may stem from the fact that similarly biased compositions, in themselves, constitute evidence of protein relatedness. To improve alignment statistics, earlier methods have teased apart alignment and compositional similarity, but have then discarded the latter. We have proposed rejoining these two threads of evidence in a mathematically valid manner. Some studies may involve comparing related proteins that have amino acid compositions known or suspected to be discordant. In such cases, adding to alignment similarity the compositional similarity discussed here may well be counterproductive.</p><p>We have derived an empirical distribution of ungapped &#x003bb; values for unrelated sequence pairs from the astral40 data set (<xref ref-type="bibr" rid="b18">18</xref>,<xref ref-type="bibr" rid="b19">19</xref>). This set is biased towards globular proteins, and therefore our &#x003bb; distribution may not be valid for more comprehensive protein sets. Unfortunately, accurate classifications of proteins into related and unrelated classes are not currently available for such larger sets, and the &#x003bb; distribution may bear refinement as protein relationships become more fully understood. However, proteins with highly biased or repetitive sequences generally are heavily filtered by the SEG program, and are probably not best studied using traditional alignment methods.</p><p>Different versions of the command line executable program &#x02018;blastpgp&#x02019; implementing the five BLAST versions described above and compiled for Linux are available at: <ext-link ext-link-type="ftp" xlink:href="ftp://ftp.ncbi.nlm.nih.gov/pub/agarwala/blast_unified_statistics"/>. Also available in this directory are a table of empirical values for <italic>P<sub>c</sub></italic>(&#x003bb;), the shuffled human and mouse sequences used in the statistical tests above, as well as the unshuffled sequences from which they are derived.</p><p>In this paper we have been concerned primarily with comparing the newly proposed measure of sequence similarity to earlier ones, and have sought to minimize confounding factors introduced by various BLAST heuristics. Accordingly, we have used the Smith-Waterman option in the final alignment phase (<xref ref-type="bibr" rid="b2">2</xref>), and we have used a high preliminary <italic>E</italic>-value threshold of 100 for re-evaluating alignments. However, the modest improvements in search sensitivity yielded by these options come at a significant cost in execution time, and different options may be chosen as defaults for NCBI's BLAST web servers. We have no reason to believe that our results would be qualitatively different using either faster BLAST parameter settings, or using the Smith-Waterman algorithm on every database sequence instead of on only those selected by the BLAST heuristics.</p><p>The use of compositional similarity, as well as its integration with compositional matrix adjustment, will be available as an option for the protein-query, protein-database BLAST search program on the NCBI web site. The current command line <italic>blastpgp</italic> offers unified <italic>P</italic>-values as part of the composition option (-<italic>t</italic>). Also, the use of compositional similarity may be specified for PSI-BLAST's initial BLAST round of database search, but thereafter PSI-BLAST uses only alignment similarity to assess results.</p><p>Compositional sequence relatedness has been used in other ways for protein sequence analysis before. For example, the PHD program for predicting protein secondary structure (<xref ref-type="bibr" rid="b32">32</xref>) employs global amino acid composition as one input to a neural network. Also, a somewhat ad hoc approach has been described for adjusting the reported <italic>E</italic>-values of alignments involving low complexity regions by post-processing BLAST outputs (<xref ref-type="bibr" rid="b33">33</xref>). Some database search programs, such as FASTA (<xref ref-type="bibr" rid="b34">34</xref>), correct for the composition of query sequences by estimating statistical parameters from database searches. This procedure, however, takes no account of the compositions of individual database sequences, and so can at most partially correct for the manner in which compositional biases skew pairwise alignment scores.</p><p>It may be possible to improve in several ways on this paper's approach. For example, the statistical corrections for compositional bias employed by S-BLAST and C-BLAST, while quite accurate for random sequences, are compromised to varying degrees by periodicity and non-uniformity within real sequences. SEG (<xref ref-type="bibr" rid="b7">7</xref>), applied to database sequences in this paper, removes many low-complexity segments from consideration, but certain periodic patterns remain. These may be dealt with by additional special-purpose filters, e.g. for coiled coils (<xref ref-type="bibr" rid="b35">35</xref>&#x02013;<xref ref-type="bibr" rid="b38">38</xref>), or by calculating alignment statistics based on a reversed-sequence model of randomness (<xref ref-type="bibr" rid="b10">10</xref>,<xref ref-type="bibr" rid="b39">39</xref>).</p><p>SCOP-based test sets such as astral40 are widely used for the evaluation and comparison of protein sequence database search methods, but they have potential disadvantages. SCOP is a classification of protein domains, but most comparisons performed in database searches involve complete proteins. As a result, SCOP-based evaluations may tend unduly to favor alignment scoring systems that have more of a global than a local flavor, such as the compositional bias similarity studied here. A test set we have previously employed (<xref ref-type="bibr" rid="b2">2</xref>), and which compares queries to full-length yeast sequences, is too small to yield statistically significant results in this study. Certainly the utility of the methods we have discussed is a function of the degree to which the compositional properties of complete proteins reflect those of the proteins' domains. Progress on the automatic parsing of protein sequences into domains should therefore be able to improve both statistical and retrieval accuracy.</p><p>Here we have studied one measure, the ungapped &#x003bb; implied by a fixed substitution matrix, of two sequences' compositional similarity. Many other measures are possible, and we did investigate one, a compositional distance metric recently described by Endres and Schindelin (<xref ref-type="bibr" rid="b40">40</xref>). The distance distributions for related and unrelated sequence pairs showed a marked separation, similar to that of <xref ref-type="fig" rid="fig3">Figure 3</xref>. However, the improvement in retrieval accuracy yielded by this measure was distinctly inferior to that yielded by &#x003bb; (data not shown). Nevertheless, it remains possible that theoretical considerations or further experimentation will yield a compositional similarity measure more effective than &#x003bb; for our purposes.</p><p>An alternative approach to measuring global compositional similarity is by log&#x02013;odds scores, analogous to those for alignment similarity, which make use of information derived from related as well as unrelated sequence pairs (John Spouge, personal communication). One may imagine other methods for taking advantage of the different behaviors of these two sets, and it is likely that a more sensitive measure than those we have so far studied will be found.</p><p>The idea of combining alignment similarity with independent measures of sequence relatedness, such as compositional similarity, may be applied fruitfully to database search programs other than BLAST (<xref ref-type="bibr" rid="b34">34</xref>). It may also be possible to graft compositional or other similarity measures onto the alignment similarity measures used by protein profile programs such as HMMER (<xref ref-type="bibr" rid="b41">41</xref>), PSI-BLAST (<xref ref-type="bibr" rid="b3">3</xref>), SAM (<xref ref-type="bibr" rid="b10">10</xref>), IMPALA (<xref ref-type="bibr" rid="b42">42</xref>) or SALTO (<xref ref-type="bibr" rid="b43">43</xref>). To what extent this can improve the statistics or retrieval accuracy of these programs awaits further investigation.</p></sec></body><back><ack><p>Thanks to Aleksandr Morgulis for comments on the manuscript and for technical assistance. This research was supported by the Intramural Research Program of the National Library of Medicine of the NIH/DHHS. Funding to pay the Open Access publication charges for this article was provided by the Intramural Research Program of the National Institutes of Health, NLM.</p><p><italic>Conflict of interest statement</italic>. None declared.</p></ack><ref-list><title>REFERENCES</title><ref id="b1"><label>1</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gribskov</surname><given-names>M.</given-names></name><name><surname>Robinson</surname><given-names>N.L.</given-names></name></person-group><article-title>Use of receiver operating characteristic (ROC) analysis to evaluate sequence matching</article-title><source>Comput. Chem.</source><year>1996</year><volume>20</volume><fpage>25</fpage><lpage>33</lpage><pub-id pub-id-type="pmid">16718863</pub-id></citation></ref><ref id="b2"><label>2</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Sch&#x000e4;ffer</surname><given-names>A.A.</given-names></name><name><surname>Aravind</surname><given-names>L.</given-names></name><name><surname>Madden</surname><given-names>T.L.</given-names></name><name><surname>Shavirin</surname><given-names>S.</given-names></name><name><surname>Spouge</surname><given-names>J.L.</given-names></name><name><surname>Wolf</surname><given-names>Y.I.</given-names></name><name><surname>Koonin</surname><given-names>E.V.</given-names></name><name><surname>Altschul</surname><given-names>S.F.</given-names></name></person-group><article-title>Improving the accuracy of PSI-BLAST protein database searches with composition-based statistics and other refinements</article-title><source>Nucleic Acids Res.</source><year>2001</year><volume>29</volume><fpage>2994</fpage><lpage>3005</lpage><pub-id pub-id-type="pmid">11452024</pub-id></citation></ref><ref id="b3"><label>3</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Altschul</surname><given-names>S.F.</given-names></name><name><surname>Madden</surname><given-names>T.L.</given-names></name><name><surname>Sch&#x000e4;ffer</surname><given-names>A.A.</given-names></name><name><surname>Zhang</surname><given-names>J.</given-names></name><name><surname>Zhang</surname><given-names>Z.</given-names></name><name><surname>Miller</surname><given-names>W.</given-names></name><name><surname>Lipman</surname><given-names>D.J.</given-names></name></person-group><article-title>Gapped BLAST and PSIBLAST: a new generation of protein database search programs</article-title><source>Nucleic Acids Res.</source><year>1997</year><volume>25</volume><fpage>3389</fpage><lpage>3402</lpage><pub-id pub-id-type="pmid">9254694</pub-id></citation></ref><ref id="b4"><label>4</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Altschul</surname><given-names>S.F.</given-names></name><name><surname>Koonin</surname><given-names>E.V.</given-names></name></person-group><article-title>Iterated profile searches with PSI-BLAST&#x02014;a tool for discovery in protein databases</article-title><source>Trends Biochem. Sci.</source><year>1998</year><volume>23</volume><fpage>444</fpage><lpage>447</lpage><pub-id pub-id-type="pmid">9852764</pub-id></citation></ref><ref id="b5"><label>5</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pearson</surname><given-names>W.R.</given-names></name><name><surname>Sierk</surname><given-names>M.L.</given-names></name></person-group><article-title>The limits of protein sequence comparison?</article-title><source>Curr. Opin. Struct. Biol.</source><year>2005</year><volume>15</volume><fpage>254</fpage><lpage>260</lpage><pub-id pub-id-type="pmid">15919194</pub-id></citation></ref><ref id="b6"><label>6</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Altschul</surname><given-names>S.F.</given-names></name><name><surname>Gish</surname><given-names>W.</given-names></name><name><surname>Miller</surname><given-names>W.</given-names></name><name><surname>Myers</surname><given-names>E.W.</given-names></name><name><surname>Lipman</surname><given-names>D.J.</given-names></name></person-group><article-title>Basic local alignment search tool</article-title><source>J. Mol. Biol.</source><year>1990</year><volume>215</volume><fpage>403</fpage><lpage>410</lpage><pub-id pub-id-type="pmid">2231712</pub-id></citation></ref><ref id="b7"><label>7</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wootton</surname><given-names>J.C.</given-names></name><name><surname>Federhen</surname><given-names>S.</given-names></name></person-group><article-title>Statistics of local complexity in amino acid sequences and sequence databases</article-title><source>Comput. Chem.</source><year>1993</year><volume>17</volume><fpage>149</fpage><lpage>163</lpage></citation></ref><ref id="b8"><label>8</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Sueoka</surname><given-names>N.</given-names></name></person-group><article-title>Directional mutation pressure and neutral molecular evolution</article-title><source>Proc. Natl Acad. Sci. USA</source><year>1988</year><volume>85</volume><fpage>2653</fpage><lpage>2657</lpage><pub-id pub-id-type="pmid">3357886</pub-id></citation></ref><ref id="b9"><label>9</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wan</surname><given-names>H.</given-names></name><name><surname>Wootton</surname><given-names>J.C.</given-names></name></person-group><article-title>A global compositional complexity measure for biological sequences: AT-rich and CG-rich genomes encode less complex proteins</article-title><source>Comput. Chem.</source><year>2000</year><volume>24</volume><fpage>71</fpage><lpage>94</lpage><pub-id pub-id-type="pmid">10642881</pub-id></citation></ref><ref id="b10"><label>10</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Karplus</surname><given-names>K.</given-names></name><name><surname>Barrett</surname><given-names>C.</given-names></name><name><surname>Hughey</surname><given-names>R.</given-names></name></person-group><article-title>Hidden Markov models for detecting remote protein homologies</article-title><source>Bioinformatics</source><year>1998</year><volume>14</volume><fpage>846</fpage><lpage>856</lpage><pub-id pub-id-type="pmid">9927713</pub-id></citation></ref><ref id="b11"><label>11</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Mott</surname><given-names>R.</given-names></name></person-group><article-title>Accurate formula for <italic>P</italic>-values of gapped local sequence and profile alignments</article-title><source>J. Mol. Biol.</source><year>2000</year><volume>300</volume><fpage>649</fpage><lpage>659</lpage><pub-id pub-id-type="pmid">10884359</pub-id></citation></ref><ref id="b12"><label>12</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bailey</surname><given-names>T.L.</given-names></name><name><surname>Gribskov</surname><given-names>M.</given-names></name></person-group><article-title>Combining evidence using p-values: application to sequence homology searches</article-title><source>Bioinformatics</source><year>1998</year><volume>14</volume><fpage>48</fpage><lpage>54</lpage><pub-id pub-id-type="pmid">9520501</pub-id></citation></ref><ref id="b13"><label>13</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Elston</surname><given-names>R.C.</given-names></name></person-group><article-title>On Fisher's method of combining <italic>p</italic>-values</article-title><source>Biom. J.</source><year>1991</year><volume>33</volume><fpage>339</fpage><lpage>345</lpage></citation></ref><ref id="b14"><label>14</label><citation citation-type="book"><person-group person-group-type="author"><name><surname>Fisher</surname><given-names>R.A.</given-names></name></person-group><source>Statistical Methods for Research Workers</source><year>1958</year><edition>13th edn</edition><publisher-loc>New York, NY</publisher-loc><publisher-name>Hafner</publisher-name><fpage>99</fpage><lpage>101</lpage></citation></ref><ref id="b15"><label>15</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Altschul</surname><given-names>S.F.</given-names></name><name><surname>Wootton</surname><given-names>J.C.</given-names></name><name><surname>Gertz</surname><given-names>E.M.</given-names></name><name><surname>Agarwala</surname><given-names>R.</given-names></name><name><surname>Morgulis</surname><given-names>A.</given-names></name><name><surname>Sch&#x000e4;ffer</surname><given-names>A.A.</given-names></name><name><surname>Yu</surname><given-names>Y.-K.</given-names></name></person-group><article-title>Protein database searches using compositionally adjusted substitution matrices</article-title><source>FEBS J.</source><year>2005</year><volume>272</volume><fpage>5101</fpage><lpage>5109</lpage><pub-id pub-id-type="pmid">16218944</pub-id></citation></ref><ref id="b16"><label>16</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>Y.-K.</given-names></name><name><surname>Altschul</surname><given-names>S.F.</given-names></name></person-group><article-title>The construction of amino acid substitution matrices for the comparison of proteins with nonstandard compositions</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>902</fpage><lpage>911</lpage><pub-id pub-id-type="pmid">15509610</pub-id></citation></ref><ref id="b17"><label>17</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>Y.-K.</given-names></name><name><surname>Wootton</surname><given-names>J.C.</given-names></name><name><surname>Altschul</surname><given-names>S.F.</given-names></name></person-group><article-title>The compositional adjustment of amino acid substitution matrices</article-title><source>Proc. Natl Acad. Sci. USA</source><year>2003</year><volume>100</volume><fpage>15688</fpage><lpage>15693</lpage><pub-id pub-id-type="pmid">14663142</pub-id></citation></ref><ref id="b18"><label>18</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Chandonia</surname><given-names>J.-M.</given-names></name><name><surname>Walker</surname><given-names>N.S.</given-names></name><name><surname>Lo Conte</surname><given-names>L.</given-names></name><name><surname>Koehl</surname><given-names>P.</given-names></name><name><surname>Levitt</surname><given-names>M.</given-names></name><name><surname>Brenner</surname><given-names>S.E.</given-names></name></person-group><article-title>ASTRAL compendium enhancements</article-title><source>Nucleic Acids Res.</source><year>2002</year><volume>30</volume><fpage>260</fpage><lpage>263</lpage><pub-id pub-id-type="pmid">11752310</pub-id></citation></ref><ref id="b19"><label>19</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Green</surname><given-names>R.E.</given-names></name><name><surname>Brenner</surname><given-names>S.E.</given-names></name></person-group><article-title>Bootstrapping and normalization for enhanced evaluations of pairwise sequence comparison</article-title><source>Proc. IEEE</source><year>2002</year><volume>90</volume><fpage>1834</fpage><lpage>1847</lpage></citation></ref><ref id="b20"><label>20</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wheeler</surname><given-names>D.L.</given-names></name><name><surname>Barrett</surname><given-names>T.</given-names></name><name><surname>Benson</surname><given-names>D.A.</given-names></name><name><surname>Bryant</surname><given-names>S.H.</given-names></name><name><surname>Canese</surname><given-names>K.</given-names></name><name><surname>Chetvernin</surname><given-names>V.</given-names></name><name><surname>Church</surname><given-names>D.M.</given-names></name><name><surname>DiCuccio</surname><given-names>M.</given-names></name><name><surname>Edgar</surname><given-names>R.</given-names></name><name><surname>Federhen</surname><given-names>S.</given-names></name><etal/></person-group><article-title>Database resources of the National Center for Biotechnology Information</article-title><source>Nucleic Acids Res.</source><year>2006</year><volume>34</volume><fpage>D173</fpage><lpage>D180</lpage><pub-id pub-id-type="pmid">16381840</pub-id></citation></ref><ref id="b21"><label>21</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>T.F.</given-names></name><name><surname>Waterman</surname><given-names>M.S.</given-names></name></person-group><article-title>Identification of common molecular subsequences</article-title><source>J. Mol. Biol.</source><year>1981</year><volume>147</volume><fpage>195</fpage><lpage>197</lpage><pub-id pub-id-type="pmid">7265238</pub-id></citation></ref><ref id="b22"><label>22</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Henikoff</surname><given-names>S.</given-names></name><name><surname>Henikoff</surname><given-names>J.G.</given-names></name></person-group><article-title>Amino acid substitution matrices from protein blocks</article-title><source>Proc. Natl Acad. Sci. USA</source><year>1992</year><volume>89</volume><fpage>10915</fpage><lpage>10919</lpage><pub-id pub-id-type="pmid">1438297</pub-id></citation></ref><ref id="b23"><label>23</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Altschul</surname><given-names>S.F.</given-names></name><name><surname>Bundschuh</surname><given-names>R.</given-names></name><name><surname>Olsen</surname><given-names>R.</given-names></name><name><surname>Hwa</surname><given-names>T.</given-names></name></person-group><article-title>The estimation of statistical parameters for local alignment score distributions</article-title><source>Nucleic Acids Res.</source><year>2001</year><volume>29</volume><fpage>351</fpage><lpage>361</lpage><pub-id pub-id-type="pmid">11139604</pub-id></citation></ref><ref id="b24"><label>24</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>A.B.</given-names></name><name><surname>Robinson</surname><given-names>L.R.</given-names></name></person-group><article-title>Distribution of glutamine and asparagine residues and their near neighbors in peptides and proteins</article-title><source>Proc. Natl Acad. Sci. USA</source><year>1991</year><volume>88</volume><fpage>8880</fpage><lpage>8884</lpage><pub-id pub-id-type="pmid">1924347</pub-id></citation></ref><ref id="b25"><label>25</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dembo</surname><given-names>A.</given-names></name><name><surname>Karlin</surname><given-names>S.</given-names></name><name><surname>Zeitouni</surname><given-names>O.</given-names></name></person-group><article-title>Limit distribution of maximal non-aligned two-sequence segmental score</article-title><source>Ann. Prob.</source><year>1994</year><volume>22</volume><fpage>2022</fpage><lpage>2039</lpage></citation></ref><ref id="b26"><label>26</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Karlin</surname><given-names>S.</given-names></name><name><surname>Altschul</surname><given-names>S.F.</given-names></name></person-group><article-title>Methods for assessing the statistical significance of molecular sequence features by using general scoring schemes</article-title><source>Proc. Natl Acad. Sci. USA</source><year>1990</year><volume>87</volume><fpage>2264</fpage><lpage>2268</lpage><pub-id pub-id-type="pmid">2315319</pub-id></citation></ref><ref id="b27"><label>27</label><citation citation-type="book"><person-group person-group-type="author"><name><surname>Gumbel</surname><given-names>E.J.</given-names></name></person-group><source>Statistics of Extremes</source><year>1958</year><publisher-loc>New York, NY</publisher-loc><publisher-name>Columbia University Press</publisher-name></citation></ref><ref id="b28"><label>28</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>T.F.</given-names></name><name><surname>Waterman</surname><given-names>M.S.</given-names></name><name><surname>Burks</surname><given-names>C.</given-names></name></person-group><article-title>The statistical distribution of nucleic acid similarities</article-title><source>Nucleic Acids Res.</source><year>1985</year><volume>13</volume><fpage>645</fpage><lpage>656</lpage><pub-id pub-id-type="pmid">3871073</pub-id></citation></ref><ref id="b29"><label>29</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Altschul</surname><given-names>S.F.</given-names></name><name><surname>Boguski</surname><given-names>M.S.</given-names></name><name><surname>Gish</surname><given-names>W.</given-names></name><name><surname>Wootton</surname><given-names>J.C.</given-names></name></person-group><article-title>Issues in searching molecular sequence databases</article-title><source>Nature Genet.</source><year>1994</year><volume>6</volume><fpage>119</fpage><lpage>129</lpage><pub-id pub-id-type="pmid">8162065</pub-id></citation></ref><ref id="b30"><label>30</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Brenner</surname><given-names>S.E.</given-names></name><name><surname>Chothia</surname><given-names>C.</given-names></name><name><surname>Hubbard</surname><given-names>T.J.</given-names></name></person-group><article-title>Assessing sequence comparison methods with reliable structurally identified distant evolutionary relationships</article-title><source>Proc. Natl Acad. Sci. USA</source><year>1998</year><volume>95</volume><fpage>6073</fpage><lpage>6078</lpage><pub-id pub-id-type="pmid">9600919</pub-id></citation></ref><ref id="b31"><label>31</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Murzin</surname><given-names>A.G</given-names></name><name><surname>Brenner</surname><given-names>S.E.</given-names></name><name><surname>Hubbard</surname><given-names>T.</given-names></name><name><surname>Chothia</surname><given-names>C.</given-names></name></person-group><article-title>SCOP: a structural classification of proteins database for the investigation of sequences and structures</article-title><source>J. Mol. Biol.</source><year>1995</year><volume>247</volume><fpage>536</fpage><lpage>540</lpage><pub-id pub-id-type="pmid">7723011</pub-id></citation></ref><ref id="b32"><label>32</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rost</surname><given-names>B.</given-names></name></person-group><article-title>PHD: predicting one-dimensional protein structure by profile-based neural networks</article-title><source>Methods Enyzmol.</source><year>1996</year><volume>266</volume><fpage>525</fpage><lpage>539</lpage></citation></ref><ref id="b33"><label>33</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Sharon</surname><given-names>I.</given-names></name><name><surname>Birkland</surname><given-names>A.</given-names></name><name><surname>Chang</surname><given-names>K.</given-names></name><name><surname>El-Yaniv</surname><given-names>R.</given-names></name><name><surname>Yona</surname><given-names>G.</given-names></name></person-group><article-title>Correcting BLAST e-values for low-complexity segments</article-title><source>J. Comp. Biol.</source><year>2005</year><volume>12</volume><fpage>980</fpage><lpage>1003</lpage></citation></ref><ref id="b34"><label>34</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pearson</surname><given-names>W.R.</given-names></name><name><surname>Lipman</surname><given-names>D.J.</given-names></name></person-group><article-title>Improved tools for biological sequence comparison</article-title><source>Proc. Natl Acad. Sci. USA</source><year>1988</year><volume>85</volume><fpage>2444</fpage><lpage>2448</lpage><pub-id pub-id-type="pmid">3162770</pub-id></citation></ref><ref id="b35"><label>35</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Berger</surname><given-names>B.</given-names></name><name><surname>Wilson</surname><given-names>D.B.</given-names></name><name><surname>Wolf</surname><given-names>E.</given-names></name><name><surname>Tonchev</surname><given-names>T.</given-names></name><name><surname>Milla</surname><given-names>M.</given-names></name><name><surname>Kim</surname><given-names>P.S.</given-names></name></person-group><article-title>Predicting coiled coils by use of pairwise residue correlations</article-title><source>Proc. Natl Acad. Sci. USA</source><year>1995</year><volume>92</volume><fpage>8259</fpage><lpage>8263</lpage><pub-id pub-id-type="pmid">7667278</pub-id></citation></ref><ref id="b36"><label>36</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lupas</surname><given-names>A.</given-names></name></person-group><article-title>Prediction and analysis of coiled-coil structures</article-title><source>Methods Enyzmol.</source><year>1996</year><volume>266</volume><fpage>513</fpage><lpage>525</lpage></citation></ref><ref id="b37"><label>37</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>McDonnell</surname><given-names>A.V.</given-names></name><name><surname>Jiang</surname><given-names>T.</given-names></name><name><surname>Keating</surname><given-names>A.E.</given-names></name><name><surname>Berger</surname><given-names>B.</given-names></name></person-group><article-title>Paircoil2: improved prediction of coiled coils from sequence</article-title><source>Bioinformatics</source><year>2006</year><volume>22</volume><fpage>356</fpage><lpage>358</lpage><pub-id pub-id-type="pmid">16317077</pub-id></citation></ref><ref id="b38"><label>38</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wolf</surname><given-names>E.</given-names></name><name><surname>Kim</surname><given-names>P.S.</given-names></name><name><surname>Berger</surname><given-names>B.</given-names></name></person-group><article-title>MultiCoil: a program for predicting two- and three-stranded coiled coils</article-title><source>Protein Sci.</source><year>1997</year><volume>6</volume><fpage>1179</fpage><lpage>1189</lpage><pub-id pub-id-type="pmid">9194178</pub-id></citation></ref><ref id="b39"><label>39</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Karplus</surname><given-names>K.</given-names></name><name><surname>Karchin</surname><given-names>R.</given-names></name><name><surname>Shackelford</surname><given-names>G.</given-names></name><name><surname>Hughey</surname><given-names>R.</given-names></name></person-group><article-title>Calibrating <italic>E</italic>-values for hidden Markov models using reversesequence null models</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>4107</fpage><lpage>4115</lpage><pub-id pub-id-type="pmid">16123115</pub-id></citation></ref><ref id="b40"><label>40</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Endres</surname><given-names>D.M.</given-names></name><name><surname>Schindelin</surname><given-names>J.E.</given-names></name></person-group><article-title>A new metric for probability distributions</article-title><source>IEEE Trans. Info. Theory</source><year>2003</year><volume>49</volume><fpage>1858</fpage><lpage>1860</lpage></citation></ref><ref id="b41"><label>41</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Eddy</surname><given-names>S.R.</given-names></name></person-group><article-title>Hidden Markov models</article-title><source>Curr. Opin. Struct. Biol.</source><year>1996</year><volume>6</volume><fpage>361</fpage><lpage>365</lpage><pub-id pub-id-type="pmid">8804822</pub-id></citation></ref><ref id="b42"><label>42</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Sch&#x000e4;ffer</surname><given-names>A.A.</given-names></name><name><surname>Wolf</surname><given-names>Y.I.</given-names></name><name><surname>Koonin</surname><given-names>E.V.</given-names></name><name><surname>Aravind</surname><given-names>L.</given-names></name><name><surname>Altschul</surname><given-names>S.F.</given-names></name></person-group><article-title>IMPALA: matching a protein sequence against a collection of PSI-BLAST-constructed position-specific score matrices</article-title><source>Bioinformatics</source><year>1999</year><volume>15</volume><fpage>1000</fpage><lpage>1011</lpage><pub-id pub-id-type="pmid">10745990</pub-id></citation></ref><ref id="b43"><label>43</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kann</surname><given-names>M.G.</given-names></name><name><surname>Thiessen</surname><given-names>P.A.</given-names></name><name><surname>Panchenko</surname><given-names>A.R.</given-names></name><name><surname>Sch&#x000e4;ffer</surname><given-names>A.A.</given-names></name><name><surname>Altschul</surname><given-names>S.F.</given-names></name><name><surname>Bryant</surname><given-names>S.H.</given-names></name></person-group><article-title>A structure-based method for protein sequence alignment</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>1451</fpage><lpage>1456</lpage><pub-id pub-id-type="pmid">15613392</pub-id></citation></ref></ref-list><sec sec-type="display-objects"><title>Figures and Tables</title><fig id="fig1" position="float"><label>Figure 1</label><caption><p>The accuracy of BLAST statistics. 10&#x02009;000 shuffled mouse sequences were compared to shuffled human RefSeq (<xref ref-type="bibr" rid="b20">20</xref>) sequences from Build 35 of the human genome. The number of queries whose best match had a reported <italic>P</italic>-value &#x02264; <italic>x</italic> is plotted against <italic>x</italic>, using a log&#x02013;log scale. Curves are shown for B-BLAST, S-BLAST, SU-BLAST, C-BLAST and CU-BLAST. The diagonal line indicates the theoretical prediction for all curves. The vertical line at <italic>x</italic> = 10<sup>&#x02212;4</sup> indicates the point at which a single query with equal or better <italic>P</italic>-value is expected.</p></caption><graphic xlink:href="gkl731f1"/></fig><fig id="fig2" position="float"><label>Figure 2</label><caption><p>BLAST retrieval accuracy. The 3586 astral40 sequences having at least one other relative in the astral40 data set (<xref ref-type="bibr" rid="b18">18</xref>,<xref ref-type="bibr" rid="b19">19</xref>) are used as queries in a search of this database. The results are pooled and sorted by <italic>E</italic>-value, and ROC curves are produced by plotting the number of true positives against the number of false positives as one descends the retrieval list. In (<bold>A</bold>), ROC curves are shown for B-BLAST, S-BLAST, SU-BLAST, C-BLAST and CU-BLAST. The ROC<sub>5000</sub> scores for these programs are also shown, each having a standard error of &#x000b1; 0.0002 (2). In (<bold>B</bold>), the same ROC curves are shown in a semi-log plot, using the scales of coverage and errors per query (<xref ref-type="bibr" rid="b30">30</xref>).</p></caption><graphic xlink:href="gkl731f2"/></fig><fig id="fig3" position="float"><label>Figure 3</label><caption><p>The probability density function for &#x003bb;. The ungapped scale parameter &#x003bb; (<xref ref-type="bibr" rid="b26">26</xref>) is calculated for the standard BLOSUM-62 amino acid substitution matrix (<xref ref-type="bibr" rid="b22">22</xref>) using the observed amino frequencies of two proteins. Empirical probability density functions are shown for all pairs of unrelated proteins from the astral40 data set (<xref ref-type="bibr" rid="b18">18</xref>,<xref ref-type="bibr" rid="b19">19</xref>), as well as for all pairs of non-identical related proteins.</p></caption><graphic xlink:href="gkl731f3"/></fig><fig id="fig4" position="float"><label>Figure 4</label><caption><p>The empirical probability density of alignment and compositional <italic>P</italic>-values from shuffled sequences. 10 000 shuffled mouse query sequences were compared using S-BLAST to shuffled human RefSeq (<xref ref-type="bibr" rid="b20">20</xref>) sequences from Build 35 of the human genome. For each query, the alignment <italic>P</italic>-value <italic>P<sub>a</sub></italic> of the best match to the database was found, and the compositional <italic>P</italic>-value <italic>P<sub>c</sub></italic> was then calculated for the database sequence involved.</p></caption><graphic xlink:href="gkl731f4"/></fig><table-wrap id="tbl1" position="float"><label>Table 1</label><caption><p>Summary of the five variants of BLAST considered in this study</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="1" colspan="1">Program</th><th align="left" rowspan="1" colspan="1">Scoring adjustment</th><th align="left" rowspan="1" colspan="1">Unified <italic>P</italic>-values</th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">B-BLAST</td><td align="left" rowspan="1" colspan="1">None</td><td align="left" rowspan="1" colspan="1">No</td></tr><tr><td align="left" rowspan="1" colspan="1">S-BLAST</td><td align="left" rowspan="1" colspan="1">Compositional Scaling</td><td align="left" rowspan="1" colspan="1">No</td></tr><tr><td align="left" rowspan="1" colspan="1">C-BLAST</td><td align="left" rowspan="1" colspan="1">Compositional Adjustment</td><td align="left" rowspan="1" colspan="1">No</td></tr><tr><td align="left" rowspan="1" colspan="1">SU-BLAST</td><td align="left" rowspan="1" colspan="1">Compositional Scaling</td><td align="left" rowspan="1" colspan="1">Yes</td></tr><tr><td align="left" rowspan="1" colspan="1">CU-BLAST</td><td align="left" rowspan="1" colspan="1">Compositional Adjustment</td><td align="left" rowspan="1" colspan="1">Yes</td></tr></tbody></table><table-wrap-foot><fn><p>Compositional Scaling refers to the method in (<xref ref-type="bibr" rid="b2">2</xref>) and Compositional Adjustment refers to the method in (<xref ref-type="bibr" rid="b15">15</xref>).</p></fn></table-wrap-foot></table-wrap></sec></back></article>







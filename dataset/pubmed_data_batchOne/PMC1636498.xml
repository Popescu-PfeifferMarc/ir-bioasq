<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id><journal-id journal-id-type="publisher-id">Nucleic Acids Research</journal-id><journal-title>Nucleic Acids Research</journal-title><issn pub-type="ppub">0305-1048</issn><issn pub-type="epub">1362-4962</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">17028096</article-id><article-id pub-id-type="pmc">PMC1636498</article-id><article-id pub-id-type="doi">10.1093/nar/gkl723</article-id><article-categories><subj-group subj-group-type="heading"><subject>Computational Biology</subject></subj-group></article-categories><title-group><article-title>MetaGene: prokaryotic gene finding from environmental genome shotgun sequences</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Noguchi</surname><given-names>Hideki</given-names></name><xref ref-type="corresp" rid="cor1">*</xref></contrib><contrib contrib-type="author"><name><surname>Park</surname><given-names>Jungho</given-names></name></contrib><contrib contrib-type="author"><name><surname>Takagi</surname><given-names>Toshihisa</given-names></name></contrib><aff><institution>Department of Computational Biology, Graduate School of Frontier Sciences, University of Tokyo</institution><addr-line>Kashiwa, Chiba 277-8562, Japan</addr-line></aff></contrib-group><author-notes><corresp id="cor1"><sup>*</sup>To whom correspondence should be addressed. Tel: +81 4 7136 3973; Fax: +81 4 7136 4100; Email: <email>hide@cb.k.u-tokyo.ac.jp</email></corresp></author-notes><!--For NAR: both ppub and collection dates generated for PMC processing 1/27/05 beck--><pub-date pub-type="collection"><month>11</month><year>2006</year></pub-date><pub-date pub-type="ppub"><month>11</month><year>2006</year></pub-date><pub-date pub-type="epub"><day>05</day><month>10</month><year>2006</year></pub-date><volume>34</volume><issue>19</issue><fpage>5623</fpage><lpage>5630</lpage><history><date date-type="received"><day>18</day><month>3</month><year>2006</year></date><date date-type="rev-recd"><day>01</day><month>9</month><year>2006</year></date><date date-type="accepted"><day>19</day><month>9</month><year>2006</year></date></history><copyright-statement>&#x000a9; 2006 The Author(s)</copyright-statement><copyright-year>2006</copyright-year><license license-type="openaccess"><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/2.0/uk/) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license><abstract><p>Exhaustive gene identification is a fundamental goal in all metagenomics projects. However, most metagenomic sequences are unassembled anonymous fragments, and conventional gene-finding methods cannot be applied. We have developed a prokaryotic gene-finding program, MetaGene, which utilizes di-codon frequencies estimated by the GC content of a given sequence with other various measures. MetaGene can predict a whole range of prokaryotic genes based on the anonymous genomic sequences of a few hundred bases, with a sensitivity of 95% and a specificity of 90% for artificial shotgun sequences (700 bp fragments from 12 species). MetaGene has two sets of codon frequency interpolations, one for bacteria and one for archaea, and automatically selects the proper set for a given sequence using the domain classification method we propose. The domain classification works properly, correctly assigning domain information to more than 90% of the artificial shotgun sequences. Applied to the Sargasso Sea dataset, MetaGene predicted almost all of the annotated genes and a notable number of novel genes. MetaGene can be applied to wide variety of metagenomic projects and expands the utility of metagenomics.</p></abstract></article-meta></front><body><sec><title>INTRODUCTION</title><p>Microorganisms form complex communities in natural environments and are responsible for most of the ecological cycles that shape those environments. Therefore, identifying all community members and genes in an environment is fundamental to obtaining a perspective on the ecological systems. However, only a fraction of the living microbes can be isolated in culture. The estimations based on 16S ribosomal RNA suggest that 99% of microbial species cannot be easily cultivated (<xref ref-type="bibr" rid="b1">1</xref>,<xref ref-type="bibr" rid="b2">2</xref>). Whole-genome shotgun sequencing of environmental-pooled DNA draws attention as a powerful method for revealing genomic sequences from various organisms in natural environments without isolation and cultivation of individual species. This metagenomic approach has been applied to various environmental samples including an acid mine biofilm (<xref ref-type="bibr" rid="b3">3</xref>), the Sargasso Sea (<xref ref-type="bibr" rid="b4">4</xref>), Minnesota farm soil (<xref ref-type="bibr" rid="b5">5</xref>), whale falls (<xref ref-type="bibr" rid="b5">5</xref>) and deep sea sediments (<xref ref-type="bibr" rid="b6">6</xref>). In exceptional cases, analyses of Pleistocene cave bears (<xref ref-type="bibr" rid="b7">7</xref>) and mammoth DNA (<xref ref-type="bibr" rid="b8">8</xref>) are interesting applications of metagenomics to paleogenomics. While the metagenomic approach allows us to capture representative DNA samples from many diverse organisms, many unidentified sequences are produced at the same time. Additionally, many sequence reads remain as unassembled one-pass sequences because of the variety of sizes of environmental genomes and their abundance. Indeed, half of the reads for the Sargasso Sea dataset and all of the reads for the Minnesota soil data were unassembled sequences of roughly 700 bp. Gene-finding is a fundamental goal in virtually all metagenomics projects, but the only realistic alternative is similarity searches of the sequence database or the metagenome itself (<xref ref-type="bibr" rid="b9">9</xref>). The sensitivity of similarity search depends strongly on the availability of the relevant sequences in the database, and many novel genes of interest, which are the key element in metagenomics, are missed. To overcome this problem and exhaustively extract genes in environmental genomes, we have developed the MetaGene gene-finding program, which is designed to predict genes from fragmented genomic sequences.</p><p>Computational gene-finding from genomic DNA sequences has a long history (<xref ref-type="bibr" rid="b10">10</xref>&#x02013;<xref ref-type="bibr" rid="b12">12</xref>), and a number of prokaryotic gene-finding tools have been developed and widely applied to the annotation of the microbial genomes. Although a variety of algorithms, including the hidden Markov model (HMM), are employed in gene-finding tools (<xref ref-type="bibr" rid="b13">13</xref>&#x02013;<xref ref-type="bibr" rid="b27">27</xref>), most of the algorithms require a sufficient number of experimentally identified gene sequences from which to learn the parameters for individual species. Non-supervised training procedures eliminate that problem and can be applied to an anonymous genome (<xref ref-type="bibr" rid="b18">18</xref>&#x02013;<xref ref-type="bibr" rid="b22">22</xref>) that is either a complete genomic sequence or a large portion of the sequence that contains an adequate number of genes. However, most environmental genomic sequences are fragmented anonymous sequences that contain one or two partial genes, so almost all of these algorithms are inapplicable. Only a non-supervised procedure that employs a heuristically derived model (<xref ref-type="bibr" rid="b23">23</xref>) works well for finding genes in such fragmented anonymous sequences. In this method, codon frequencies are approximated by the GC content of a given sequence. Because strong correlation is observed between the codon frequencies and the GC content of the genomic sequence (<xref ref-type="bibr" rid="b23">23</xref>,<xref ref-type="bibr" rid="b28">28</xref>,<xref ref-type="bibr" rid="b29">29</xref>), the estimated models sufficiently represent the original codon usage of the genome. We extended the method to estimate di-codon frequencies and achieve a higher prediction accuracy than results from using mono-codon frequencies. In addition to the codon frequencies, other measures, such as the frequency distribution of open reading frame (ORF) lengths, the distance from leftmost start codons, and the distances between neighboring ORFs, are integrated in MetaGene. These additional measures remarkably improve the prediction accuracy, especially with respect to in specificity. Here, we report the results of a performance test of MetaGene applied to sequences of various lengths and GC% and its application to the contig sequences of the Sargasso Sea dataset as a case study.</p></sec><sec sec-type="materials|methods"><title>MATERIALS AND METHODS</title><sec sec-type="materials"><title>Materials</title><p>We used the complete genomic sequences and the annotations of coding regions of 143 microorganisms that are available in GenBank. To avoid overfitting to well-studied genera and to form an accurate estimation of the prediction performance, one species per genus was selected for our study. A total of 116 bacterial and 15 archaeal genomes (Supplementary Table 1) were used to obtain the statistical values for model construction; the remaining 9 bacterial and 3 archaeal genomes (Supplementary Table 2) were used to evaluate the prediction performance. These genomic sequences were randomly split into fixed-length fragments (cardinally, 700 bp, the average length of the shotgun reads) that represent 1&#x000d7; genome for each species. The fragments were used as artificial shotgun sequences for the assessment. In these fragments, uninformative miniscule partial genes (less than 60 bp) were excluded from the annotations. The prediction performance was estimated by using the annotations as correct genes. The ratios of true-positives relative to all annotated genes (sensitivity) and to all predicted genes (specificity) were calculated. Both exactly matching predictions and partially matching predictions with correct reading frames were counted as true-positives. The contig sequences and annotations of the Sargasso Sea dataset were also obtained from the Venter Institute (<ext-link ext-link-type="uri" xlink:href="http://www.venterinstitute.org/sargasso/"/>) and used for the case study.</p></sec><sec><title>Architecture of MetaGene</title><p>MetaGene predicts genes in two stages. In the first stage, all possible ORFs are extracted from a given sequence and are scored by their base compositions and lengths. In this paper, an ORF is defined as a sequence of codons starting from a start codon and stopping at a stop codon. Partial ORFs are also extracted when they are located on the ends of the given sequence or are the entire sequence. In the second stage, an optimal (high-scored) combination of ORFs is calculated using the scores of orientations and distances of neighboring ORFs in addition to the scores for the ORFs themselves. This two-stage approach also allows us to predict overlapping genes with appropriate scores.</p><p>The MetaGene scoring scheme is based on a stochastic approach. Log-odds ratios are used for scoring throughout our algorithm. The frequency of an event observed in protein-coding ORFs is divided by the observed frequency in random ORFs, and a base-two logarithm of the ratio is used as the score for the event. The statistics used in MetaGene include di-codon frequencies, ORF length distributions, distance distributions from an annotated start codon to the leftmost start codon, and frequencies of orientations and orientation-dependent distances of neighboring ORFs. Details of the scoring scheme can be seen in the Supplementary Data section.</p></sec><sec><title>Estimation of the stochastic models for a given sequence</title><sec><title>Codon frequency interpolation</title><p>Microbial genomes consist mainly of protein-coding regions, and the nucleotide frequencies in the three codon positions are strongly associated with those in the entire genome. In addition, Besemer and Borodovsky (<xref ref-type="bibr" rid="b23">23</xref>) reported that some amino acid residue frequencies are linearly related to the GC content of the genome. Since genes of certain species have almost the same codon usage or are classified into a few classes of codon usage, the usage is reflected in the local GC content of the genome. In this study, mono-codon and di-codon frequencies for the start, internal and stop codons are directly estimated by the GC% of a given sequence by using logistic regression analysis.</p><p>For the start codons, the proportions of ATG, GTG and TTG are estimated by the GC%. There is no strong correlation between the proportions of correct start codons and the GC% of the genomes, and ATG is used as the major start codon in most species. However, the proportions of incorrect start codons are strongly associated with the GC%, thus log-odds scores of the start codons vary according to the GC%. For the internal and stop codons, the conditional probability of a codon A, given a previous codon B, denoted P(A&#x02223;B), is estimated by using logistic regression analysis. We found that the di-codon frequencies are also related to the GC% like mono-codon frequencies and the relations can be successfully represented by a sigmoid function (see Supplementary Data). At the same time, we found that bacteria and archaea have slightly different trends in the relations between the di-codon frequencies (e.g. xxxATA and xxxGAG) and the GC%, which means the regression formulas derived from bacterial (or archaeal) codon frequencies are not suitable for predicting archaeal (or bacterial) genes. Actually, scores of protein-coding ORFs are degraded when codon frequencies of the wrong domain are used for the scoring (Supplementary Figure. S2). To overcome this limitation, we formulated a domain classification method for bacteria and archaea. For the domain classification, two sets of regression formulas for bacterial and archaeal codon frequencies are prepared, and both of them are applied to the scoring of ORFs in a given sequence. The definitive scores of the optimal paths of ORFs are independently calculated and compared, and the higher one is selected as the output for the given sequence. The domain classification method is just based on the differences of codon frequencies. However, some bacterial (archaeal) species have codon frequencies that are similar to archaeal (bacterial) genes. As a result, 5 of 116 bacterial (<italic>Anaplasma marginale</italic>, <italic>Aquifex aeolicus</italic>, <italic>Pelodictyon luteolum</italic>, <italic>Thermoanaerobacter tengcongensis</italic> and <italic>Thermotoga maritima</italic>) and 1 of 15 archaeal (<italic>Methanosphaera stadtmanae</italic>) genomes in the training data were misclassified by our domain classification method. The accuracies of gene-finding for the incorrectly classified genomes were still very high, because codon frequencies fitted to the species' genes were used. The aim of the domain classification is to improve gene-finding accuracy by using proper codon frequencies; our method achieves that purpose.</p></sec></sec><sec><title>Length distribution of ORFs</title><p>The ORF length is an important measure for distinguishing protein-coding ORFs from random ORFs. The average length of protein-coding (annotated) ORFs is about 950 bp, and the length distribution does not vary much among species (<xref ref-type="fig" rid="fig1">Figure 1a</xref>). Only slight decreases are observed in the frequencies of short ORFs from the high GC% genomes. On the other hand, the average lengths of random ORFs vary greatly according to the GC content of the genomes (<xref ref-type="fig" rid="fig1">Figure 1b</xref>). The average length of random ORFs (longer than 60 bp) in the low GC% genomes (&#x0003c;30%) is about 120 bp, while the average in the high GC% genomes (&#x0003e;60%) is about 300 bp. The difference in the lengths arises from the differences in the frequencies of incorrect start/stop codons in the genomes. We estimated the length distribution of random ORFs for a given sequence by linear interpolation using the distributions shown in <xref ref-type="fig" rid="fig1">Figure 1b</xref>. We used the distributions to calculate the log-odds scores of the ORF lengths for all extracted ORFs and added them to the codon-based scores. If an extracted ORF having a length <italic>l</italic> is a partial ORF, its true length will be greater than <italic>l</italic>. To appropriately evaluate the partial ORFs, which are the majority in metagenomic data, the upper probabilities derived from the distributions are used.</p></sec><sec><title>Distance distribution from the correct start codon to the leftmost start codon</title><p>It is known that the leftmost start codons are not always used as translation starts. The ratio of leftmost start codons to annotated start codons also varies greatly with the GC content of the genomes. <xref ref-type="fig" rid="fig1">Figure 1c</xref> and d show the distributions of the distance between the correct (or assumed) start codons and the leftmost ones. These GC%-dependent distributions arise from the incorrect start/stop codon frequencies like the random ORF lengths. However, a comparison between the distributions of the correct and the assumed (incorrect) start codons indicates that the protein-coding ORFs prefer the leftmost start codons to the others and that the appearance of upstream incorrect start codons is not common. Interestingly, the log-odds score of the leftmost start codon is larger in the high GC% genomes than in the low GC% genomes (data not shown), although the frequency of the leftmost start codon is lower in the high GC% genomes. Unfortunately, the annotated start codons are not always correct (<xref ref-type="bibr" rid="b22">22</xref>,<xref ref-type="bibr" rid="b30">30</xref>), and the obtained distributions may not be very accurate. The rates of the leftmost &#x02018;real&#x02019; start codon may be especially lower in GC-rich genomes. On the other hand, these distributions show significant correlation between the translation start sites and the genome GC%, which means the annotations are not random, and the obtained distributions contain useful information inherent to the annotation data. The distributions for a given sequence are estimated by linear interpolation using these distributions, and the log-odds scores are added to the ORF scores as in the case of the ORF length distribution.</p></sec><sec><title>Orientation and distance of neighboring ORFs</title><p>Prokaryotic genes are frequently arranged in tandem in the genome because of the operon structures. In the genomes studied here, about 70% of neighboring genes are tandem, and the remaining genes are arranged head-to-head and tail-to-tail in equal proportion. The orientations of neighboring genes influence their distance distributions (<xref ref-type="fig" rid="fig1">Figure 1e</xref>). The tandem genes tend to be compactly arranged, and the mode of the distribution is &#x02212;4 bp (overlaps of length four: ATGA, GTGA and TTGA). This packed arrangement is suitable for operon transcription for a single RNA. The distribution also indicates the existence of a RBS (ribosome binding site) at around 7 bp upstream of the start codons. The head-to-head genes prefer more distant arrangements because they have promoters in their upstream regions and avoid overlaps with coding regions. The tail-to-tail genes have a moderate but specific distribution compared to the others, probably indicating the existence of transcription stop signals. Such biased distributions can be used to evaluate an optimal sequence of ORFs in a given sequence. Because about half of the sequence reads (700 bp in length) have two partial genes per read, the information of neighboring ORFs is helpful in exacting gene prediction in environmental genomic sequences. We therefore integrated scores of the orientations and distances of neighboring ORFs into the calculation of a high-scoring path of ORFs. When the previous or next gene does not appear in a sequence, the upper probability derived from the distance distributions is used according to the gene orientation.</p><p>The definition of the background distribution is difficult in the intergenic regions. If the distances from one to all possible ORFs are used, a uniform distribution of extremely low frequency (depending on the genome size) is obtained. This problem can be avoided by limiting the range of ORF distances, but the background frequency depends on the range setting. In this study, the number of random ORFs between neighboring protein-coding ORFs was counted, and the distribution of the number was used to determine the neighbors. Although the number of random ORFs depends on the GC% of the genome, the distance distribution derived from the number is independent of the GC%. This is obvious because the occurrence rate of random ORFs depends on the GC%. We decided to use the upper quartile of the distribution, which means using the distances from one to the first 10 candidate ORFs to derive the background distribution. The obtained distributions are shown in <xref ref-type="fig" rid="fig1">Figure 1f</xref>.</p></sec></sec><sec><title>RESULTS AND DISCUSSION</title><sec><title>Testing on complete genomes</title><p>Although our main target is raw sequence reads and relatively short contigs, we tested the prediction performance of MetaGene on anonymized complete genomic sequences to assess the validity of our method. MetaGene just estimates codon frequencies and length (distance) distributions by the GC% of a given sequence, and does not use any other non-supervised procedure adapted to complete (long) genome using statistics from a sufficient number of candidate ORFs in the tested genome. In addition, all genomic sequences and annotations of the tested organisms were completely excluded from the training data for the codon frequency interpolation by the GC%. Despite this implementation, prediction accuracies of MetaGene for the complete genomes were extremely high (<xref ref-type="table" rid="tbl1">Table 1</xref>) and comparable to those of GeneMark.hmm, which learned its parameters using individual genomes and annotations (supervised learning). The prediction performance of MetaGene was independent of the GC content of the genomes, and the whole range of genes is precisely predicted. Only the sensitivity of <italic>Chlorobium tepidum</italic> and the specificity of <italic>Wolbachia</italic> were remarkably low both in MetaGene and GeneMark.hmm. Some archaea-like and eukaryote-like genes exist in the <italic>C.tepidum</italic> genome and degraded the sensitivity of the prediction because their codon biases differ from those of bacteria. This problem was partly improved in the MetaGene prediction for the fragmented sequences by using the domain classification method (see next section). In the <italic>Wolbachia</italic> genome, the annotated gene content is significantly lower than in the other microorganisms, and the length distribution of annotated genes is much different from that in the others. The length distribution of predicted genes was also different from that of the others, and a large number of small genes (about 200 bp) were predicted by MetaGene (and Gene Mark.hmm). This probably means that there are many pseudogenes in the genome or that sequencing (or assembling) errors occurred.</p><p>For the complete genomes, our domain classification method worked perfectly, and the predictions for all species were performed with regression formulas of the appropriate domain. Examples of score distributions of ORFs derived from the archaeal and the bacterial set of regression formulas are shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>. The separation performances varied significantly with the species and the selected set of regression formulas. The scores for correct genes showed especially remarkable improvement from the use of the appropriate set of the regression formulas. This means the background frequencies for bacteria and archaea are almost the same, while the codon frequencies are significantly different.</p></sec><sec><title>Testing on artificial shotgun sequences</title><p>To assess the prediction performance of MetaGene on small fragments of anonymous genomic sequences, the complete genomic sequences of 12 organisms were randomly split into 700 bp fragments of 1&#x000d7; genome coverage. About 1.4 genes per fragment were annotated in the artificial shotgun sequences, and 92% of the annotated genes were partial genes. Here, miniscule partial genes, which are less than 60 bp in length, had been excluded from the annotations of the fragments. <xref ref-type="table" rid="tbl2">Table 2</xref> shows the accuracies of MetaGene on the artificial shotgun sequences. The sensitivities for the fragments were high enough and equivalent to those for the complete genomes, while the specificities were significantly degraded. The result shows the difficulty of distinguishing fragmented short genes from background noise. Despite the degradation of the specificity, the absolute values were still high enough, and the performance of MetaGene on the shotgun sequences is sufficient for practical use in metagenomic gene-finding. Interestingly, the sensitivities based on the exact match criterion were higher than those on the complete genomes because many ORFs for the fragments lack their 5&#x02032; ends, including start codons.</p><p>In about 90% of the fragmented sequences, the correct domain (i.e. the same domain as the original genome) was selected to predict genes (<xref ref-type="table" rid="tbl2">Table 2</xref>). Interestingly, more annotated genes were successfully detected for the fragmented genomic sequences of <italic>C.tepidum</italic> TLS than for the complete genomic sequences by using the archaeal codon frequencies as well as the bacterial codon frequencies. In the <italic>C.tepidum</italic> genome, the existence of many archaea-like proteins (about 12% of the annotated proteins) was reported (<xref ref-type="bibr" rid="b31">31</xref>). Many of these archaea-like genes, which may result from lateral gene transfer, were missed in the prediction for the complete genome because the bacterial codon frequencies were selected. For the fragmented sequences, all genes, including these archaea-like genes, were correctly predicted by using the proper codon frequencies for each fragment. As a result, the sensitivity increased significantly despite the short lengths of the input sequences. In the prediction for the two archaeal genomes, <italic>Methanocaldococcus jannaschii</italic> and <italic>Natronomonas pharaonis</italic>, 25&#x02013;30% of the fragments were misclassified, which means the bacterial codon frequencies were applied to them. However, the prediction accuracies on these genomes were adequately high. This result suggests that these species have a considerable number of genes that are similar to bacterial genes. In fact, it is known that <italic>M.jannaschii</italic> shares the majority of genes related to energy production, cell division and metabolism with bacteria (<xref ref-type="bibr" rid="b32">32</xref>).</p><p>To examine the effectiveness of the measures employed by MetaGene to precisely predict genes on the fragmented sequences, three additional prediction models were constructed and applied to the artificial shotgun sequences (<xref ref-type="table" rid="tbl3">Table 3</xref>). One model used all of the ORF scores (the ORF model), such as the codon frequencies, the ORF length distributions and the distance distributions of start codons, but did not use the orientation and distance distributions of neighboring ORFs. Another model used only the codon frequencies (di-codon model), and no other measures were integrated. The other (mono-codon model) was an alternative the di-codon model that substituted mono-codon frequencies for di-codon frequencies. Surprisingly, the di-codon model was sufficiently accurate, suggesting that the GC%-dependent di-codon models were the predominant gene-finding measures in MetaGene. The mono-codon model also showed high sensitivities, but the specificities were low. In the predictions of the ORF model, both sensitivities and specificities were improved. Most of the annotated genes were partial in the artificial shotgun sequences, and statistically-accurate scoring for such partial genes worked well. In addition, the length/distance scores facilitated an exact prediction of ORFs. In the original MetaGene, the orientation and orientation-dependent distance distributions helped to predict an optimal gene set in a genomic sequence, and significantly improved the specificities of the predictions. All of the measures certainly improved the prediction performance, especially the specificity. By integrating all of the measures, MetaGene achieves reliable gene prediction for small fragments of genomic sequences.</p><p>Raw shotgun sequences vary in length, although the average is about 700 bp. We applied MetaGene to various fixed-length fragments ranging from 100 to 1000 bases (1&#x000d7; genome) and inspected the change of the prediction performance with the length of the input sequence (<xref ref-type="fig" rid="fig3">Figure 3</xref>). The prediction accuracies naturally decreased along with the shortening of the input sequences. However, MetaGene retained relatively high accuracies on smaller fragments, and extreme degradation of accuracy was observed only for the 100 bp fragments. Generally, most raw sequence reads are larger than 500&#x02013;600 bp, which is to say that MetaGene can predict genes on the metagenomic data with high reliability.</p><p>Another problem of raw data are the occurrence of sequence errors. Shotgun sequences include more errors than the complete genomes because of the one-pass status of the shotgun sequences. Most low-quality nucleotides concentrate near the ends of the sequences, and such nucleotides are ordinarily cut out from the sequences (<xref ref-type="bibr" rid="b3">3</xref>,<xref ref-type="bibr" rid="b5">5</xref>). As a result, the shotgun sequences have a relatively high average of quality values, which are assigned to nucleotides by a base-call program (the average is usually more than 40, or less than one error per 10&#x02009;000 bp). We tested the effect of sequence errors on gene-finding using artificial sequences with variable error rates (<xref ref-type="fig" rid="fig4">Figure 4</xref>). Position-specific error rates were obtained from actual trace data (sequence + quality files), and the average was modulated. Degradation of the prediction performance was sufficiently low, suggesting reliable predictions can be performed by MetaGene on real metagenomic sequences.</p></sec><sec><title>Application to metagenomic sequences</title><p>We applied MetaGene to the contig sequences in the Sargasso Sea dataset. The dataset consists of about 0.8 million contigs having an average length of about 1 kb (about 820 Mb in total) and having about one million genes annotated. The annotated genes were determined mainly by their similarity to the known bacterial genes. Some hypothetical genes were also determined based on the presence of conserved ORFs (<xref ref-type="bibr" rid="b4">4</xref>). For the contig sequences, about 1.4 million genes were predicted by MetaGene. Almost all annotated genes (96% of known genes and 92% of hypothetical genes) appeared in our predictions, and about 0.4 million genes were additionally predicted. These genes are strong candidates for novel genes from uncultured microorganisms, and they were five times more numerous than the hypothetical genes in the annotation. This means homology-based methods miss on notable number (&#x0003e;30%) of genes, and thus reduce the advantage of the metagenomic approach. The numbers of estimated genes disaggregated by length are shown in <xref ref-type="fig" rid="fig5">Figure 5</xref>. The MetaGene predictions were almost identical to the theoretical numbers, while those of the annotated genes were much lower in a wide range of lengths. Not only short ORFs but also relatively long ones were captured by MetaGene as novel genes. Many short ORFs exist in the Sargasso data, and MetaGene also predicted many short ORFs. However, these distributions suggest that most of the false positives may be accumulated in these short ORFs. The number of ORFs having 900 bases was lower than the theoretical number. The Sargasso sequences have a peak at around 900 bp, and many partial ORFs whose lengths are identical to the input sequences (900 bp) were predicted in theory. Because of the sequencing errors, some of such long ORFs may be broken by false stop codons and/or frame shifts in the real sequence data.</p><p>In the Sargasso Sea dataset, about 90% of the genes were predicted by the bacterial model, and only a fraction was classified into archaeal genes. Although this value does not directly reflect the abundances of bacterial and archaeal species, the result is consistent with the estimate based on 16S rRNA sequences. Our domain classification method was designed to precisely predict all genes and not to correctly estimate the domain of the given sequence. However, we believe that the additional domain information is useful in obtaining an overview of the microbial community in the environmental sample.</p></sec><sec><title>Availability of MetaGene</title><p>MetaGene has a very simple architecture and does not require a long calculation time. It took only about 15 min to test all of the contigs of the Sargasso Sea dataset on a single core of a Pentium D (3.4 GHz)/Linux system. The software implemented in C++ can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://metagene.cb.k.u-tokyo.ac.jp/"/>. A Web interface to the software is also available at the web site.</p></sec></sec><sec><title>SUPPLEMENTARY DATA</title><p>Supplementary Data are available at NAR Online.</p></sec>
<sec sec-type="supplementary-material">
<title>Supplementary Material</title>
<supplementary-material id="PMC_1" content-type="local-data">
<caption>
<title>[Supplementary Data]</title>
</caption>
<media mimetype="text" mime-subtype="html" xlink:href="nar_gkl723_index.html"/>
<media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="nar_gkl723_1.pdf"/>
<media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="nar_gkl723_2.pdf"/>
<media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="nar_gkl723_3.pdf"/>
<media xlink:role="associated-file" mimetype="text" mime-subtype="plain" xlink:href="nar_gkl723_figS1.png"/>
<media xlink:role="associated-file" mimetype="text" mime-subtype="plain" xlink:href="nar_gkl723_figS2.png"/>
</supplementary-material>
</sec>
</body><back><ack><p>The authors are grateful to Takehiko Itoh at Mitsubishi Research Institute, Inc. for preparing the test dataset and to Natsu Ishii for help with manuscript preparation. Funding to pay the Open Access publication charges for this article was provided by Grant-in-Aid for Scientific Research on Priority Areas &#x0201c;Systems Genomics&#x0201d; from the Ministry of Education, Culture, Sports, Science and Technology of Japan.</p><p><italic>Conflict of interest statement.</italic> None declared.</p></ack><ref-list><title>REFERENCES</title><ref id="b1"><label>1</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hugenholtz</surname><given-names>P.</given-names></name></person-group><article-title>Exploring prokaryotic diversity in the genomic era</article-title><source>Genome Biol.</source><year>2002</year><volume>3</volume><comment>reviews0003.1--0003.8</comment></citation></ref><ref id="b2"><label>2</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rappe</surname><given-names>M.</given-names></name><name><surname>Giovannoni</surname><given-names>S.</given-names></name></person-group><article-title>The uncultured microbial majority</article-title><source>Annu. Rev. Microbiol.</source><year>2003</year><volume>57</volume><fpage>369</fpage><lpage>394</lpage><pub-id pub-id-type="pmid">14527284</pub-id></citation></ref><ref id="b3"><label>3</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Tyson</surname><given-names>G.W.</given-names></name><name><surname>Chapman</surname><given-names>J.</given-names></name><name><surname>Hugenholtz</surname><given-names>P.</given-names></name><name><surname>Allen</surname><given-names>E.E.</given-names></name><name><surname>Ram</surname><given-names>R.J.</given-names></name><name><surname>Richardson</surname><given-names>P.M.</given-names></name><name><surname>Solovyev</surname><given-names>V.V.</given-names></name><name><surname>Rubin</surname><given-names>E.M.</given-names></name><name><surname>Rokhsar</surname><given-names>D.S.</given-names></name><name><surname>Banfield</surname><given-names>J.F.</given-names></name></person-group><article-title>Community structure and metabolism through reconsruction of microbial genomes from the environment</article-title><source>Nature</source><year>2004</year><volume>428</volume><fpage>37</fpage><lpage>43</lpage><pub-id pub-id-type="pmid">14961025</pub-id></citation></ref><ref id="b4"><label>4</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Venter</surname><given-names>J.C.</given-names></name><name><surname>Remington</surname><given-names>K.</given-names></name><name><surname>Heidelberg</surname><given-names>J.F.</given-names></name><name><surname>Halpern</surname><given-names>A.L.</given-names></name><name><surname>Rusch</surname><given-names>D.</given-names></name><name><surname>Eisen</surname><given-names>J.A.</given-names></name><name><surname>Wu</surname><given-names>D.</given-names></name><name><surname>Paulsen</surname><given-names>I.</given-names></name><name><surname>Nelson</surname><given-names>K.E.</given-names></name><name><surname>Nelson</surname><given-names>W.</given-names></name><etal/></person-group><article-title>Environmental genome shotgun sequencing of the Sargasso Sea</article-title><source>Science</source><year>2004</year><volume>304</volume><fpage>66</fpage><lpage>74</lpage><pub-id pub-id-type="pmid">15001713</pub-id></citation></ref><ref id="b5"><label>5</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Tringle</surname><given-names>S.G.</given-names></name><name><surname>Mering</surname><given-names>C.V.</given-names></name><name><surname>Kobayashi</surname><given-names>A.</given-names></name><name><surname>Salamov</surname><given-names>A.A.</given-names></name><name><surname>Chen</surname><given-names>K.</given-names></name><name><surname>Chang</surname><given-names>H.W.</given-names></name><name><surname>Podar</surname><given-names>M.</given-names></name><name><surname>Short</surname><given-names>J.M.</given-names></name><name><surname>Mathur</surname><given-names>E.J.</given-names></name><name><surname>Detter</surname><given-names>J.C.</given-names></name><etal/></person-group><article-title>Comparative metagenomics of microbial communities</article-title><source>Science</source><year>2005</year><volume>308</volume><fpage>554</fpage><lpage>557</lpage><pub-id pub-id-type="pmid">15845853</pub-id></citation></ref><ref id="b6"><label>6</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hallam</surname><given-names>S.J.</given-names></name><name><surname>Putnam</surname><given-names>N.</given-names></name><name><surname>Preston</surname><given-names>C.M.</given-names></name><name><surname>Detter</surname><given-names>J.C.</given-names></name><name><surname>Rokhsar</surname><given-names>D.</given-names></name><name><surname>Richardson</surname><given-names>P.M.</given-names></name><name><surname>DeLong</surname><given-names>E.F.</given-names></name></person-group><article-title>Reverse Methanogenesis: testing the hypothesis with environmental genomics</article-title><source>Science</source><year>2004</year><volume>305</volume><fpage>1457</fpage><lpage>1462</lpage><pub-id pub-id-type="pmid">15353801</pub-id></citation></ref><ref id="b7"><label>7</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Noonan</surname><given-names>J.P.</given-names></name><name><surname>Hofreiter</surname><given-names>M.</given-names></name><name><surname>Smith</surname><given-names>D.</given-names></name><name><surname>Priest</surname><given-names>J.R.</given-names></name><name><surname>Rohland</surname><given-names>N.</given-names></name><name><surname>Rabeder</surname><given-names>G.</given-names></name><name><surname>Krause</surname><given-names>J.</given-names></name><name><surname>Detter</surname><given-names>C.D.</given-names></name><name><surname>Paabo</surname><given-names>S.</given-names></name><name><surname>Rubin</surname><given-names>E.M.</given-names></name></person-group><article-title>Genomic sequencing of Pleistocene Cave Bears</article-title><source>Science</source><year>2005</year><volume>309</volume><fpage>597</fpage><lpage>599</lpage><pub-id pub-id-type="pmid">15933159</pub-id></citation></ref><ref id="b8"><label>8</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Poinar</surname><given-names>H.N.</given-names></name><name><surname>Schwarz</surname><given-names>C.</given-names></name><name><surname>Qi</surname><given-names>J.</given-names></name><name><surname>Shapiro</surname><given-names>B.</given-names></name><name><surname>MacPhee</surname><given-names>R.D.E.</given-names></name><name><surname>Buigues</surname><given-names>B.</given-names></name><name><surname>Tikhonov</surname><given-names>A.</given-names></name><name><surname>Huson</surname><given-names>D.H.</given-names></name><name><surname>Tomsho</surname><given-names>L.P.</given-names></name><name><surname>Auch</surname><given-names>A.</given-names></name><etal/></person-group><article-title>Metagenomics to Paleogenomics: large-scale sequencing of mammoth DNA</article-title><source>Science</source><year>2006</year><volume>311</volume><fpage>392</fpage><lpage>394</lpage><pub-id pub-id-type="pmid">16368896</pub-id></citation></ref><ref id="b9"><label>9</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>K.</given-names></name><name><surname>Pachter</surname><given-names>L.</given-names></name></person-group><article-title>Bioinformatics for whole-genome shotgun sequencing of microbial communities</article-title><source>PLoS Comput. Biol.</source><year>2005</year><volume>1</volume><fpage>106</fpage><lpage>112</lpage><pub-id pub-id-type="pmid">16110337</pub-id></citation></ref><ref id="b10"><label>10</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Fickett</surname><given-names>J.W.</given-names></name></person-group><article-title>Recognition of protein coding regions in DNA sequences</article-title><source>Nucleic Acids Res.</source><year>1981</year><volume>10</volume><fpage>5303</fpage><lpage>5318</lpage><pub-id pub-id-type="pmid">7145702</pub-id></citation></ref><ref id="b11"><label>11</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gribskov</surname><given-names>M.</given-names></name><name><surname>Devereux</surname><given-names>J.</given-names></name><name><surname>Burgess</surname><given-names>R.R.</given-names></name></person-group><article-title>The codon preference plot: graphic analysis of protein coding sequences and prediction of gene expression</article-title><source>Nucleic Acids Res.</source><year>1984</year><volume>12</volume><fpage>539</fpage><lpage>549</lpage><pub-id pub-id-type="pmid">6694906</pub-id></citation></ref><ref id="b12"><label>12</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Staden</surname><given-names>R.</given-names></name></person-group><article-title>Measurements of the effects of that coding for a protein has on a DNA sequence and their use for finding genes</article-title><source>Nucleic Acids Res.</source><year>1984</year><volume>12</volume><fpage>551</fpage><lpage>567</lpage><pub-id pub-id-type="pmid">6364041</pub-id></citation></ref><ref id="b13"><label>13</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Borodovsky</surname><given-names>M.Y.</given-names></name><name><surname>Sprizhitskii</surname><given-names>Y.A.</given-names></name><name><surname>Golovanov</surname><given-names>E.I.</given-names></name><name><surname>Aleksandrov</surname><given-names>A.A.</given-names></name></person-group><article-title>Statistical patterns in primary structures of functional regions in the <italic>E.coli</italic> genome: III. Computer recognition of coding regions</article-title><source>Mol. Biol.</source><year>1986</year><volume>20</volume><fpage>1145</fpage><lpage>1150</lpage></citation></ref><ref id="b14"><label>14</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Borodovsky</surname><given-names>M.Y.</given-names></name><name><surname>McIninch</surname><given-names>J.D.</given-names></name></person-group><article-title>GeneMark: parallel gene recognition for both DNA strands</article-title><source>Comput. Chem.</source><year>1993</year><volume>17</volume><fpage>123</fpage><lpage>153</lpage></citation></ref><ref id="b15"><label>15</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Salzberg</surname><given-names>S.L.</given-names></name><name><surname>Delcher</surname><given-names>A.L.</given-names></name><name><surname>Kasif</surname><given-names>S.</given-names></name><name><surname>White</surname><given-names>O.</given-names></name></person-group><article-title>Microbial gene identification using interpolated Markov mode</article-title><source>Nucleic Acids Res.</source><year>1998</year><volume>26</volume><fpage>544</fpage><lpage>548</lpage><pub-id pub-id-type="pmid">9421513</pub-id></citation></ref><ref id="b16"><label>16</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Krogh</surname><given-names>A.</given-names></name><name><surname>Mian</surname><given-names>I.S.</given-names></name><name><surname>Haussler</surname><given-names>D.</given-names></name></person-group><article-title>A hidden Markov model that finds genes in <italic>E.coli</italic> DNA</article-title><source>Nucleic Acids Res.</source><year>1994</year><volume>22</volume><fpage>4768</fpage><lpage>4778</lpage><pub-id pub-id-type="pmid">7984429</pub-id></citation></ref><ref id="b17"><label>17</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lukashin</surname><given-names>A.V.</given-names></name><name><surname>Borodovsky</surname><given-names>M.</given-names></name></person-group><article-title>GeneMark.hmm: new solutions for gene finding</article-title><source>Nucleic Acids Res.</source><year>1998</year><volume>26</volume><fpage>1107</fpage><lpage>1115</lpage><pub-id pub-id-type="pmid">9461475</pub-id></citation></ref><ref id="b18"><label>18</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Delcher</surname><given-names>A.L.</given-names></name><name><surname>Harmon</surname><given-names>D.</given-names></name><name><surname>Kasif</surname><given-names>S.</given-names></name><name><surname>White</surname><given-names>O.</given-names></name><name><surname>Salzberg</surname><given-names>S.L.</given-names></name></person-group><article-title>Improved microbial gene identification with GLIMMER</article-title><source>Nucleic Acids Res.</source><year>1999</year><volume>27</volume><fpage>4636</fpage><lpage>4641</lpage><pub-id pub-id-type="pmid">10556321</pub-id></citation></ref><ref id="b19"><label>19</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hayes</surname><given-names>W.S.</given-names></name><name><surname>Borodovsky</surname><given-names>M.</given-names></name></person-group><article-title>How to interpret an anonymous bacterial genome: machine learning approach to gene identification</article-title><source>Genome Res.</source><year>1998</year><volume>8</volume><fpage>1154</fpage><lpage>1171</lpage><pub-id pub-id-type="pmid">9847079</pub-id></citation></ref><ref id="b20"><label>20</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Audic</surname><given-names>S.</given-names></name><name><surname>Claverie</surname><given-names>J.M.</given-names></name></person-group><article-title>Self-identification of protein-coding regions in microbial genomes</article-title><source>Proc. Natl Acad. Sci. USA</source><year>1998</year><volume>95</volume><fpage>10026</fpage><lpage>10031</lpage><pub-id pub-id-type="pmid">9707594</pub-id></citation></ref><ref id="b21"><label>21</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Baldi</surname><given-names>P.</given-names></name></person-group><article-title>On the convergence of a clustering algorithm for protein-coding regions in microbial genomes</article-title><source>Bioinformatics</source><year>2000</year><volume>16</volume><fpage>367</fpage><lpage>371</lpage><pub-id pub-id-type="pmid">10869034</pub-id></citation></ref><ref id="b22"><label>22</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Besemer</surname><given-names>J.</given-names></name><name><surname>Lomsadze</surname><given-names>A.</given-names></name><name><surname>Borodovsky</surname><given-names>M.</given-names></name></person-group><article-title>GeneMarkS: a self-training method for prediction of gene starts in microbial genomes. Implications for finding sequence motifs in regulatory regions</article-title><source>Nucleic Acids Res.</source><year>2001</year><volume>29</volume><fpage>2607</fpage><lpage>2618</lpage><pub-id pub-id-type="pmid">11410670</pub-id></citation></ref><ref id="b23"><label>23</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Besemer</surname><given-names>J.</given-names></name><name><surname>Borodovsky</surname><given-names>M.</given-names></name></person-group><article-title>Heuristic approach to deriving models for gene finding</article-title><source>Nucleic Acids Res.</source><year>1999</year><volume>27</volume><fpage>3911</fpage><lpage>3920</lpage><pub-id pub-id-type="pmid">10481031</pub-id></citation></ref><ref id="b24"><label>24</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Frishman</surname><given-names>D.</given-names></name><name><surname>Mironov</surname><given-names>A.</given-names></name><name><surname>Mewes</surname><given-names>H.-W.</given-names></name><name><surname>Gelfand</surname><given-names>M.</given-names></name></person-group><article-title>Combining diverse evidence for gene recognition in completely sequenced bacterial genomes</article-title><source>Nucleic Acids Res.</source><year>1998</year><volume>26</volume><fpage>2941</fpage><lpage>2947</lpage><pub-id pub-id-type="pmid">9611239</pub-id></citation></ref><ref id="b25"><label>25</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Shmatkov</surname><given-names>A.M.</given-names></name><name><surname>Melikyan</surname><given-names>A.A.</given-names></name><name><surname>Chernousko</surname><given-names>F.L.</given-names></name><name><surname>Borodovsky</surname><given-names>M.</given-names></name></person-group><article-title>Finding prokaryotic genes by the &#x02018;frame-by-frame&#x02019; algorithm: targeting gene starts and overlapping genes</article-title><source>Bioinformatics</source><year>1999</year><volume>15</volume><fpage>874</fpage><lpage>886</lpage><pub-id pub-id-type="pmid">10743554</pub-id></citation></ref><ref id="b26"><label>26</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yada</surname><given-names>T.</given-names></name><name><surname>Nakao</surname><given-names>M.</given-names></name><name><surname>Totoki</surname><given-names>Y.</given-names></name><name><surname>Nakai</surname><given-names>K.</given-names></name></person-group><article-title>Modeling and predicting transcriptional units of <italic>Escherichia coli</italic> genes using hidden Markov model</article-title><source>Bioinformatics</source><year>1999</year><volume>15</volume><fpage>987</fpage><lpage>993</lpage><pub-id pub-id-type="pmid">10745988</pub-id></citation></ref><ref id="b27"><label>27</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yada</surname><given-names>T.</given-names></name><name><surname>Totoki</surname><given-names>Y.</given-names></name><name><surname>Takagi</surname><given-names>T.</given-names></name><name><surname>Nakai</surname><given-names>K.</given-names></name></person-group><article-title>A novel bacterial gene-finding system with improved accuracy in locating start codons</article-title><source>DNA Res.</source><year>2001</year><volume>8</volume><fpage>97</fpage><lpage>106</lpage><pub-id pub-id-type="pmid">11475327</pub-id></citation></ref><ref id="b28"><label>28</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Karlin</surname><given-names>S.</given-names></name></person-group><article-title>Detecting anomalous gene clusters and pathogenicity islands in diverse bacterial genomes</article-title><source>Trends Microbiol.</source><year>2001</year><volume>9</volume><fpage>335</fpage><lpage>343</lpage><pub-id pub-id-type="pmid">11435108</pub-id></citation></ref><ref id="b29"><label>29</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Tu</surname><given-names>Q.</given-names></name><name><surname>Ding</surname><given-names>D.</given-names></name></person-group><article-title>Detcting pathogenicity islands and anomalous gene clusters by iterative discriminant analysis</article-title><source>FEMS Microbiol. Lett.</source><year>2003</year><volume>221</volume><fpage>269</fpage><lpage>275</lpage><pub-id pub-id-type="pmid">12725938</pub-id></citation></ref><ref id="b30"><label>30</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Nielsen</surname><given-names>P.</given-names></name><name><surname>Krogh</surname><given-names>A.</given-names></name></person-group><article-title>Large-scale prokaryotic gene prediction and comparison to genome annotation</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>4322</fpage><lpage>4329</lpage><pub-id pub-id-type="pmid">16249266</pub-id></citation></ref><ref id="b31"><label>31</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Eisen</surname><given-names>J.A.</given-names></name><name><surname>Nelson</surname><given-names>K.E.</given-names></name><name><surname>Paulsen</surname><given-names>I.T.</given-names></name><name><surname>Heidelberg</surname><given-names>J.F.</given-names></name><name><surname>Wu</surname><given-names>M.</given-names></name><name><surname>Dodson</surname><given-names>R.J.</given-names></name><name><surname>Deboy</surname><given-names>R.</given-names></name><name><surname>Gwinn</surname><given-names>M.L.</given-names></name><name><surname>Nelson</surname><given-names>W.C.</given-names></name><name><surname>Haft</surname><given-names>D.H.</given-names></name><etal/></person-group><article-title>The complete genome sequence of <italic>Chlorobium tepidum</italic> TLS, a photosynthetic, anaerobic, green-sulfur bacterium</article-title><source>Proc. Natl Acad. Sci. USA</source><year>2002</year><volume>99</volume><fpage>9509</fpage><lpage>9514</lpage><pub-id pub-id-type="pmid">12093901</pub-id></citation></ref><ref id="b32"><label>32</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bult</surname><given-names>C.J.</given-names></name><name><surname>White</surname><given-names>O.</given-names></name><name><surname>Olsen</surname><given-names>G.J.</given-names></name><name><surname>Zhou</surname><given-names>L.</given-names></name><name><surname>Fleischmann</surname><given-names>R.D.</given-names></name><name><surname>Sutton</surname><given-names>G.G.</given-names></name><name><surname>Blake</surname><given-names>J.A.</given-names></name><name><surname>FitzGerald</surname><given-names>L.M.</given-names></name><name><surname>Clayton</surname><given-names>R.A.</given-names></name><name><surname>Gocayne</surname><given-names>J.D.</given-names></name><etal/></person-group><article-title>Complete genome sequence of the methanogenic archaeon, <italic>Methanococcus jannaschii</italic></article-title><source>Science</source><year>1996</year><volume>273</volume><fpage>1058</fpage><lpage>1073</lpage><pub-id pub-id-type="pmid">8688087</pub-id></citation></ref></ref-list><sec sec-type="display-objects"><title>Figures and Tables</title><fig id="fig1" position="float"><label>Figure 1</label><caption><p>Length distributions of (<bold>a</bold>) annotated ORFs and (<bold>b</bold>) random ORFs. ORFs are classified by the GC% of their genomes, and then the length distributions of each class are calculated. Distributions of distances between (<bold>c</bold>) leftmost start codons and annotated start codons and (<bold>d</bold>) leftmost start codons and incorrect start codons. Zero means the leftmost start codons are used as the start codons of the ORFs. (<bold>e</bold>) Orientation-dependent distributions of distances between neighboring ORFs. (<bold>f</bold>) The background distributions. Negative values mean overlapping of ORFs.</p></caption><graphic xlink:href="gkl723f1"/></fig><fig id="fig2" position="float"><label>Figure 2</label><caption><p>Distributions of log-odds scores of ORFs calculated with (<bold>a</bold>) archaeal models and (<bold>b</bold>) bacterial models. Score distributions of the annotated genes and false positives for <italic>Archaeoglobus fulgidus</italic> and <italic>Escherichia coli</italic> are indicated.</p></caption><graphic xlink:href="gkl723f2"/></fig><fig id="fig3" position="float"><label>Figure 3</label><caption><p>Sensitivity and specificity of MetaGene for the sets of fixed-length artificial shotgun sequences. The average values for 12 species are indicated.</p></caption><graphic xlink:href="gkl723f3"/></fig><fig id="fig4" position="float"><label>Figure 4</label><caption><p>Effect of sequence errors on gene-finding. Nucleotides of the artificial sequences (700 bp) were changed according to position-specific error rates derived from actual data. The percentages are plotted against the averages of the position-specific error rates.</p></caption><graphic xlink:href="gkl723f4"/></fig><fig id="fig5" position="float"><label>Figure 5</label><caption><p>Length distributions of ORFs predicted by various methods. The theoretical distribution was calculated by using gene densities and the length distributions of complete ORFs.</p></caption><graphic xlink:href="gkl723f5"/></fig><table-wrap id="tbl1" position="float"><label>Table 1</label><caption><p>Gene prediction accuracies for nine bacterial and three archaeal complete genomes</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="1" colspan="1">Organisms</th><th align="left" rowspan="1" colspan="1">GC%</th><th align="left" rowspan="1" colspan="1">Known genes</th><th colspan="2" align="left" rowspan="1">MetaGene</th><th colspan="2" align="left" rowspan="1">GeneMark.hmm</th></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><th align="left" rowspan="1" colspan="1">Sn (%) (exact)</th><th align="left" rowspan="1" colspan="1">Sp (%)</th><th align="left" rowspan="1" colspan="1">Sn (%) (exact)</th><th align="left" rowspan="1" colspan="1">Sp (%)</th></tr></thead><tbody><tr><td colspan="7" align="left" rowspan="1">Archaea</td></tr><tr><td align="left" rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;<italic>M.jannaschii DSM 2661</italic></td><td align="left" rowspan="1" colspan="1">31.4</td><td align="left" rowspan="1" colspan="1">1724</td><td align="left" rowspan="1" colspan="1">98.4 (69.9)</td><td align="left" rowspan="1" colspan="1">96.1</td><td align="left" rowspan="1" colspan="1">98.9 (63.1)</td><td align="left" rowspan="1" colspan="1">95.4</td></tr><tr><td align="left" rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;<italic>A.fulgidus DSM 4304</italic></td><td align="left" rowspan="1" colspan="1">48.6</td><td align="left" rowspan="1" colspan="1">2407</td><td align="left" rowspan="1" colspan="1">96.2 (73.5)</td><td align="left" rowspan="1" colspan="1">94.8</td><td align="left" rowspan="1" colspan="1">96.9 (72.0)</td><td align="left" rowspan="1" colspan="1">94.0</td></tr><tr><td align="left" rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;<italic>N.pharaonis DSM 2160</italic></td><td align="left" rowspan="1" colspan="1">63.4</td><td align="left" rowspan="1" colspan="1">2661</td><td align="left" rowspan="1" colspan="1">96.9 (80.7)</td><td align="left" rowspan="1" colspan="1">97.7</td><td align="left" rowspan="1" colspan="1">95.8 (84.8)</td><td align="left" rowspan="1" colspan="1">98.8</td></tr><tr><td colspan="7" align="left" rowspan="1">Bacteria</td></tr><tr><td align="left" rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;<italic>Buchnera aphidicola str. APS</italic></td><td align="left" rowspan="1" colspan="1">26.3</td><td align="left" rowspan="1" colspan="1">563</td><td align="left" rowspan="1" colspan="1">99.6 (88.5)</td><td align="left" rowspan="1" colspan="1">94.6</td><td align="left" rowspan="1" colspan="1">99.8 (88.6)</td><td align="left" rowspan="1" colspan="1">95.6</td></tr><tr><td align="left" rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;<italic>Prochlorococcus marinus str. MIT 9312</italic></td><td align="left" rowspan="1" colspan="1">31.2</td><td align="left" rowspan="1" colspan="1">1809</td><td align="left" rowspan="1" colspan="1">95.9 (86.6)</td><td align="left" rowspan="1" colspan="1">94.9</td><td align="left" rowspan="1" colspan="1">97.1 (87.7)</td><td align="left" rowspan="1" colspan="1">95.7</td></tr><tr><td align="left" rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;<italic>Wolbachia endosymbiont strain TRS</italic></td><td align="left" rowspan="1" colspan="1">34.2</td><td align="left" rowspan="1" colspan="1">805</td><td align="left" rowspan="1" colspan="1">95.2 (76.5)</td><td align="left" rowspan="1" colspan="1">75.9</td><td align="left" rowspan="1" colspan="1">98.9 (85.7)</td><td align="left" rowspan="1" colspan="1">75.0</td></tr><tr><td align="left" rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;<italic>Helicobacter pylori J99</italic></td><td align="left" rowspan="1" colspan="1">39.2</td><td align="left" rowspan="1" colspan="1">1477</td><td align="left" rowspan="1" colspan="1">96.3 (74.2)</td><td align="left" rowspan="1" colspan="1">96.3</td><td align="left" rowspan="1" colspan="1">98.3 (88.2)</td><td align="left" rowspan="1" colspan="1">95.1</td></tr><tr><td align="left" rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;<italic>Bacillus subtilis subsp. subtilis str. 168</italic></td><td align="left" rowspan="1" colspan="1">43.5</td><td align="left" rowspan="1" colspan="1">4102</td><td align="left" rowspan="1" colspan="1">94.0 (61.8)</td><td align="left" rowspan="1" colspan="1">96.9</td><td align="left" rowspan="1" colspan="1">97.9 (86.2)</td><td align="left" rowspan="1" colspan="1">95.3</td></tr><tr><td align="left" rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;<italic>E.coli K12</italic></td><td align="left" rowspan="1" colspan="1">50.8</td><td align="left" rowspan="1" colspan="1">4236</td><td align="left" rowspan="1" colspan="1">94.7 (72.3)</td><td align="left" rowspan="1" colspan="1">97.3</td><td align="left" rowspan="1" colspan="1">97.2 (74.3)</td><td align="left" rowspan="1" colspan="1">96.8</td></tr><tr><td align="left" rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;<italic>C.tepidum TLS</italic></td><td align="left" rowspan="1" colspan="1">56.5</td><td align="left" rowspan="1" colspan="1">2252</td><td align="left" rowspan="1" colspan="1">82.4 (59.9)</td><td align="left" rowspan="1" colspan="1">95.1</td><td align="left" rowspan="1" colspan="1">84.1 (58.1)</td><td align="left" rowspan="1" colspan="1">93.4</td></tr><tr><td align="left" rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;<italic>Corynebacterium jeikeium K411</italic></td><td align="left" rowspan="1" colspan="1">61.4</td><td align="left" rowspan="1" colspan="1">2137</td><td align="left" rowspan="1" colspan="1">94.6 (70.0)</td><td align="left" rowspan="1" colspan="1">97.0</td><td align="left" rowspan="1" colspan="1">95.5 (72.3)</td><td align="left" rowspan="1" colspan="1">97.7</td></tr><tr><td align="left" rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;<italic>Burkholderia pseudomallei K96243 chr.1</italic></td><td align="left" rowspan="1" colspan="1">67.7</td><td align="left" rowspan="1" colspan="1">3398</td><td align="left" rowspan="1" colspan="1">97.4 (71.9)</td><td align="left" rowspan="1" colspan="1">93.9</td><td align="left" rowspan="1" colspan="1">96.6 (61.0)</td><td align="left" rowspan="1" colspan="1">95.0</td></tr><tr><td align="left" rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;<italic>B.pseudomallei K96243 chr.2</italic></td><td align="left" rowspan="1" colspan="1">68.5</td><td align="left" rowspan="1" colspan="1">2328</td><td align="left" rowspan="1" colspan="1">97.7 (70.3)</td><td align="left" rowspan="1" colspan="1">91.5</td><td align="left" rowspan="1" colspan="1">95.9 (62.1)</td><td align="left" rowspan="1" colspan="1">89.4</td></tr><tr><td align="left" rowspan="1" colspan="1">Average</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">95.3 (73.5)</td><td align="left" rowspan="1" colspan="1">94.0</td><td align="left" rowspan="1" colspan="1">96.4 (75.7)</td><td align="left" rowspan="1" colspan="1">93.6</td></tr></tbody></table><table-wrap-foot><fn><p>Sn: sensitivity, Sp: specificity, exact: only an exact match is treated as correct. Results of GeneMark.hmm were obtained using the web interface of the GeneMark program (version 2.4) with same length threshold as MetaGene. The only result of GeneMark.hmm for <italic>P.marinus</italic> was obtained from the RefSeq database of NCBI.</p></fn></table-wrap-foot></table-wrap><table-wrap id="tbl2" position="float"><label>Table 2</label><caption><p>Prediction accuracies of MetaGene on artificial shotgun sequences (700 bp long)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="1" colspan="1">Organisms</th><th align="left" rowspan="1" colspan="1">Sensitivity (%) (exact)</th><th align="left" rowspan="1" colspan="1">Specificity (%)</th><th align="left" rowspan="1" colspan="1">Correct domain (%)</th></tr></thead><tbody><tr><td colspan="4" align="left" rowspan="1">Archaea</td></tr><tr><td align="left" rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;<italic>M.jannaschii DSM 2661</italic></td><td align="left" rowspan="1" colspan="1">97.8 (82.4)</td><td align="left" rowspan="1" colspan="1">94.1</td><td align="left" rowspan="1" colspan="1">70.2</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>&#x02003;&#x02003;&#x02003;&#x02003;A.fulgidus DSM 4304</italic></td><td align="left" rowspan="1" colspan="1">95.8 (81.5)</td><td align="left" rowspan="1" colspan="1">93.7</td><td align="left" rowspan="1" colspan="1">99.3</td></tr><tr><td align="left" rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;<italic>N.pharaonis DSM 2160</italic></td><td align="left" rowspan="1" colspan="1">97.1 (86.2)</td><td align="left" rowspan="1" colspan="1">93.0</td><td align="left" rowspan="1" colspan="1">80.8</td></tr><tr><td colspan="4" align="left" rowspan="1">Bacteria</td></tr><tr><td align="left" rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;<italic>B.aphidicola str. APS</italic></td><td align="left" rowspan="1" colspan="1">98.2 (90.9)</td><td align="left" rowspan="1" colspan="1">92.7</td><td align="left" rowspan="1" colspan="1">98.6</td></tr><tr><td align="left" rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;<italic>P.marinus str. MIT 9312</italic></td><td align="left" rowspan="1" colspan="1">95.5 (87.6)</td><td align="left" rowspan="1" colspan="1">92.7</td><td align="left" rowspan="1" colspan="1">90.9</td></tr><tr><td align="left" rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;<italic>W.endosymbiont strain TRS</italic></td><td align="left" rowspan="1" colspan="1">93.1 (80.8)</td><td align="left" rowspan="1" colspan="1">76.0</td><td align="left" rowspan="1" colspan="1">72.8</td></tr><tr><td align="left" rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;<italic>H.pylori J99</italic></td><td align="left" rowspan="1" colspan="1">92.6 (77.7)</td><td align="left" rowspan="1" colspan="1">92.7</td><td align="left" rowspan="1" colspan="1">95.1</td></tr><tr><td align="left" rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;<italic>B.subtilis subsp. subtilis str. 168</italic></td><td align="left" rowspan="1" colspan="1">92.3 (73.5)</td><td align="left" rowspan="1" colspan="1">92.5</td><td align="left" rowspan="1" colspan="1">92.9</td></tr><tr><td align="left" rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;<italic>E.coli K12</italic></td><td align="left" rowspan="1" colspan="1">95.3 (81.2)</td><td align="left" rowspan="1" colspan="1">93.2</td><td align="left" rowspan="1" colspan="1">97.9</td></tr><tr><td align="left" rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;<italic>C.tepidum TLS</italic></td><td align="left" rowspan="1" colspan="1">88.1 (73.2)</td><td align="left" rowspan="1" colspan="1">89.6</td><td align="left" rowspan="1" colspan="1">78.4</td></tr><tr><td align="left" rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;<italic>C.jeikeium K411</italic></td><td align="left" rowspan="1" colspan="1">94.0 (78.5)</td><td align="left" rowspan="1" colspan="1">91.4</td><td align="left" rowspan="1" colspan="1">85.8</td></tr><tr><td align="left" rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;<italic>B.pseudomallei K96243 chr.1</italic></td><td align="left" rowspan="1" colspan="1">96.8 (81.2)</td><td align="left" rowspan="1" colspan="1">87.9</td><td align="left" rowspan="1" colspan="1">93.3</td></tr><tr><td align="left" rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;<italic>B.pseudomallei K96243 chr.2</italic></td><td align="left" rowspan="1" colspan="1">96.6 (80.5)</td><td align="left" rowspan="1" colspan="1">85.7</td><td align="left" rowspan="1" colspan="1">93.0</td></tr><tr><td align="left" rowspan="1" colspan="1">Average</td><td align="left" rowspan="1" colspan="1">94.9 (81.2)</td><td align="left" rowspan="1" colspan="1">90.4</td><td align="left" rowspan="1" colspan="1">88.4</td></tr></tbody></table></table-wrap><table-wrap id="tbl3" position="float"><label>Table 3</label><caption><p>Effectiveness of the measures integrated in MetaGene</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="1" colspan="1">Prediction models</th><th align="left" rowspan="1" colspan="1">Sensitivity (exact)</th><th align="left" rowspan="1" colspan="1">Specificity</th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">MetaGene (original)</td><td align="left" rowspan="1" colspan="1">94.9 (81.2)</td><td align="left" rowspan="1" colspan="1">90.4</td></tr><tr><td align="left" rowspan="1" colspan="1">ORF model</td><td align="left" rowspan="1" colspan="1">94.8 (79.7)</td><td align="left" rowspan="1" colspan="1">88.3</td></tr><tr><td align="left" rowspan="1" colspan="1">Di-codon model</td><td align="left" rowspan="1" colspan="1">94.0 (70.0)</td><td align="left" rowspan="1" colspan="1">86.7</td></tr><tr><td align="left" rowspan="1" colspan="1">Mono-codon model</td><td align="left" rowspan="1" colspan="1">93.8 (67.7)</td><td align="left" rowspan="1" colspan="1">84.3</td></tr></tbody></table></table-wrap></sec></back></article>







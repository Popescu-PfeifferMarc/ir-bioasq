<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id><journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id><journal-id journal-id-type="pmc">nar</journal-id><journal-id journal-id-type="publisher-id">Nucleic Acids Research</journal-id><journal-title-group><journal-title>Nucleic Acids Research</journal-title></journal-title-group><issn pub-type="ppub">0305-1048</issn><issn pub-type="epub">1362-4962</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">17182633</article-id><article-id pub-id-type="pmc">PMC1802605</article-id><article-id pub-id-type="doi">10.1093/nar/gkl1063</article-id><article-categories><subj-group subj-group-type="heading"><subject>Computational Biology</subject></subj-group></article-categories><title-group><article-title>Dynamic use of multiple parameter sets in sequence alignment</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Huang</surname><given-names>Xiaoqiu</given-names></name><xref ref-type="corresp" rid="cor1">*</xref></contrib><contrib contrib-type="author"><name><surname>Brutlag</surname><given-names>Douglas L.</given-names></name><xref ref-type="aff" rid="au1">1</xref></contrib><aff><institution>Department of Computer Science, Iowa State University</institution><addr-line>Ames, IA 50011-1040, USA</addr-line></aff><aff id="au1"><sup>1</sup><institution>Department of Biochemistry, Stanford University School of Medicine</institution><addr-line>Stanford, CA 94305-5307, USA</addr-line></aff></contrib-group><author-notes><corresp id="cor1"><sup>*</sup>To whom correspondence should be addressed: Tel: +1 515 294 2432; Fax: +1 515 294 0258; Email: <email>xqhuang@cs.iastate.edu</email>.</corresp></author-notes><pub-date pub-type="ppub"><month>1</month><year>2007</year></pub-date><pub-date pub-type="epub"><day>19</day><month>12</month><year>2006</year></pub-date><pub-date pub-type="pmc-release"><day>19</day><month>12</month><year>2006</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. --><volume>35</volume><issue>2</issue><fpage>678</fpage><lpage>686</lpage><history><date date-type="received"><day>22</day><month>6</month><year>2006</year></date><date date-type="rev-recd"><day>17</day><month>11</month><year>2006</year></date><date date-type="accepted"><day>20</day><month>11</month><year>2006</year></date></history><permissions><copyright-statement>&#x000a9; 2006 The Author(s).</copyright-statement><copyright-year>2006</copyright-year><license license-type="openaccess"><license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><abstract><p>The level of conservation between two homologous sequences often varies among sequence regions; functionally important domains are more conserved than the remaining regions. Thus, multiple parameter sets should be used in alignment of homologous sequences with a stringent parameter set for highly conserved regions and a moderate parameter set for weakly conserved regions. We describe an alignment algorithm to allow dynamic use of multiple parameter sets with different levels of stringency in computation of an optimal alignment of two sequences. The algorithm dynamically considers various candidate alignments, partitions each candidate alignment into sections, and determines the most appropriate set of parameter values for each section of the alignment. The algorithm and its local alignment version are implemented in a computer program named GAP4. The local alignment algorithm in GAP4, that in its predecessor GAP3, and an ordinary local alignment program SIM were evaluated on 257&#x02009;716 pairs of homologous sequences from 100 protein families. On 168&#x02009;475 of the 257&#x02009;716 pairs (a rate of 65.4%), alignments from GAP4 were more statistically significant than alignments from GAP3 and SIM.</p></abstract></article-meta></front><body><sec><title>INTRODUCTION</title><p>Sequence alignment programs are tremendously useful in analysis of DNA and protein sequences (<xref ref-type="bibr" rid="b1">1</xref>&#x02013;<xref ref-type="bibr" rid="b10">10</xref>). Those programs are efficient variations of alignment algorithms that produce an optimal global alignment of two sequences or an optimal local alignment between two sequences under a given set of parameter values (<xref ref-type="bibr" rid="b11">11</xref>&#x02013;<xref ref-type="bibr" rid="b19">19</xref>). An alignment algorithm can be run multiple times, each with a different set of parameter values, and a set of parameter values that leads to a largest-scoring alignment is selected along with the alignment (<xref ref-type="bibr" rid="b20">20</xref>,<xref ref-type="bibr" rid="b21">21</xref>). Algorithms based on Bayesian statistics are recently developed to compute the posterior distribution of all alignments over several sets of parameter values, where every alignment is scored by using each of the parameter sets (<xref ref-type="bibr" rid="b22">22</xref>&#x02013;<xref ref-type="bibr" rid="b24">24</xref>).</p><p>The level of conservation between two homologous sequences often varies among sequence regions; functionally important domains are more conserved than the remaining regions. Thus, any one set of parameter values may not be the most appropriate one for all sequence regions. A stringent set of parameter values should be used for a highly conserved region, whereas a moderate set of parameter values should be used for a weakly conserved region.</p><p>We present a global alignment model that uses sets of parameter values with different levels of stringency to address sequences with different levels of conservation among regions. We design a dynamic programming algorithm for computing an optimal alignment of two sequences with proper assignment of a parameter set to each section of the alignment. For two sequences of lengths <italic>m</italic> and <italic>n</italic>, and <italic>p</italic> parameter sets, the algorithm runs in time proportional to <italic>pmn</italic>, and in space proportional to <italic>p</italic>(<italic>m</italic>+<italic>n</italic>). The algorithm is implemented in a computer program named GAP4 (Global Alignment Program Version 4). We also describe changes to the global alignment algorithm to produce a local alignment algorithm with the dynamic use of multiple parameter sets. The local alignment algorithm is also available in GAP4 as an option.</p><p>The local alignment algorithm in GAP4, the local alignment algorithm in its predecessor GAP3 (<xref ref-type="bibr" rid="b19">19</xref>), and an ordinary local alignment program SIM (<xref ref-type="bibr" rid="b17">17</xref>) were evaluated on 257&#x02009;716 pairs of homologous sequences from 100 protein families. On 168&#x02009;475 of the 257&#x02009;716 pairs (a rate of 65.4%), alignments from GAP4 were more statistically significant than alignments from GAP3 and SIM. The results show that the dynamic use of multiple parameter sets is more effective than the static use of each parameter set. In addition, every alignment from GAP4 contains annotations of conservation level. Results from a motif finding program on five pairs of protein sequences show that many motifs are located in highly conserved regions found by GAP4.</p><p>Our algorithm goes one step further than the existing alignment algorithms that use multiple parameter sets. Every existing alignment algorithm selects a parameter set at the alignment level, where every alignment is scored by using each parameter set alone, and a parameter set that yields a largest-scoring alignment is selected. All sections of the largest-scoring alignment are scored with the selected parameter set. Our algorithm, on the other hand, selects a parameter set at the section level. The algorithm uses multiple parameter sets to score each candidate alignment simultaneously. For every section of the candidate alignment, a parameter set that yields the maximum score for the section is selected for the section. An alignment produced by the algorithm is optimal in partition of the alignment into sections, and in selection of a largest-scoring parameter set for each section.</p></sec><sec sec-type="materials|methods"><title>MATERIALS AND METHODS</title><p>We first define a global alignment model and present a dynamic programming algorithm for computing the score of an optimal alignment. Then we describe a space-efficient algorithm for computing an optimal alignment of two sequences. Next we show how to compute an optimal local alignment between two sequences.</p><sec><title>Alignment model</title><p>We define a global alignment model to handle sequences with different levels of conservation among regions. Let <italic>A</italic> = <italic>a</italic><sub>1</sub><italic>a</italic><sub>2</sub>&#x02009;&#x02026;&#x02009;<italic>a</italic><sub>m</sub> and <italic>B</italic> = <italic>b</italic><sub>1</sub><italic>b</italic><sub>2</sub>&#x02009;&#x02026;&#x02009;<italic>b</italic><sub>n</sub> be two sequences of lengths <italic>m</italic> and <italic>n</italic>. A global alignment of <italic>A</italic> and <italic>B</italic> consists of three types of configurations: substitutions, gaps, and difference blocks. A substitution associates a residue of <italic>A</italic> with a residue of <italic>B</italic>. A gap consists only of residues from one sequence with each residue associated with the symbol &#x02212;. There are two kinds of gaps. A deletion gap with respect to sequence <italic>A</italic> consists only of residues from <italic>A</italic> and an insertion gap with respect to sequence <italic>A</italic> consists only of residues from <italic>B</italic>. A difference block consists of residues from one or two sequences with each residue associated with the symbol + (<xref ref-type="bibr" rid="b19">19</xref>). There are three types of difference blocks. A difference block of type 1 consists only of residues from <italic>A</italic>, a difference block of type 2 consists only of residues from <italic>B</italic>, and a difference block of type 3 consists of residues from both <italic>A</italic> and <italic>B</italic>.</p><p>Parameter value sets with different levels of stringency are used to score alignments. Let <italic>p</italic> be the number of parameter sets. For each <italic>k</italic> between 1 and <italic>p</italic>, let &#x0003c; &#x003c3;<sub>k</sub>, <italic>q</italic><sub>k</sub>, <italic>r</italic><sub>k</sub>, <italic>d</italic><sub>k</sub>, <italic>c</italic><sub>k</sub>&#x0003e; denote parameter set <italic>k</italic>, where &#x003c3;<sub>k</sub> is a substitution matrix, nonnegative number <italic>q</italic><sub>k</sub> is a gap-open penalty, nonnegative number <italic>r</italic><sub>k</sub> is a gap-extension penalty, nonnegative number <italic>d</italic><sub>k</sub> is a difference block penalty and nonnegative number <italic>c</italic><sub>k</sub> is a parameter set change penalty. If a configuration of an alignment is mapped to parameter set <italic>k</italic>, then the score of the configuration is calculated by using parameter set <italic>k</italic>. For example, &#x003c3;<sub>k</sub>(<italic>a</italic>,<italic>b</italic>) is the score of a substitution involving residues <italic>a</italic> and <italic>b</italic> that is mapped to parameter set <italic>k</italic>, the score of a gap of length <italic>l</italic> mapped to parameter set <italic>k</italic> is &#x02212;(<italic>q</italic><sub>k</sub> + <italic>l</italic> &#x000d7; <italic>r</italic><sub>k</sub>), and the score of a difference block mapped to parameter set <italic>k</italic> is &#x02212; <italic>d</italic><sub>k</sub>. We require that adjacent difference blocks be combined into one difference block that can be mapped to only one parameter set. The same requirement is also placed on adjacent deletion gaps and adjacent insertion gaps. In addition, a difference block and a gap that are adjacent to each other are combined into a larger difference block, which results in no loss of score.</p><p>An alignment is mapped to the parameter sets if each configuration of the alignment is mapped to one of the parameter sets. A section of a mapped alignment is a largest part of consecutive configurations that are mapped to the same parameter set. The parameter set change score of a section mapped to parameter set <italic>k</italic> is &#x02212;<italic>c<sub>k</sub></italic>. The score of a mapped alignment is the sum of scores of each mapped substitution, each mapped gap, and each mapped difference block in the alignment, plus the sum of parameter set change scores of each mapped section in the alignment. As an example, an initial part of a mapped alignment is shown in <xref ref-type="fig" rid="fig1">Figure 1</xref>. An optimal mapped alignment has the maximum score of all mapped alignments.</p><fig id="fig1" position="float"><label>Figure 1</label><caption><p>An initial part of a global alignment from GAP4 on two protein sequences (SwissProt accession nos Q9NTI2 and Q9Y2G3). A difference block is indicated by the plus sign +. Each column of the alignment is marked with one of the three letters: l, m and h, which indicates one of the three parameter sets used to score the column.</p></caption><graphic xlink:href="gkl1063f1"/></fig><p>We develop a dynamic programming algorithm for computing an optimal mapped alignment of <italic>A</italic> and <italic>B</italic>. Let <italic>A</italic><sub><italic>i</italic></sub> = <italic>a</italic><sub>1</sub><italic>a</italic><sub>2</sub>&#x02009;&#x02026;&#x02009;<italic>a</italic><sub><italic>i</italic></sub> and <italic>B</italic><sub><italic>j</italic></sub> = <italic>b</italic><sub>1</sub><italic>b</italic><sub>2</sub>&#x02026;&#x02009;<italic>b</italic><sub><italic>j</italic></sub> be initial segments of lengths <italic>i</italic> and <italic>j</italic> of <italic>A</italic> and <italic>B</italic>. Define <italic>Z</italic>(<italic>i, j</italic>) to be the maximum score of mapped alignments of <italic>A</italic><sub><italic>i</italic></sub> and <italic>B</italic><sub><italic>j</italic></sub>. Then <italic>Z</italic>(<italic>m, n</italic>) is the score of an optimal mapped alignment of <italic>A</italic> and <italic>B</italic>. For each <italic>k</italic> with 1 &#x02264; <italic>k</italic> &#x02264; <italic>p</italic>, define <italic>S<sub>k</sub></italic>(<italic>i, j</italic>) to be the maximum score of mapped alignments of <italic>A</italic><sub><italic>i</italic></sub> and <italic>B</italic><sub><italic>j</italic></sub> that end with a configuration mapped to parameter set <italic>k</italic>. Then <italic>Z</italic>(<italic>i</italic>, <italic>j</italic>) is the maximum score of <italic>S</italic><sub><italic>k</italic></sub>(<italic>i</italic>, <italic>j</italic>) for each <italic>k</italic> with 1 &#x02264; <italic>k</italic> &#x02264; <italic>p</italic>. For each <italic>k</italic> with 1 &#x02264; <italic>k</italic> &#x02264; <italic>p</italic>, to compute the matrix <italic>S</italic><sub><italic>k</italic></sub> efficiently, three additional matrices are introduced. Define <italic>H</italic><sub><italic>k</italic></sub>(<italic>i</italic>, <italic>j</italic>) to be the maximum score of mapped alignments of <italic>A</italic><sub><italic>i</italic></sub> and <italic>B</italic><sub><italic>j</italic></sub> that end with a difference block mapped to parameter set <italic>k</italic>. Similarly, define <italic>D</italic><sub><italic>k</italic></sub>(<italic>i</italic>, <italic>j</italic>) for mapped alignments that end with a deletion gap mapped to parameter set <italic>k</italic> and <italic>I</italic><sub><italic>k</italic></sub>(<italic>i</italic>, <italic>j</italic>) for mapped alignments that end with an insertion gap mapped to parameter set <italic>k</italic>. The following recurrences for computing the matrices are derived from the definitions of the matrices. Assume that any expression with &#x02212;&#x0221e; is less than any expression without it.
<disp-formula><mml:math id="M1"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="M2"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mo>{</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>|</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>p</mml:mi><mml:mo>}</mml:mo><mml:mo>&#x02003;</mml:mo><mml:mtext>for</mml:mtext><mml:mo>&#x02003;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn><mml:mo>&#x02003;</mml:mo><mml:mtext>or</mml:mtext><mml:mo>&#x02003;</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="M3"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>Z</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="M4"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mo>{</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>}</mml:mo><mml:mo>&#x02003;</mml:mo><mml:mtext>for</mml:mtext><mml:mo>&#x02003;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="M5"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mo>{</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>}</mml:mo><mml:mo>&#x02003;</mml:mo><mml:mtext>for</mml:mtext><mml:mo>&#x02003;</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><graphic xlink:href="gkl1063e1"/></disp-formula>
<disp-formula><mml:math id="M6"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="M7"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi>&#x0221e;</mml:mi><mml:mo>&#x02003;</mml:mo><mml:mtext>for</mml:mtext><mml:mo>&#x02003;</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>
<disp-formula><mml:math id="M8"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x02003;</mml:mo><mml:mtext>for</mml:mtext><mml:mo>&#x02003;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><graphic xlink:href="gkl1063e2"/></disp-formula>
<disp-formula><mml:math id="M9"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="M10"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi>&#x0221e;</mml:mi><mml:mo>&#x02003;</mml:mo><mml:mtext>for</mml:mtext><mml:mo>&#x02003;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="M11"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x02003;</mml:mo><mml:mtext>for</mml:mtext><mml:mo>&#x02003;</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><graphic xlink:href="gkl1063e3"/></disp-formula>
<disp-formula><mml:math id="M12"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="M13"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>&#x02003;</mml:mo><mml:mtext>for</mml:mtext><mml:mo>&#x02003;</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="M14"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>&#x02003;</mml:mo><mml:mtext>for</mml:mtext><mml:mo>&#x02003;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>
<disp-formula><graphic xlink:href="gkl1063e4"/></disp-formula>
</p><p>In Supplementary Data, we justify the recurrences for the matrix <italic>S<sub>k</sub></italic> and for the matrix <italic>D<sub>k</sub></italic> for any <italic>k</italic> with 1 &#x02264; <italic>k</italic> &#x02264; <italic>p</italic>. The matrices are computed according to the recurrences in order of rows. The computation is performed by saving only the most recent row of each matrix. This is possible because each of the matrices observes the property that the score at an entry depends only on scores at its neighbor entries. For each entry (<italic>i</italic>,&#x02009;<italic>j</italic>), it takes time proportional to <italic>p</italic> to compute all matrix scores at the entry; it takes time proportional to <italic>p</italic> to compute <italic>Z</italic>(<italic>i,&#x02009;j</italic>), and for each <italic>k</italic> from 1 to <italic>p</italic>, it takes constant time to compute each of <italic>S<sub>k</sub></italic>(<italic>i</italic>,&#x02009;<italic>j</italic>), <italic>D<sub>k</sub></italic>(<italic>i</italic>,&#x02009;<italic>j</italic>), <italic>I<sub>k</sub></italic>(<italic>i,&#x02009;j</italic>) and <italic>H<sub>k</sub></italic>(<italic>i</italic>,&#x02009;<italic>j</italic>). An optimal mapped alignment is computed in linear space by an algorithm described in the next subsection.</p></sec><sec><title>Algorithm</title><p>We develop a space-efficient algorithm for computing an optimal mapped alignment of <italic>A</italic> and <italic>B</italic>. A divide-conquer technique is developed by Hirschberg (<xref ref-type="bibr" rid="b25">25</xref>) for computing a longest common subsequence of two sequences. The Hirschberg technique is applied to global alignment models (<xref ref-type="bibr" rid="b15">15</xref>,<xref ref-type="bibr" rid="b19">19</xref>,<xref ref-type="bibr" rid="b26">26</xref>,<xref ref-type="bibr" rid="b27">27</xref>). Here the Hirschberg technique is applied to the new alignment model. The main idea of the space-efficient algorithm is to determine a middle pair of positions on an optimal mapped alignment in linear space. Then the portions of the optimal mapped alignment before and after the middle pair of positions are constructed recursively. Let <italic>imid</italic> be &#x0230a;<italic>m</italic> / 2&#x0230b;, where &#x0230a;<italic>y</italic>&#x0230b; is the largest integer less than or equal to <italic>y</italic>. We first consider a procedure for finding a position <italic>jmid</italic> such that the pair of positions <italic>imid</italic> and <italic>jmid</italic> is on an optimal mapped alignment of <italic>A</italic> and <italic>B</italic>.</p><p>Partition the mapped alignments of <italic>A</italic> and <italic>B</italic> into four groups. Group 1 consists of mapped alignments with a difference block containing a residue <italic>a</italic> at position <italic>imid</italic> of <italic>A</italic> and another residue immediately to the right of <italic>a</italic>. In other words, a mapped alignment is in group 1 if, upon splitting the alignment into two parts immediately after the residue <italic>a</italic>, the first part ends with a difference block mapped to a parameter set and the second part begins with a difference block mapped to the same parameter set. Group 2 consists of mapped alignments with a deletion gap containing residues at positions <italic>imid</italic> and <italic>imid</italic> + 1 of <italic>A</italic>, with the deletion gap mapped to a parameter set. Group 3 consists of mapped alignments with a substitution involving a residue at position <italic>imid</italic> of <italic>A</italic>, with the substitution and the configuration immediately to its right mapped to the same parameter set. Group 4 consists of all the remaining mapped alignments. Note that a residue at position <italic>imid</italic> of <italic>A</italic> can not be inside any insertion gap and hence that there is no need to consider this case. We consider computing the score of and a middle pair of positions on a largest-scoring mapped alignment in each group.</p><p>Let <italic>R</italic>(<italic>A</italic>,<italic>B</italic>) denote a largest-scoring mapped alignment of <italic>A</italic> and <italic>B</italic> in group 1. Split <italic>R</italic>(<italic>A</italic>,<italic>B</italic>) into two parts immediately after position <italic>imid</italic> of <italic>A</italic>. Let <italic>jh</italic> be the largest position of <italic>B</italic> in the first part. Let <inline-formula><mml:math id="M15"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> denote the suffix <italic>a</italic><sub><italic>i</italic>+1</sub><italic>a</italic><sub><italic>i</italic>+2</sub>&#x02009;&#x02026;&#x02009;<italic>a<sub>m</sub></italic> of <italic>A</italic>. Notation <inline-formula><mml:math id="M16"><mml:mrow><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> is similarly defined. Then the first part of <italic>R</italic>(<italic>A,B</italic>) is an alignment, denoted by <italic>R</italic><sub>1</sub>(<italic>A<sub>imid</sub></italic>, <italic>B<sub>jh</sub></italic>), of <italic>A<sub>imid</sub></italic> and <italic>B<sub>jh</sub></italic> and the second part is an alignment, denoted by <inline-formula><mml:math id="M17"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>(</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>h</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>, of <inline-formula><mml:math id="M18"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M19"><mml:mrow><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>h</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>. Note that for some <italic>k</italic> with 1 &#x02264; <italic>k</italic> &#x02264; <italic>p</italic>, <italic>R</italic><sub>1</sub>(<italic>A<sub>imid</sub></italic>,<italic>B<sub>jh</sub></italic>) ends with a difference block mapped to parameter set <italic>k</italic> and that <inline-formula><mml:math id="M20"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>(</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>h</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> begins with a difference block mapped to parameter set <italic>k</italic>. Define <inline-formula><mml:math id="M21"><mml:msub><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula>(<italic>i</italic>,<italic>j</italic>) to be the maximum score of mapped alignments of <inline-formula><mml:math id="M22"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M23"><mml:mrow><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> that begin with a difference block mapped to parameter set <italic>k</italic>. It follows from the definition of <italic>R</italic>(<italic>A</italic>,<italic>B</italic>) that the score of <italic>R</italic><sub>1</sub>(<italic>A<sub>imid</sub></italic>,<italic>B<sub>jh</sub></italic>) is <italic>H<sub>k</sub></italic>(<italic>imid,jh</italic>) and the score of <inline-formula><mml:math id="M24"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>(</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>h</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> is <inline-formula><mml:math id="M25"><mml:msub><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula>(<italic>imid,jh</italic>). Moreover, the score of <italic>R</italic>(<italic>A</italic>,<italic>B</italic>), denoted by <italic>hk</italic>, is
<disp-formula><mml:math id="M26"><mml:mrow><mml:mi>h</mml:mi><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mi>h</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mi>h</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where including the terms <italic>d<sub>k</sub></italic> and <italic>c<sub>k</sub></italic> on the right-hand side ensures that the mapped difference block containing a residue at position <italic>imid</italic> of <italic>A</italic> is charged for difference block penalty exactly once and the section containing the mapped difference block is charged for parameter set change penalty exactly once. Observe that for each <italic>k</italic> with 1 &#x02264; <italic>k</italic> &#x02264; <italic>p</italic> and each <italic>j</italic> with 0 &#x02264; <italic>j</italic> &#x02264; <italic>n</italic>, <italic>H<sub>k</sub></italic>(<italic>imid</italic>,&#x02009;<italic>j</italic>) + <inline-formula><mml:math id="M27"><mml:msub><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula>(<italic>imid</italic>,&#x02009;<italic>j</italic>) + <italic>d<sub>k</sub></italic> + <italic>c<sub>k</sub></italic> is the score of a mapped alignment of <italic>A</italic> and <italic>B</italic> in group 1. Combining the observations together, we obtain
<disp-formula><mml:math id="M28"><mml:mrow><mml:mi>h</mml:mi><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mo>{</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x02003;</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mtext>&#x02009;</mml:mtext><mml:mo>|</mml:mo><mml:mtext>&#x02009;</mml:mtext><mml:mn>1</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>n</mml:mi><mml:mo>}</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
Note that <italic>jh</italic> is a position <italic>j</italic> at which the maximum score <italic>hk</italic> is obtained. Thus, the score of and a middle pair of positions on a largest-scoring mapped alignment in group 1 can be obtained using middle rows of the matrices <italic>H<sub>k</sub></italic> and <inline-formula><mml:math id="M29"><mml:msub><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula>.</p><p>The score of and a middle pair of positions on a largest-scoring mapped alignment in group 2 and those in groups 3 and 4 can be obtained similarly. Define <inline-formula><mml:math id="M30"><mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula>(<italic>i</italic>,&#x02009;<italic>j</italic>) to be the maximum score of mapped alignments of <inline-formula><mml:math id="M31"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M32"><mml:mrow><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> that begin with a deletion gap mapped to parameter set <italic>k</italic>. Define <inline-formula><mml:math id="M33"><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula>(<italic>i,j</italic>) to be the maximum score of mapped alignments of <inline-formula><mml:math id="M34"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M35"><mml:mrow><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> that begin with a configuration mapped to parameter set <italic>k</italic>. Define <inline-formula><mml:math id="M36"><mml:mrow><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> to be the maximum score of mapped alignments of <inline-formula><mml:math id="M37"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M38"><mml:mrow><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>. Then the score of a largest-scoring alignment in group 2, denoted by <italic>df</italic>, is
<disp-formula><mml:math id="M39"><mml:mrow><mml:mi>d</mml:mi><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mo>{</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x02003;</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mtext>&#x02009;</mml:mtext><mml:mo>|</mml:mo><mml:mtext>&#x02009;</mml:mtext><mml:mn>1</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>n</mml:mi><mml:mo>}</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
Let <italic>jd</italic> be a position <italic>j</italic> at which the maximum score <italic>df</italic> is obtained. Then (<italic>imid</italic>,&#x02009;<italic>jd</italic>) is a middle pair of positions on a largest-scoring alignment in group 2.</p><p>In group 3, the score of a largest-scoring alignment, denoted by <italic>st</italic>, is
<disp-formula><mml:math id="M40"><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mo>{</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>&#x02003;</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mtext>&#x02009;</mml:mtext><mml:mo>|</mml:mo><mml:mtext>&#x02009;</mml:mtext><mml:mn>1</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>n</mml:mi><mml:mo>}</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
Let <italic>js</italic> be a position <italic>j</italic> at which the maximum score <italic>st</italic> is obtained. Then (<italic>imid</italic>,&#x02009;<italic>js</italic>) is a middle pair of positions on a largest-scoring alignment in group 3.</p><p>In group 4, the score of a largest-scoring alignment, denoted by <italic>zy</italic>, is
<disp-formula><mml:math id="M41"><mml:mrow><mml:mi>z</mml:mi><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mo>{</mml:mo><mml:mi>Z</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mtext>&#x02009;</mml:mtext><mml:mo>|</mml:mo><mml:mtext>&#x02009;</mml:mtext><mml:mn>0</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>n</mml:mi><mml:mo>}</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
Let <italic>jz</italic> be a position <italic>j</italic> at which the maximum score <italic>zy</italic> is obtained. Then (<italic>imid</italic>,&#x02009;<italic>jz</italic>) is a middle pair of positions on a largest-scoring alignment in group 4.</p><p>The recurrences for computing the matrices <inline-formula><mml:math id="M42"><mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M43"><mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M44"><mml:msub><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M45"><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="M46"><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math></inline-formula> are developed in the same way as those for <italic>D<sub>k</sub></italic>, <italic>I<sub>k</sub></italic>, <italic>H<sub>k</sub></italic>, <italic>S<sub>k</sub></italic> and <italic>Z</italic>. The score of an optimal mapped alignment of <italic>A</italic> and <italic>B</italic> is max{<italic>df</italic>,&#x02009;<italic>hk</italic>,&#x02009;<italic>st</italic>,&#x02009;<italic>zy</italic>}. Let <italic>jmid</italic> be the corresponding one of <italic>jd</italic>, <italic>jh</italic>, <italic>js</italic> and <italic>jz</italic>. Then the pair of positions <italic>imid</italic> and <italic>jmid</italic> is on an optimal mapped alignment of <italic>A</italic> and <italic>B</italic>.</p><p>An algorithm for computing an optimal mapped alignment of <italic>A</italic> and <italic>B</italic> in linear space consists of the following steps. If <italic>m</italic> is small enough, compute an optimal mapped alignment of <italic>A</italic> and <italic>B</italic> using a traceback procedure. Otherwise, determine a pair of positions <italic>imid</italic> and <italic>jmid</italic> on an optimal mapped alignment of <italic>A</italic> and <italic>B</italic>, and recursively compute the portions of the alignment before and after the pair of positions.</p><p>The positions <italic>imid</italic> and <italic>jmid</italic> are determined as follows. Set <italic>imid</italic> = &#x0230a;<italic>m</italic>/2&#x0230b;. Compute the matrices <italic>D<sub>k</sub></italic>, <italic>I<sub>k</sub></italic>, <italic>H<sub>k</sub></italic> and <italic>S<sub>k</sub></italic>, 1 &#x02264; <italic>k</italic> &#x02264; <italic>p</italic>, and the matrix <italic>Z</italic> from row 0 to row <italic>imid</italic>, and save <italic>D<sub>k</sub></italic>(<italic>imid</italic>,&#x02009;<italic>j</italic>), <italic>H<sub>k</sub></italic>(<italic>imid</italic>,&#x02009;<italic>j</italic>), <italic>S<sub>k</sub></italic>(<italic>imid</italic>,&#x02009;<italic>j</italic>) and <italic>Z</italic>(<italic>imid</italic>,&#x02009;<italic>j</italic>) for 0 &#x02264; <italic>j</italic> &#x02264; <italic>n</italic>. Compute the matrices <inline-formula><mml:math id="M47"><mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M48"><mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M49"><mml:msub><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="M50"><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula>, 1 &#x02264; <italic>k</italic> &#x02264; <italic>p</italic>, and the matrix <inline-formula><mml:math id="M51"><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math></inline-formula> from row <italic>m</italic> down to row <italic>imid</italic>, and save <inline-formula><mml:math id="M52"><mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula>(<italic>imid</italic>,&#x02009;<italic>j</italic>), <inline-formula><mml:math id="M53"><mml:msub><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula>(<italic>imid</italic>,&#x02009;<italic>j</italic>), <inline-formula><mml:math id="M54"><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula>(<italic>imid</italic>,&#x02009;<italic>j</italic>) and <inline-formula><mml:math id="M55"><mml:mrow><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> for 0 &#x02264; <italic>j</italic> &#x02264; <italic>n</italic>. Compute the values <italic>df</italic>, <italic>hk</italic>, <italic>st</italic> and <italic>zy</italic>. Let <italic>jd</italic> be a position at which the maximum score <italic>df</italic> is obtained, <italic>jh</italic> a position at which the maximum score <italic>hk</italic> is obtained, <italic>js</italic> a position at which the maximum score <italic>st</italic> is obtained and <italic>jz</italic> a position at which the maximum score <italic>zy</italic> is obtained. If <italic>df</italic> &#x0003e; <italic>hk</italic>, <italic>df</italic> &#x0003e; <italic>st</italic>, and <italic>df</italic> &#x0003e; <italic>zy</italic>, then set <italic>jmid</italic> = <italic>jd</italic>. Otherwise, if <italic>hk</italic> &#x0003e; <italic>df</italic>, <italic>hk</italic> &#x0003e; <italic>st</italic> and <italic>hk</italic> &#x0003e; <italic>zy</italic>, then set <italic>jmid</italic> = <italic>jh</italic>. Otherwise, if <italic>st</italic> &#x0003e; <italic>df</italic>, <italic>st</italic> &#x0003e; <italic>hk</italic> and <italic>st</italic> &#x0003e; <italic>zy</italic>, then set <italic>jmid</italic> = <italic>js</italic>. Otherwise, set <italic>jmid</italic> = <italic>jz</italic>.</p><p>It can be proved that for two sequences of lengths <italic>m</italic> and <italic>n</italic>, and <italic>p</italic> parameter sets, the algorithm runs in time proportional to <italic>pmn</italic>, and in space proportional to <italic>p</italic>(<italic>m</italic> + <italic>n</italic>). The proof is similar to one from Huang (<xref ref-type="bibr" rid="b28">28</xref>).</p><p>The algorithm presented above is for the simple scoring scheme where a parameter set change penalty is always charged even if the whole alignment is mapped to one parameter set. In a more realistic scoring scheme, no parameter set change penalty is charged for the first use of a parameter set. For any change from one parameter set to another parameter set, the change penalty for the second parameter set is charged. The realistic scoring scheme is implemented by using proper boundary values for the matrices and passing them as parameters to a recursive alignment procedure. Implementation details can be found in the source code of the GAP4 program.</p></sec><sec><title>Local alignment</title><p>A local mapped alignment between <italic>A</italic> and <italic>B</italic> is a mapped alignment of a region of <italic>A</italic> and a region of <italic>B</italic>. An optimal local mapped alignment between <italic>A</italic> and <italic>B</italic> is one with the maximum score. An optimal local mapped alignment between <italic>A</italic> and <italic>B</italic> is computed by applying the technique of Smith and Waterman (<xref ref-type="bibr" rid="b12">12</xref>) to the new alignment model. Specifically, the value zero is included in the recurrence for <italic>Z</italic>(<italic>i</italic>,&#x02009;<italic>j</italic>), and the term &#x003c3;<sub><italic>k</italic></sub>(<italic>a<sub>i</sub></italic>,<italic>b<sub>j</sub></italic>) is included in the recurrence for <italic>S<sub>k</sub></italic>(<italic>i</italic>,&#x02009;<italic>j</italic>). Thus, if <italic>Z</italic>(<italic>i</italic>&#x02212;1,&#x02009;<italic>j</italic>&#x02212;1) is less than <italic>c<sub>k</sub></italic>, then the term &#x003c3;<sub><italic>k</italic></sub>(<italic>a<sub>i</sub></italic>,<italic>b<sub>j</sub></italic>) is larger and hence better than the term <italic>Z</italic>(<italic>i</italic>&#x02212;1,&#x02009;<italic>j</italic>&#x02212;1)&#x02212;<italic>c<sub>k</sub></italic> + &#x003c3;<sub><italic>k</italic></sub>(<italic>a<sub>i</sub></italic>,<italic>b<sub>j</sub></italic>) for computing <italic>S<sub>k</sub></italic>(<italic>i</italic>,&#x02009;<italic>j</italic>). In other words, the change allows a local mapped alignment to start at every entry without charging any parameter set change penalty for the first mapped substitution of the alignment.</p><p>Let (<italic>ie</italic>,&#x02009;<italic>je</italic>) be an entry with the maximum score in the matrix <italic>Z</italic>. Then (<italic>ie</italic>,&#x02009;<italic>je</italic>) is the end point of an optimal local mapped alignment between <italic>A</italic> and <italic>B</italic>, and its score is <italic>Z</italic>(<italic>ie</italic>,&#x02009;<italic>je</italic>). The start point (<italic>is</italic>,&#x02009;<italic>js</italic>) of the optimal local mapped alignment is found by performing the computation in right-to-left order with initial segments <italic>A<sub>ie</sub></italic> and <italic>B<sub>je</sub></italic>, where (<italic>is</italic>,&#x02009;<italic>js</italic>) is an entry with the maximum score in the matrix. The optimal local mapped alignment is obtained by using the algorithm of the previous subsection to compute an optimal global mapped alignment of segments <italic>a</italic><sub><italic>is</italic>+1</sub>
<italic>a</italic><sub><italic>is</italic>+2</sub> &#x02026; <italic>a</italic><sub><italic>ie</italic></sub> and <italic>b</italic><sub><italic>js</italic>+1</sub>
<italic>b</italic><sub><italic>js</italic>+2</sub> &#x02026; <italic>b</italic><sub><italic>je</italic></sub>.</p></sec></sec><sec sec-type="results"><title>RESULTS</title><p>The new algorithms are implemented in a computer program named GAP4; the global alignment algorithm is available in GAP4 with the &#x02212;g 1 option (default), and the local alignment algorithm is available in GAP4 with the &#x02212;g 0 option. The GAP4 program can handle both DNA and protein sequences. The program takes as input two sequences in FASTA format and a file of parameter sets. Each line of the parameter file contains a complete set of parameter values in the following order: a single character for representing the parameter set on the alignment output, the name of a substitution matrix file, gap open penalty, gap extension penalty, difference block penalty, and parameter set change penalty.</p><p>We tested GAP4 on protein sequences with the following three sets of parameter values in the parameter file:
<list list-type="simple"><list-item><p>l BLOSUM45 12&#x02003;2 90 10</p></list-item><list-item><p>m BLOSUM62 14 3&#x02003;95 10</p></list-item><list-item><p>h BLOSUM100 16&#x02003;4 100 10</p></list-item></list></p><p>The BLOSUM62 matrix was selected as it is commonly used (<xref ref-type="bibr" rid="b29">29</xref>). The BLOSUM45 matrix was selected as its stringency level is sufficiently lower than that of BLOSUM62, whereas the BLOSUM100 matrix was selected as its stringency level is sufficiently higher than that of BLOSUM62. The three BLOSUM matrices were on the same scale of 1/3 bit units. The gap open and extension penalties in each parameter set were selected according to Pearson (<xref ref-type="bibr" rid="b30">30</xref>&#x02013;<xref ref-type="bibr" rid="b32">32</xref>). The difference block penalty in each parameter set was set to a value above the scores of similarity blocks between random sequences (<xref ref-type="bibr" rid="b19">19</xref>). The parameter set change penalty is new. We used various values between 1 and 15 for this parameter and found that using a value of 10 keeps a balance between too frequent changes and no changes in use of parameter sets. The value 10 was also selected in another test given below to assess the effect of the parameter set change penalty on the statistical significance of alignments from GAP4.</p><p>The three sets of parameter values have low, medium and high levels of stringency, as represented by the three letters l, m and h. The low parameter set is often best for scoring regions with percent identity &#x0223c;20%, the medium parameter set for scoring regions with percent identity &#x0223c;30% and the high parameter set for scoring regions with percent identity &#x0003e;45%. We selected those three parameter sets because protein sequences with an overall percent identity between 15 and 30% are hard to align accurately by sequence alignment programs. The stringency levels of the three sets of parameter values suggest that we should select pairs of protein sequences with an overall percent identity between 25 and 40%, which are likely to have regions suitable for each of the three parameter sets.</p><p>An alignment from GAP4 with the three parameter sets contains four types of sections: sections of different sequence regions (marked with the sign +), sections of similar regions scored with the low parameter set (marked with the letter l), sections of similar regions scored with the medium parameter set (marked with the letter m) and sections of similar regions scored with the high parameter set (marked with the letter h). An initial part of a GAP4 alignment is shown in <xref ref-type="fig" rid="fig1">Figure 1</xref>. For each parameter set, GAP4 reports the total length and overall percent identity of all alignment sections that are scored with the parameter set. The GAP4 program finds sequence regions with different levels of conservation and scores each section of regions by using the most appropriate parameter set.</p><sec><title>Global alignment examples from GAP4</title><p>The global alignment algorithm in GAP4 was used on five randomly selected pairs of long protein sequences with an overall percent identity &#x0223c;40%. For each pair of sequences, the GAP4 program was run with the three parameter sets given above and with each of the other combinations of the three parameter sets. The seven combinations of the three parameter sets are represented by the strings l, m, h, lm, lh, mh and lmh, where the letters in each string denote the parameter sets in the combination. For each pair of sequences, seven global alignments were produced by GAP4, one alignment for each of the seven combinations. As expected, for each pair of sequences, the alignments from GAP4 with the single-parameter set combinations (the l, m and h combinations) are identical both in score and configuration to the alignments from GAP3 with the static use of each of the three parameter sets, respectively.</p><p>For each pair of sequences, the seven alignments have different similarity scores, and the alignment for the lmh combination has the largest score. In addition, some of the seven alignments are different in gap or difference block positions. For each pair of sequences, the seven alignments were compared by configuration, and alignments identical in configuration were placed in the same group. <xref ref-type="table" rid="tbl1">Table 1</xref> shows the alignment groups for each pair of sequences. For example, on sequence pair one, six out of the seven alignments are different from one another in gap positions. As another example, on pair four, the alignment for the lmh combination has two difference blocks with a total of 144 residues, and the alignment for the mh combination has two difference blocks with a total of 188 residues. Each difference block along with its weakly aligned boundary region in the lmh alignment became a difference block in the mh alignment because of lack of the l parameter set in the mh combination. Those results indicate that alignments from GAP4 may be different in both score and configuration when different parameter set combinations are provided to GAP4.</p><table-wrap id="tbl1" position="float"><label>Table 1</label><caption><p>Groups of identical alignments from GAP4 with seven combinations of parameter sets on five pairs of SwissProt protein sequences</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="1" colspan="1">Accession of sequence A</th><th align="left" rowspan="1" colspan="1">Length</th><th align="left" rowspan="1" colspan="1">Accession of sequence B</th><th align="left" rowspan="1" colspan="1">Length</th><th align="left" rowspan="1" colspan="1">Alignment groups<sup>a</sup></th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">Q9NY15</td><td align="left" rowspan="1" colspan="1">2570</td><td align="left" rowspan="1" colspan="1">Q8R4U0</td><td align="left" rowspan="1" colspan="1">2559</td><td align="left" rowspan="1" colspan="1">{l} {m, mh} {h} {lm} {lh} {lmh}</td></tr><tr><td align="left" rowspan="1" colspan="1">O12990</td><td align="left" rowspan="1" colspan="1">1153</td><td align="left" rowspan="1" colspan="1">Q62120</td><td align="left" rowspan="1" colspan="1">1129</td><td align="left" rowspan="1" colspan="1">{l, lm} {m} {h} {lh, lmh} {mh}</td></tr><tr><td align="left" rowspan="1" colspan="1">Q9H7F0</td><td align="left" rowspan="1" colspan="1">1130</td><td align="left" rowspan="1" colspan="1">Q9NQ11</td><td align="left" rowspan="1" colspan="1">1180</td><td align="left" rowspan="1" colspan="1">{l, lh, lmh} {m, mh} {h} {lm}</td></tr><tr><td align="left" rowspan="1" colspan="1">Q82Z40</td><td align="left" rowspan="1" colspan="1">1207</td><td align="left" rowspan="1" colspan="1">Q9XPS7</td><td align="left" rowspan="1" colspan="1">1076</td><td align="left" rowspan="1" colspan="1">{l} {m} {h} {lm} {lh, lmh} {mh}</td></tr><tr><td align="left" rowspan="1" colspan="1">Q9NTI2</td><td align="left" rowspan="1" colspan="1">1076</td><td align="left" rowspan="1" colspan="1">Q9Y2G3</td><td align="left" rowspan="1" colspan="1">1177</td><td align="left" rowspan="1" colspan="1">{l, lh, lmh} {m, mh} {h} {lm}</td></tr></tbody></table><table-wrap-foot><fn><p><sup>a</sup>Each alignment is denoted by the parameter set combination used to produce the alignment. Each parameter set combination is indicated by the letters for the parameter sets in the combination, with the letter l for the low parameter set, m for the medium parameter set and h for the high parameter set.</p></fn></table-wrap-foot></table-wrap><p>We used an independent method to show that motifs are likely to be located in highly conserved sections found by GAP4. The alignments from GAP4 with the lmh combination on the five pairs of sequences were selected for this illustration. Each of the ten sequences was run through a motif finding program named eMATRIX-Scan with the default parameter settings (<xref ref-type="bibr" rid="b33">33</xref>,<xref ref-type="bibr" rid="b34">34</xref>). For each sequence, the start and end coordinates of all motifs in the sequence from eMATRIX-Scan were transformed into coordinates with respect to the corresponding GAP4 alignment. We report in <xref ref-type="table" rid="tbl2">Table 2</xref>, for each alignment, the proportions of the motif residues in the l, m and h sections of the alignment, respectively, and the proportions of the alignment positions in the l, m, and h sections of the alignment, respectively. <xref ref-type="table" rid="tbl2">Table 2</xref> also shows the proportions for motif residues and alignment positions for all alignments, where the total number of motif residues is 2219 and the total number of alignment positions is 7497. Many of the motifs have an overlap with an h section.</p><table-wrap id="tbl2" position="float"><label>Table 2</label><caption><p>Proportions of the motif residues in the l, m and h sections of the alignment, respectively, and proportions of the alignment positions in the l, m and h sections of the alignment, respectively, for each alignment and for all alignments</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="1" colspan="1">Alignment</th><th colspan="3" align="left" rowspan="1">Proportions of motif residues</th><th colspan="3" align="left" rowspan="1">Proportions of alignment positions</th></tr><tr><th rowspan="1" colspan="1"/><th align="left" rowspan="1" colspan="1">Type l</th><th align="left" rowspan="1" colspan="1">Type m</th><th align="left" rowspan="1" colspan="1">Type h</th><th align="left" rowspan="1" colspan="1">Type l</th><th align="left" rowspan="1" colspan="1">Type m</th><th align="left" rowspan="1" colspan="1">Type h</th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">0.06</td><td align="left" rowspan="1" colspan="1">0.43</td><td align="left" rowspan="1" colspan="1">0.51</td><td align="left" rowspan="1" colspan="1">0.25</td><td align="left" rowspan="1" colspan="1">0.44</td><td align="left" rowspan="1" colspan="1">0.31</td></tr><tr><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">0.04</td><td align="left" rowspan="1" colspan="1">0.86</td><td align="left" rowspan="1" colspan="1">0.39</td><td align="left" rowspan="1" colspan="1">0.03</td><td align="left" rowspan="1" colspan="1">0.58</td></tr><tr><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1">0.00</td><td align="left" rowspan="1" colspan="1">0.00</td><td align="left" rowspan="1" colspan="1">1.00</td><td align="left" rowspan="1" colspan="1">0.43</td><td align="left" rowspan="1" colspan="1">0.05</td><td align="left" rowspan="1" colspan="1">0.52</td></tr><tr><td align="left" rowspan="1" colspan="1">4</td><td align="left" rowspan="1" colspan="1">0.01</td><td align="left" rowspan="1" colspan="1">0.02</td><td align="left" rowspan="1" colspan="1">0.97</td><td align="left" rowspan="1" colspan="1">0.42</td><td align="left" rowspan="1" colspan="1">0.19</td><td align="left" rowspan="1" colspan="1">0.39</td></tr><tr><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1">0.12</td><td align="left" rowspan="1" colspan="1">0.00</td><td align="left" rowspan="1" colspan="1">0.88</td><td align="left" rowspan="1" colspan="1">0.49</td><td align="left" rowspan="1" colspan="1">0.06</td><td align="left" rowspan="1" colspan="1">0.45</td></tr><tr><td align="left" rowspan="1" colspan="1">All</td><td align="left" rowspan="1" colspan="1">0.06</td><td align="left" rowspan="1" colspan="1">0.20</td><td align="left" rowspan="1" colspan="1">0.74</td><td align="left" rowspan="1" colspan="1">0.37</td><td align="left" rowspan="1" colspan="1">0.21</td><td align="left" rowspan="1" colspan="1">0.42</td></tr></tbody></table></table-wrap></sec><sec><title>Evaluation of GAP4</title><p>We assessed the biological purpose of making the dynamic use of multiple parameter sets by comparing the local alignment algorithm in GAP4 with the local alignment algorithm in GAP3 (<xref ref-type="bibr" rid="b19">19</xref>), and the Smith&#x02013;Waterman local alignment algorithm in SIM (<xref ref-type="bibr" rid="b17">17</xref>) on a large number of homologous protein sequences. Local alignment algorithms, instead of global alignment algorithms, are often used on sequences with local similarities, and the Smith&#x02013;Waterman algorithm is shown to be more sensitive than other fast alignment methods (<xref ref-type="bibr" rid="b30">30</xref>&#x02013;<xref ref-type="bibr" rid="b32">32</xref>). The SIM program produces an ordinary local alignment called a similarity block, and GAP3 produces an ordered list of similarity blocks separated by difference blocks. Both SIM and GAP3 use one parameter set at a time, whereas GAP4 extends GAP3 by making the dynamic use of multiple parameter sets.</p><p>We browsed the Pfam protein families at <ext-link ext-link-type="uri" xlink:href="http://pfam.wustl.edu"/> and focused on large families with an average sequence length of at least 200 residues and with an average percent identity between 25 and 40%. By following the links from the Pfam families to SwissProt, we selected 100 families of homologous protein sequences with a total of 7092 sequences from release 50.4 of the SwissProt protein database.</p><p>The three programs were evaluated by assessing the statistical significance of alignments from the programs. The statistical significance of an optimal local alignment produced by the Smith&#x02013;Waterman algorithm with one set of parameters is estimated with the equation
<disp-formula id="e1"><label>1</label><mml:math id="M56"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>&#x02265;</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mo>exp</mml:mo><mml:mo>(</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi>K</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>&#x003bb;</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>x</italic> is the similarity score of the alignment, <italic>m</italic> and <italic>n</italic> are the lengths of the two sequences, and <italic>K</italic> and &#x003bb; are statistical parameters dependent on the set of alignment parameters and the amino acid compositions of the sequences (<xref ref-type="bibr" rid="b35">35</xref>&#x02013;<xref ref-type="bibr" rid="b38">38</xref>). Values for the statistical parameters are obtained by fitting <xref ref-type="disp-formula" rid="e1">Equation 1</xref> to an empirical distribution of scores of alignments between randomly shuffled versions of the two sequences (<xref ref-type="bibr" rid="b36">36</xref>,<xref ref-type="bibr" rid="b38">38</xref>).</p><p>In the rest of this subsection, we first show how to find values for statistical parameters <italic>K</italic> and &#x003bb; in <xref ref-type="disp-formula" rid="e1">Equation 1</xref> in order to estimate the statistical significance of alignments from each of the three programs with the three parameter sets. Then we describe how to compute the standard error of probability estimate for each of the three programs. Those standard errors of probability estimate are useful in showing that <xref ref-type="disp-formula" rid="e1">Equation 1</xref> can also be used to estimate the statistical significance of optimal local alignments from GAP3 and GAP4, with the same level of accuracy as from SIM. Finally we present evaluation results on the statistical significance of alignments from the three programs.</p><p>A million pairs of random sequences are generated from a real protein sequence by reversing the sequence to produce a second sequence, by shuffling each of the two sequences a number of times to produce a first pair of random sequences, and by shuffling each of the two sequences in the first pair a number of times to produce a second pair of random sequences, and so on. Then for each of the three programs with each, two, or all of the three parameter sets, an optimal alignment is computed by the program on each pair of random sequences, and an empirical distribution of scores of a million alignments is generated. Let <italic>f</italic><sub>1,<italic>h</italic></sub>(<italic>x</italic>) be the observed frequency of getting the optimal alignment score above <italic>x</italic> in the empirical distribution of a million alignment scores from SIM with the parameter set <italic>h</italic>. Similarly, introduce <italic>f</italic><sub>1,<italic>l</italic></sub>(<italic>x</italic>) for SIM with <italic>l</italic>, <italic>f</italic><sub>1,<italic>m</italic></sub>(<italic>x</italic>) for SIM with <italic>m</italic>, <italic>f</italic><sub>3,<italic>l</italic></sub>(<italic>x</italic>) for GAP3 with <italic>l</italic>, <italic>f</italic><sub>3,<italic>m</italic></sub>(<italic>x</italic>) for GAP3 with <italic>m</italic>, <italic>f</italic><sub>3,<italic>h</italic></sub>(<italic>x</italic>) for GAP3 with <italic>h</italic>, <italic>f</italic><sub>4,<italic>m</italic>,<italic>h</italic></sub>(<italic>x</italic>) for GAP4 with <italic>m</italic> and <italic>h</italic> and <italic>f</italic><sub>4,<italic>l</italic>,<italic>m</italic>,<italic>h</italic></sub>(<italic>x</italic>) for GAP4 with <italic>l</italic>, <italic>m</italic> and <italic>h</italic>. As to be explained below, for some pairs of sequences, alignments from GAP4 with <italic>m</italic> and <italic>h</italic> are more statistically significant than alignments from GAP4 with <italic>l</italic>, <italic>m</italic> and <italic>h</italic>.</p><p>For SIM with <italic>h</italic>, let <italic>K</italic><sub>1,<italic>h</italic></sub> and &#x003bb;<sub>1,<italic>h</italic></sub> denote the <italic>K</italic> and &#x003bb; parameters in <xref ref-type="disp-formula" rid="e1">Equation 1</xref>, and obtain their values by fitting <xref ref-type="disp-formula" rid="e1">Equation 1</xref> to the empirical data <italic>f</italic><sub>1,<italic>h</italic></sub>(<italic>x</italic>). For GAP3 with <italic>h</italic>, obtain <italic>K</italic><sub>3,<italic>h</italic></sub> and &#x003bb;<sub>3,<italic>h</italic></sub> values by fitting <xref ref-type="disp-formula" rid="e1">Equation 1</xref> to <italic>f</italic><sub>3,<italic>h</italic></sub>(<italic>x</italic>). Similarly, obtain values for <italic>K</italic><sub>1,<italic>l</italic></sub> and &#x003bb;<sub>1,<italic>l</italic></sub>, <italic>K</italic><sub>3,<italic>l</italic></sub> and &#x003bb;<sub>3,<italic>l</italic></sub>, <italic>K</italic><sub>1,<italic>m</italic></sub> and &#x003bb;<sub>1<italic>m</italic></sub>, and <italic>K</italic><sub>3,<italic>m</italic></sub> and &#x003bb;<sub>3,<italic>m</italic></sub>. For GAP4 with <italic>m</italic> and <italic>h</italic>, obtain <italic>K</italic><sub>4,<italic>m</italic>,<italic>h</italic></sub> and &#x003bb;<sub>4,<italic>m</italic>,<italic>h</italic></sub> values by fitting <xref ref-type="disp-formula" rid="e1">Equation 1</xref> to <italic>f</italic><sub>4,<italic>m</italic>,<italic>h</italic></sub>(<italic>x</italic>). Similarly, obtain <italic>K</italic><sub>4,<italic>l</italic>,<italic>m</italic>,<italic>h</italic></sub> and &#x003bb;<sub>4,<italic>l</italic>,<italic>m</italic>,<italic>h</italic></sub> values. There are eight pairs of <italic>K</italic> and &#x003bb; values: three pairs for SIM, three pairs for GAP3 and two pairs for GAP4.</p><p>Let <italic>p</italic><sub>1,<italic>h</italic></sub>(<italic>x</italic>) be the probability of getting an optimal local alignment score above <italic>x</italic> from SIM with <italic>h</italic>. The probability is estimated by <xref ref-type="disp-formula" rid="e1">Equation 1</xref> with the pair of <italic>K</italic><sub>1,<italic>h</italic></sub> and &#x003bb;<sub>1,<italic>h</italic></sub> values. Similarly, define <italic>p</italic><sub>1,<italic>l</italic></sub>(<italic>x</italic>) for SIM with <italic>l</italic>, <italic>p</italic><sub>1,<italic>m</italic></sub>(<italic>x</italic>) for SIM with <italic>m</italic>, <italic>p</italic><sub>3,<italic>l</italic></sub>(<italic>x</italic>) for GAP3 with <italic>l</italic>, <italic>p</italic><sub>3,<italic>m</italic></sub>(<italic>x</italic>) for GAP3 with <italic>m</italic>, <italic>p</italic><sub>3,<italic>h</italic></sub>(<italic>x</italic>) for GAP3 with <italic>h</italic>, <italic>p</italic><sub>4,<italic>m</italic>,<italic>h</italic></sub>(<italic>x</italic>) for GAP4 with <italic>m</italic> and <italic>h</italic> and <italic>p</italic><sub>4,<italic>l</italic>,<italic>m</italic>,<italic>h</italic></sub>(<italic>x</italic>) for GAP4 with <italic>l</italic>, <italic>m</italic> and <italic>h</italic>. Those probabilities are estimated by <xref ref-type="disp-formula" rid="e1">Equation 1</xref> with the corresponding pairs of <italic>K</italic> and &#x003bb; values.</p><p>The standard error of estimate for each probability from <xref ref-type="disp-formula" rid="e1">Equation 1</xref> is computed as follows. Generate another million pairs of random sequences. For each pair (<italic>A,B</italic>) of random sequences, two alignments are computed by SIM, one with <italic>l</italic> and the other with <italic>h</italic>. Let <inline-formula><mml:math id="M57"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> denote the score of the alignment with <italic>l</italic>, and <inline-formula><mml:math id="M58"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> denote that with <italic>h</italic>. Let <italic>Q</italic> be the set of all pairs (<italic>A</italic>,<italic>B</italic>) of sequences with <inline-formula><mml:math id="M59"><mml:mrow><mml:mn>0.00005</mml:mn><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mo>&#x02264;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M60"><mml:mrow><mml:mn>0.00005</mml:mn><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mo>&#x02264;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>. The use of the upper bound 0.01 and the lower bound 0.00005 ensures that the pairs of sequences in the set <italic>Q</italic> have accurate and useful empirical frequencies; a frequency above 0.01 is less useful and a frequency below 0.00005 is less accurate. The set <italic>Q</italic> is used to compute the standard error of probability estimate for each of the three programs with each, two, or all of the parameter sets. The standard error of probability estimate for SIM with <italic>h</italic> on the set <italic>Q</italic> of sequence pairs is defined as
<disp-formula><mml:math id="M61"><mml:mrow><mml:mi>s</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x000b1;</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mo>(</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo><mml:mo>&#x02208;</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:munder></mml:mstyle><mml:mtext>&#x02009;</mml:mtext><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mo>]</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>Q</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msqrt><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>N<sub>Q</sub></italic> is the number of sequence pairs in the set <italic>Q</italic>. Using the denominator <italic>N<sub>Q</sub></italic> &#x02212; 2, instead of <italic>N<sub>Q</sub></italic>, is a standard practice in regression analysis. The standard errors <italic>se</italic><sub>1,<italic>l</italic></sub>, <italic>se</italic><sub>1,<italic>m</italic></sub>, <italic>se</italic><sub>3,<italic>l</italic></sub>, <italic>se</italic><sub>3,<italic>m</italic></sub>, <italic>se</italic><sub>3,<italic>h</italic></sub>, <italic>se</italic><sub>4,<italic>m</italic>,<italic>h</italic></sub> and <italic>se</italic><sub>4,<italic>l</italic>,<italic>m</italic>,<italic>h</italic></sub> are similarly defined by using the same set <italic>Q</italic>. There are eight standard errors: three for SIM, three for GAP3 and two for GAP4.</p><p>Next we present evaluation results on the statistical significance of alignments from the three programs with the three parameter sets. A real protein sequence (SwissProt accession no. Q8R016) was randomly selected as a source sequence from one of the 100 families of homologous sequences. From this source sequence, eight pairs of <italic>K</italic> and &#x003bb; values and eight standard errors were computed by using the method given above. Those values, marked from above with the corresponding parameter names, are given below:</p><table-wrap id="d34e4866" position="anchor"><graphic xlink:href="gkl1063t1"/></table-wrap><p>The number of sequence pairs in the set <italic>Q</italic> was 796. Note that the statistical parameter values of GAP3 are identical to those of SIM, respectively. Because the standard errors for GAP4 are similar to those for SIM, <xref ref-type="disp-formula" rid="e1">Equation 1</xref> can be used to estimate the statistical significance of alignments from GAP4 at a similar level of accuracy as it is for SIM. The &#x003bb;<sub>1,<italic>m</italic></sub> value of 0.202 (for BLOSUM62 in 1/3 bit units) given above is smaller than a &#x003bb; value of 0.305 for BLOSUM62 in 1/2 bit units from Altschul and Gish (<xref ref-type="bibr" rid="b38">38</xref>).</p><p>An important observation about the &#x003bb; values is that the &#x003bb;<sub>4,<italic>l</italic>,<italic>m</italic>,<italic>h</italic></sub> value is close to the &#x003bb;<sub>1,<italic>l</italic></sub> value, and the &#x003bb;<sub>4,<italic>m</italic>,<italic>h</italic></sub> value is close to the &#x003bb;<sub>1,<italic>m</italic></sub> value. It follows by <xref ref-type="disp-formula" rid="e1">Equation 1</xref> that if GAP4 with <italic>l</italic>, <italic>m</italic> and <italic>h</italic> produces an alignment of sufficiently larger score than SIM with <italic>l</italic> on a pair of sequences, then the alignment from GAP4 is more statistically significant than the alignment from SIM. Similarly, if GAP4 with <italic>m</italic> and <italic>h</italic> produces an alignment of sufficiently larger score than SIM with <italic>m</italic> on a pair of sequences, then the alignment from GAP4 is more statistically significant than the alignment from SIM. In addition, the &#x003bb;<sub>4,<italic>m</italic>,<italic>h</italic></sub> value is not far below the &#x003bb;<sub>1,<italic>h</italic></sub> value, so an alignment of much larger score from GAP4 with <italic>m</italic> and <italic>h</italic> may be more statistically significant than an alignment from SIM with <italic>h</italic>. On the other hand, the &#x003bb;<sub>4,<italic>l</italic>,<italic>m</italic>,<italic>h</italic></sub> value is much smaller than the &#x003bb;<sub>1,<italic>m</italic></sub> value, so an alignment of much larger score from GAP4 with <italic>l</italic>, <italic>m</italic> and <italic>h</italic> may be less statistically significant than an alignment from SIM with <italic>m</italic>. Because the <italic>K</italic><sub>4,<italic>l</italic>,<italic>m</italic>,<italic>h</italic></sub> value is larger than the <italic>K</italic><sub>1,<italic>l</italic></sub> value, an alignment from GAP4 with <italic>l</italic>, <italic>m</italic> and <italic>h</italic> is less statistically significant than an alignment of the same score from SIM with <italic>l</italic>.</p><p>Different values for the parameter set change penalty <italic>c</italic> were used to see its effect on &#x003bb;<sub>4,<italic>m</italic>,<italic>h</italic></sub> in relation to &#x003bb;<sub>1,<italic>m</italic></sub>. For each <italic>c</italic> value from 4 to 14 with a step size of 2, &#x003bb;<sub>4,<italic>m</italic>,<italic>h</italic></sub> and &#x003bb;<sub>1,<italic>m</italic></sub> values were estimated from the source sequence with the parameter sets <italic>m</italic> and <italic>h</italic>, where the set change penalty was set to the value and the rest in <italic>m</italic> and <italic>h</italic> were unchanged. Since &#x003bb;<sub>3,<italic>m</italic></sub> is very close to &#x003bb;<sub>1,<italic>m</italic></sub>, &#x003bb;<sub>3,<italic>m</italic></sub> is omitted here. The relationship between <italic>c</italic> and &#x003bb;<sub>4,<italic>m</italic>,<italic>h</italic></sub> &#x02212; &#x003bb;<sub>1,<italic>m</italic></sub> is shown in the following data in the form of <italic>c</italic>&#x02223;(&#x003bb;<sub>4,<italic>m</italic>,<italic>h</italic></sub> &#x02212; &#x003bb;<sub>1,<italic>m</italic></sub>): 4&#x02223;&#x02212;0.009, 6&#x02223;&#x02212;0.003, 8&#x02223;&#x02212;0.002, 10&#x02223;0.003, 12&#x02223;0.004 and 14&#x02223;0.004. The data show that using a <italic>c</italic> value of 10 or higher kept &#x003bb;<sub>4,<italic>m</italic>,<italic>h</italic></sub> above &#x003bb;<sub>1,<italic>m</italic></sub>. Keeping &#x003bb;<sub>4,<italic>m</italic>,<italic>h</italic></sub> above or close to &#x003bb;<sub>1,<italic>m</italic></sub> is important in ensuring that an alignment of sufficiently higher score from GAP4 is more statistically significant than an alignment from SIM.</p><p>The statistical parameter values were used to assess the statistical significance of alignments from the three programs on the 100 families of homologous protein sequences. For each family, pairs of homologous protein sequences were formed by pairing each sequence with every other sequence in the family. For each pair of homologous sequences, if the percent identity of an alignment from SIM with <italic>m</italic> on the pair is &#x0003c;40%, then the pair was selected. A total of 257 716 pairs were selected. For each pair of selected sequences, GAP4 with the &#x02212;g 0 option was run twice on the pair, first time with the parameter sets <italic>l</italic>, <italic>m</italic> and <italic>h</italic>, and second time with the parameter sets <italic>m</italic> and <italic>h</italic>, the <italic>P</italic>-value of the first alignment was computed by <xref ref-type="disp-formula" rid="e1">Equation 1</xref> with the <italic>K</italic><sub>4,<italic>l</italic>,<italic>m</italic>,<italic>h</italic></sub> and &#x003bb;<sub>4,<italic>l</italic>,<italic>m</italic>,<italic>h</italic></sub> values, that of the second alignment was computed with the <italic>K</italic><sub>4,<italic>m</italic>,<italic>h</italic></sub> and &#x003bb;<sub>4,<italic>m</italic>,<italic>h</italic></sub> values, and the minimum of the two <italic>P</italic>-values was selected.</p><p>The GAP3 program with the &#x02212;g 0 option was run three times on the pair, each with one of the three parameter sets, the <italic>P</italic>-value of each of the three alignments was computed with the corresponding pair of <italic>K</italic> and &#x003bb; values, and the minimum of the three <italic>P</italic>-values was selected. Similarly, SIM with the one-alignment option was run three times on the pair, each with one of the three parameter sets, the <italic>P</italic>-value of each of the three alignments was computed with the corresponding pair of <italic>K</italic> and &#x003bb; values, and the minimum of the three <italic>P</italic>-values was selected.</p><p>On 168 475 out of the 257 716 pairs (a rate of 65.4%), the <italic>P</italic>-value from GAP4 was smaller than the <italic>P</italic>-values from GAP3 and SIM. In 60 out of the 100 families, a rate of at least 59% in favor of GAP4 was observed for the family. The entire computation from taking as input a source sequence to reporting the <italic>P</italic>-values of alignments for all the pairs of sequences took three days on a processor. Most of the time was spent on computing alignments on a million pairs of random sequences, where GAP4 with the three parameter sets took twice as much time as SIM with the three parameter sets.</p></sec></sec><sec sec-type="discussion"><title>DISCUSSION</title><p>We have developed a dynamic programming algorithm for aligning two sequences with several parameter sets of different levels of stringency. The algorithm partitions the sequences into regions by similarity level and selects a proper set of parameter values for every pair of regions between the two sequences. The local alignment version of the algorithm and existing local alignment algorithms were evaluated on over 250 000 pairs of homologous sequences from 100 protein families. The experimental results show that the new algorithm with the dynamic use of two and three parameter sets produce more statistically significant alignments than the existing algorithms with the static use of each parameter set.</p><p>An unexpected observation from our evaluation of the statistical significance of alignments from the new and existing algorithms is that using multiple parameter sets that cover the entire stringency spectrum with the new algorithm leads to an alignment of the highest similarity score but not necessarily of the highest statistical significance. The reason is that the least stringent parameter set when used alone with the Smith&#x02013;Waterman algorithm has the lowest &#x003bb; value and that the &#x003bb; value for the new algorithm with all the multiple parameter sets is close to the lowest &#x003bb; value. <xref ref-type="disp-formula" rid="e1">Equation 1</xref> says that the statistical significance of the alignment depends on the product of the alignment score and the &#x003bb; value. The product of the highest alignment score and the lowest &#x003bb; value is not necessarily larger than the product of a lower alignment score and a higher &#x003bb; value.</p><p>This observation leads to two approaches to using multiple parameter sets with the new local alignment algorithm. Let <italic>s</italic><sub>1</sub>,<italic>s</italic><sub>2</sub>,&#x02026;<italic>s<sub>p</sub></italic> be a list of parameter sets in order of increasing stringency. In approach one, for each <italic>j</italic> with 1 &#x02264; <italic>j</italic> &#x0003c; <italic>p</italic>, combination <italic>j</italic> consists of parameter sets <italic>s<sub>j</sub></italic>,<italic>s</italic><sub><italic>j</italic>+1</sub>,&#x02026;<italic>s<sub>p</sub></italic>. For each combination, the new algorithm is run with all parameter sets in the combination. From the <italic>p</italic> &#x02212; 1 output alignments, a most statistically significant alignment is selected. In approach two, the Smith&#x02013;Waterman algorithm is run for each of the <italic>p</italic> parameter sets, and a parameter set <italic>s<sub>j</sub></italic> that leads to a most statistically significant alignment is found. If <italic>j</italic> &#x0003c; <italic>p</italic>, then the new algorithm is run with parameter sets <italic>s<sub>j</sub></italic>,<italic>s</italic><sub><italic>j</italic>+1</sub>,&#x02026;<italic>s<sub>p</sub></italic>.</p><p>The global alignment examples show that the location of difference blocks and gaps in the output alignment is also affected by the algorithm with the dynamic use of multiple parameter sets. The alignment from the dynamic use of multiple parameter sets may be different in configuration from the alignments from the static use of each parameter set. In general, alignments from the algorithm with different parameter set combinations may be different in configuration.</p><p>It is important that the substitution matrices in the multiple parameter sets be scaled in the same way. For example, all the substitution matrices are in 1/3 bit units. If the substitution matrices were scaled differently, then the algorithm that makes the dynamic use of the multiple parameter sets with those matrices would produce sequence alignments of no biological significance. In addition, the change penalty for each parameter set has to be sufficiently large.</p><p>The algorithm is not efficient for comparing megabase genomic sequences or searching databases. However, an efficient version of the algorithm can be developed and incorporated into existing large-scale comparison programs (<xref ref-type="bibr" rid="b1">1</xref>&#x02013;<xref ref-type="bibr" rid="b10">10</xref>).</p><p>There are existing algorithms that allow the user to use multiple parameter sets (<xref ref-type="bibr" rid="b21">21</xref>&#x02013;<xref ref-type="bibr" rid="b24">24</xref>). The existing algorithms make the static use of each of the multiple parameter sets, whereas our new algorithm makes the dynamic use of the multiple parameter sets. Altschul (<xref ref-type="bibr" rid="b21">21</xref>) extends an alignment algorithm to use multiple parameter sets by computing an alignment with the algorithm for each of the multiple parameter sets and then selecting an alignment with the highest statistical significance. Webb <italic>et al</italic>. (<xref ref-type="bibr" rid="b24">24</xref>) develops a program named BALSA to use multiple parameter sets by computing alignments for each of the multiple parameter sets and then using the Bayes rule to see the effect of each parameter set. A natural way of integrating the dynamic use of multiple parameter sets with the BALSA program is to form a number of combinations of multiple parameter sets, make the dynamic use of the parameter sets in each combination, and use the Bayes rule to see the effect of each combination.</p></sec><sec><title>AVAILABILITY</title><p>The GAP4 program is freely available for academic use at <ext-link ext-link-type="uri" xlink:href="http://deepc2.psi.iastate.edu/aat/align/align.html"/>.</p></sec><sec sec-type="supplementary-material"><title>SUPPLEMENTARY DATA</title><p>Supplementary Data are available at NAR online.</p></sec></body><back><ack><p>The authors thank Sandy Huang and Liang Ye for obtaining protein datasets. The authors are grateful to the referees for insightful suggestions. This work was supported in part by NIH Grant R01 HG01502-07 from NHGRI. Funding to pay the Open Access publication charges for this article was provided by Iowa State University.</p><p><italic>Conflict of interest statement.</italic> None declared.</p></ack><ref-list><title>REFERENCES</title><ref id="b1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pearson</surname><given-names>W.R.</given-names></name><name><surname>Lipman</surname><given-names>D.</given-names></name></person-group><article-title>Improved tools for biological sequence comparison</article-title><source>Proc. Natl Acad. Sci. USA</source><year>1988</year><volume>85</volume><fpage>2444</fpage><lpage>2448</lpage><pub-id pub-id-type="pmid">3162770</pub-id></element-citation></ref><ref id="b2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altschul</surname><given-names>S.F.</given-names></name><name><surname>Gish</surname><given-names>W.</given-names></name><name><surname>Miller</surname><given-names>W.</given-names></name><name><surname>Myers</surname><given-names>E.W.</given-names></name><name><surname>Lipman</surname><given-names>D.J.</given-names></name></person-group><article-title>Basic local alignment search tool</article-title><source>J. Mol. Biol.</source><year>1990</year><volume>215</volume><fpage>403</fpage><lpage>410</lpage><pub-id pub-id-type="pmid">2231712</pub-id></element-citation></ref><ref id="b3"><label>3</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Burkhardt</surname><given-names>S.</given-names></name><name><surname>Crauser</surname><given-names>A.</given-names></name><name><surname>Lenhof</surname><given-names>H.-P.</given-names></name><name><surname>Rivals</surname><given-names>E.</given-names></name><name><surname>Ferragina</surname><given-names>P.</given-names></name><name><surname>Vingron</surname><given-names>M.</given-names></name></person-group><article-title>Q-gram based database searching using a suffix array</article-title><year>1999</year><conf-name>Proceedings of the Third Annual International Conference on Computational Molecular Biology</conf-name><publisher-loc>New York</publisher-loc><publisher-name>ACM Press</publisher-name><fpage>77</fpage><lpage>83</lpage></element-citation></ref><ref id="b4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ning</surname><given-names>Z.</given-names></name><name><surname>Cox</surname><given-names>A.J.</given-names></name><name><surname>Mullikin</surname><given-names>J.C.</given-names></name></person-group><article-title>SSAHA: a fast search method for large DNA databases</article-title><source>Genome Res.</source><year>2001</year><volume>11</volume><fpage>1725</fpage><lpage>1729</lpage><pub-id pub-id-type="pmid">11591649</pub-id></element-citation></ref><ref id="b5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kent</surname><given-names>W.J.</given-names></name></person-group><article-title>BLAT&#x02013;The BLAST-like alignment tool</article-title><source>Genome Res.</source><year>2002</year><volume>12</volume><fpage>656</fpage><lpage>664</lpage><pub-id pub-id-type="pmid">11932250</pub-id></element-citation></ref><ref id="b6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ma</surname><given-names>B.</given-names></name><name><surname>Tromp</surname><given-names>J.</given-names></name><name><surname>Li</surname><given-names>M.</given-names></name></person-group><article-title>PatternHunter: faster and more sensitive homology search</article-title><source>Bioinformatics</source><year>2002</year><volume>18</volume><fpage>440</fpage><lpage>445</lpage><pub-id pub-id-type="pmid">11934743</pub-id></element-citation></ref><ref id="b7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bray</surname><given-names>N.</given-names></name><name><surname>Dubchak</surname><given-names>I.</given-names></name><name><surname>Pachter</surname><given-names>L.</given-names></name></person-group><article-title>AVID: a global alignment program</article-title><source>Genome Res.</source><year>2003</year><volume>13</volume><fpage>97</fpage><lpage>102</lpage><pub-id pub-id-type="pmid">12529311</pub-id></element-citation></ref><ref id="b8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwartz</surname><given-names>S.</given-names></name><name><surname>Kent</surname><given-names>W.J.</given-names></name><name><surname>Smit</surname><given-names>A.</given-names></name><name><surname>Zhang</surname><given-names>Z.</given-names></name><name><surname>Baertsch</surname><given-names>R.</given-names></name><name><surname>Hardison</surname><given-names>R.</given-names></name><name><surname>Haussler</surname><given-names>D.</given-names></name><name><surname>Miller</surname><given-names>W.</given-names></name></person-group><article-title>Human-mouse alignments with BLASTZ</article-title><source>Genome Res.</source><year>2003</year><volume>13</volume><fpage>103</fpage><lpage>107</lpage><pub-id pub-id-type="pmid">12529312</pub-id></element-citation></ref><ref id="b9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brudno</surname><given-names>M.</given-names></name><name><surname>Do</surname><given-names>C.B.</given-names></name><name><surname>Cooper</surname><given-names>G.M.</given-names></name><name><surname>Kim</surname><given-names>M.F.</given-names></name><name><surname>Davydov</surname><given-names>E.</given-names></name><name><surname>Green</surname><given-names>E.D.</given-names></name><name><surname>Sidow</surname><given-names>A.</given-names></name><name><surname>Batzoglou</surname><given-names>S.</given-names></name></person-group><article-title>LAGAN and Multi-LAGAN: efficient tools for large-scale multiple alignment of genomic DNA</article-title><source>Genome Res.</source><year>2003</year><volume>13</volume><fpage>721</fpage><lpage>731</lpage><pub-id pub-id-type="pmid">12654723</pub-id></element-citation></ref><ref id="b10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kurtz</surname><given-names>S.</given-names></name><name><surname>Phillippy</surname><given-names>A.</given-names></name><name><surname>Delcher</surname><given-names>A.L.</given-names></name><name><surname>Smoot</surname><given-names>M.</given-names></name><name><surname>Shumway</surname><given-names>M.</given-names></name><name><surname>Antonescu</surname><given-names>C.</given-names></name><name><surname>Salzberg</surname><given-names>S.L.</given-names></name></person-group><article-title>Versatile and open software for comparing large genomes</article-title><source>Genome Biol.</source><year>2004</year><volume>5</volume><fpage>R12.1</fpage><lpage>9</lpage><pub-id pub-id-type="pmid">14759262</pub-id></element-citation></ref><ref id="b11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Needleman</surname><given-names>S.B.</given-names></name><name><surname>Wunsch</surname><given-names>C.D.</given-names></name></person-group><article-title>A general method applicable to the search for similarities in the amino acid sequences of two proteins</article-title><source>J. Mol. Biol.</source><year>1970</year><volume>48</volume><fpage>443</fpage><lpage>453</lpage><pub-id pub-id-type="pmid">5420325</pub-id></element-citation></ref><ref id="b12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>T.F.</given-names></name><name><surname>Waterman</surname><given-names>M.S.</given-names></name></person-group><article-title>Identification of common molecular subsequences</article-title><source>J. Mol. Biol.</source><year>1981</year><volume>147</volume><fpage>195</fpage><lpage>197</lpage><pub-id pub-id-type="pmid">7265238</pub-id></element-citation></ref><ref id="b13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gotoh</surname><given-names>O.</given-names></name></person-group><article-title>An improved algorithm for matching biological sequences</article-title><source>J. Mol. Biol.</source><year>1982</year><volume>162</volume><fpage>705</fpage><lpage>708</lpage><pub-id pub-id-type="pmid">7166760</pub-id></element-citation></ref><ref id="b14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Waterman</surname><given-names>M.S.</given-names></name><name><surname>Eggert</surname><given-names>M.</given-names></name></person-group><article-title>A new algorithm for best subsequence alignments with application to tRNA-rRNA comparisons</article-title><source>J. Mol. Biol.</source><year>1987</year><volume>197</volume><fpage>723</fpage><lpage>728</lpage><pub-id pub-id-type="pmid">2448477</pub-id></element-citation></ref><ref id="b15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Myers</surname><given-names>E.W.</given-names></name><name><surname>Miller</surname><given-names>W.</given-names></name></person-group><article-title>Optimal alignments in linear space</article-title><source>Comput. Appl. Biosci.</source><year>1988</year><volume>4</volume><fpage>11</fpage><lpage>17</lpage><pub-id pub-id-type="pmid">3382986</pub-id></element-citation></ref><ref id="b16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gotoh</surname><given-names>O.</given-names></name></person-group><article-title>Optimal sequence alignment allowing for long gaps</article-title><source>Bull. Math. Biol.</source><year>1990</year><volume>52</volume><fpage>359</fpage><lpage>373</lpage><pub-id pub-id-type="pmid">2165832</pub-id></element-citation></ref><ref id="b17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>X.</given-names></name><name><surname>Miller</surname><given-names>W.</given-names></name></person-group><article-title>A time-efficient, linear-space local similarity algorithm</article-title><source>Adv. Appl. Math.</source><year>1991</year><volume>12</volume><fpage>337</fpage><lpage>357</lpage></element-citation></ref><ref id="b18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chao</surname><given-names>K.-M.</given-names></name><name><surname>Pearson</surname><given-names>W.R.</given-names></name><name><surname>Miller</surname><given-names>W.</given-names></name></person-group><article-title>Aligning two sequences within a specified diagonal band</article-title><source>Comput. Appl. Biosci.</source><year>1992</year><volume>8</volume><fpage>481</fpage><lpage>487</lpage><pub-id pub-id-type="pmid">1422882</pub-id></element-citation></ref><ref id="b19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>X.</given-names></name><name><surname>Chao</surname><given-names>K.-M.</given-names></name></person-group><article-title>A generalized global alignment algorithm</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><fpage>228</fpage><lpage>233</lpage><pub-id pub-id-type="pmid">12538243</pub-id></element-citation></ref><ref id="b20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Collins</surname><given-names>J.F.</given-names></name><name><surname>Coulson</surname><given-names>A.F.W.</given-names></name><name><surname>Lyall</surname><given-names>A.</given-names></name></person-group><article-title>The significance of protein sequence similarities</article-title><source>Comput. Appl. Biosci.</source><year>1988</year><volume>4</volume><fpage>67</fpage><lpage>71</lpage><pub-id pub-id-type="pmid">3383005</pub-id></element-citation></ref><ref id="b21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altschul</surname><given-names>S.F.</given-names></name></person-group><article-title>A protein alignment scoring system sensitive at all evolutionary distances</article-title><source>J. Mol. Evol.</source><year>1993</year><volume>36</volume><fpage>290</fpage><lpage>300</lpage><pub-id pub-id-type="pmid">8483166</pub-id></element-citation></ref><ref id="b22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>J.</given-names></name><name><surname>Liu</surname><given-names>J.S.</given-names></name><name><surname>Lawrence</surname><given-names>C.E.</given-names></name></person-group><article-title>Bayesian adaptive sequence alignment</article-title><source>Bioinformatics</source><year>1998</year><volume>14</volume><fpage>25</fpage><lpage>39</lpage><pub-id pub-id-type="pmid">9520499</pub-id></element-citation></ref><ref id="b23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>J.S.</given-names></name><name><surname>Lawrence</surname><given-names>C.E.</given-names></name></person-group><article-title>Bayesian inference on biopolymer models</article-title><source>Bioinformatics</source><year>1999</year><volume>15</volume><fpage>38</fpage><lpage>52</lpage><pub-id pub-id-type="pmid">10068691</pub-id></element-citation></ref><ref id="b24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Webb</surname><given-names>B.-J.M.</given-names></name><name><surname>Liu</surname><given-names>J.S.</given-names></name><name><surname>Lawrence</surname><given-names>C.E.</given-names></name></person-group><article-title>BALSA: Bayesian algorithm for local sequence alignment</article-title><source>Nucleic Acids Res.</source><year>2002</year><volume>30</volume><fpage>1268</fpage><lpage>1277</lpage><pub-id pub-id-type="pmid">11861921</pub-id></element-citation></ref><ref id="b25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hirschberg</surname><given-names>D.S.</given-names></name></person-group><article-title>A linear space algorithm for computing maximal common subsequences</article-title><source>Commun. Assoc. Comput. Mach.</source><year>1975</year><volume>18</volume><fpage>341</fpage><lpage>343</lpage></element-citation></ref><ref id="b26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>X.</given-names></name></person-group><article-title>On global sequence alignment</article-title><source>Comput. Appl. Biosci.</source><year>1994</year><volume>10</volume><fpage>227</fpage><lpage>235</lpage><pub-id pub-id-type="pmid">7922677</pub-id></element-citation></ref><ref id="b27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mott</surname><given-names>R.</given-names></name></person-group><article-title>EST_GENOME: a program to align spliced DNA sequences to unspliced genomic DNA</article-title><source>Comput. Appl. Biosci.</source><year>1997</year><volume>13</volume><fpage>477</fpage><lpage>478</lpage><pub-id pub-id-type="pmid">9283765</pub-id></element-citation></ref><ref id="b28"><label>28</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>X.</given-names></name></person-group><person-group person-group-type="editor"><name><surname>Jiang</surname><given-names>T.</given-names></name><name><surname>Xu</surname><given-names>Y.</given-names></name><name><surname>Zhang</surname><given-names>M.</given-names></name></person-group><article-title>Bio-sequence comparison and applications</article-title><source>Current Topics in Computational Molecular Biology</source><year>2002</year><publisher-loc>Cambridge</publisher-loc><publisher-name>MIT Press</publisher-name><fpage>45</fpage><lpage>69</lpage></element-citation></ref><ref id="b29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Henikoff</surname><given-names>S.</given-names></name><name><surname>Henikoff</surname><given-names>J.G.</given-names></name></person-group><article-title>Amino acid substitution matrices from protein blocks</article-title><source>Proc. Natl Acad. Sci. USA</source><year>1992</year><volume>89</volume><fpage>10915</fpage><lpage>10919</lpage><pub-id pub-id-type="pmid">1438297</pub-id></element-citation></ref><ref id="b30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pearson</surname><given-names>W.R.</given-names></name></person-group><article-title>Comparison of methods for searching protein sequence databases</article-title><source>Protein Sci.</source><year>1995</year><volume>4</volume><fpage>1145</fpage><lpage>1160</lpage><pub-id pub-id-type="pmid">7549879</pub-id></element-citation></ref><ref id="b31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pearson</surname><given-names>W.R.</given-names></name></person-group><article-title>Empirical statistical estimates for sequence similarity searches</article-title><source>J. Mol. Biol.</source><year>1998</year><volume>276</volume><fpage>71</fpage><lpage>84</lpage><pub-id pub-id-type="pmid">9514730</pub-id></element-citation></ref><ref id="b32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reese</surname><given-names>J.T.</given-names></name><name><surname>Pearson</surname><given-names>W.R.</given-names></name></person-group><article-title>Empirical determination of effective gap penalties for sequence comparison</article-title><source>Bioinformatics</source><year>2002</year><volume>18</volume><fpage>1500</fpage><lpage>1507</lpage><pub-id pub-id-type="pmid">12424122</pub-id></element-citation></ref><ref id="b33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>T.D.</given-names></name><name><surname>Nevill-Manning</surname><given-names>C.G.</given-names></name><name><surname>Brutlag</surname><given-names>D.L.</given-names></name></person-group><article-title>Minimal-risk scoring matrices for sequence analysis</article-title><source>J. Comp. Biol.</source><year>1999</year><volume>6</volume><fpage>219</fpage><lpage>235</lpage></element-citation></ref><ref id="b34"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>T.D.</given-names></name><name><surname>Nevill-Manning</surname><given-names>C.G.</given-names></name><name><surname>Brutlag</surname><given-names>D.L.</given-names></name></person-group><article-title>Fast probabilistic analysis of sequence function using scoring matrices</article-title><source>Bioinformatics</source><year>2000</year><volume>16</volume><fpage>233</fpage><lpage>244</lpage><pub-id pub-id-type="pmid">10869016</pub-id></element-citation></ref><ref id="b35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karlin</surname><given-names>S.</given-names></name><name><surname>Altschul</surname><given-names>S.F.</given-names></name></person-group><article-title>Methods for assessing the statistical significance of molecular sequence features by using general scoring schemes</article-title><source>Proc. Natl Acad. Sci. USA</source><year>1990</year><volume>87</volume><fpage>2264</fpage><lpage>2268</lpage><pub-id pub-id-type="pmid">2315319</pub-id></element-citation></ref><ref id="b36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mott</surname><given-names>R.</given-names></name></person-group><article-title>Maximum-likelihood estimation of the statistical distribution of Smith-Waterman local sequence similarity scores</article-title><source>Bull. Math. Biol.</source><year>1992</year><volume>54</volume><fpage>59</fpage><lpage>75</lpage></element-citation></ref><ref id="b37"><label>37</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Waterman</surname><given-names>M.S.</given-names></name><name><surname>Vingron</surname><given-names>M.</given-names></name></person-group><article-title>Rapid and accurate estimates of statistical significance for sequence database searches</article-title><source>Proc. Natl Acad. Sci. USA</source><year>1994</year><volume>91</volume><fpage>4625</fpage><lpage>4628</lpage><pub-id pub-id-type="pmid">8197109</pub-id></element-citation></ref><ref id="b38"><label>38</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altschul</surname><given-names>S.F.</given-names></name><name><surname>Gish</surname><given-names>W.</given-names></name></person-group><article-title>Local alignment statistics</article-title><source>Enzymol.</source><year>1996</year><volume>266</volume><fpage>460</fpage><lpage>480</lpage></element-citation></ref></ref-list></back></article>

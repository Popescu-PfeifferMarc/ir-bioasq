<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id><journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id><journal-id journal-id-type="pmc">nar</journal-id><journal-id journal-id-type="publisher-id">Nucleic Acids Research</journal-id><journal-title-group><journal-title>Nucleic Acids Research</journal-title></journal-title-group><issn pub-type="ppub">0305-1048</issn><issn pub-type="epub">1362-4962</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">17517768</article-id><article-id pub-id-type="pmc">PMC1904293</article-id><article-id pub-id-type="doi">10.1093/nar/gkm330</article-id><article-categories><subj-group subj-group-type="heading"><subject>Methods Online</subject></subj-group></article-categories><title-group><article-title>Sequence analysis and editing for bisulphite genomic sequencing projects</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Carr</surname><given-names>Ian M.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Valleley</surname><given-names>Elizabeth M. A.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Cordery</surname><given-names>Sarah F.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Markham</surname><given-names>Alexander F.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Bonthron</surname><given-names>David T.</given-names></name><xref ref-type="corresp" rid="COR1">*</xref></contrib></contrib-group><aff>Leeds Institute for Molecular Medicine, University of Leeds, Leeds, UK</aff><author-notes><corresp id="COR1">*To whom correspondence should be addressed. Tel: <phone>+44 113 343 8649</phone>; Fax: <fax>+44 113 343 8702</fax>; Email: <email>d.t.bonthron@leeds.ac.uk</email></corresp></author-notes><pub-date pub-type="ppub"><month>5</month><year>2007</year></pub-date><pub-date pub-type="epub"><day>21</day><month>5</month><year>2007</year></pub-date><pub-date pub-type="pmc-release"><day>21</day><month>5</month><year>2007</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. --><volume>35</volume><issue>10</issue><fpage>e79</fpage><lpage>e79</lpage><history><date date-type="received"><day>22</day><month>3</month><year>2007</year></date><date date-type="rev-recd"><day>12</day><month>4</month><year>2007</year></date><date date-type="accepted"><day>17</day><month>4</month><year>2007</year></date></history><permissions><copyright-statement>&#x000a9; 2007 The Author(s)</copyright-statement><copyright-year>2007</copyright-year><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/"><license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><abstract><p>Bisulphite genomic sequencing is a widely used technique for detailed analysis of the methylation status of a region of DNA. It relies upon the selective deamination of unmethylated cytosine to uracil after treatment with sodium bisulphite, usually followed by PCR amplification of the chosen target region. Since this two-step procedure replaces all unmethylated cytosine bases with thymine, PCR products derived from unmethylated templates contain only three types of nucleotide, in unequal proportions. This can create a number of technical difficulties (e.g. for some base-calling methods) and impedes manual analysis of sequencing results (since the long runs of T or A residues are difficult to align visually with the parent sequence). To facilitate the detailed analysis of bisulphite PCR products (particularly using multiple cloned templates), we have developed a visually intuitive program that identifies the methylation status of CpG dinucleotides by analysis of raw sequence data files produced by MegaBace or ABI sequencers as well as Staden SCF trace files and plain text files. The program then also collates and presents data derived from independent templates (e.g. separate clones). This results in a considerable reduction in the time required for completion of a detailed genomic methylation project.</p></abstract></article-meta></front><body><sec><title>INTRODUCTION</title><p>Bisulphite sequencing is a technique that is widely used for analysis of the methylation status of mammalian DNA (<xref ref-type="bibr" rid="B1">1</xref>). The method allows cytosine and 5-methylcytosine to be distinguished, because of the selective deamination of unmethylated cytosine to uracil following sodium bisulphite treatment. Consequently, after conversion, unmethylated regions of DNA contain no cytosine. The dsDNA product obtained after subsequent strand-specific PCR amplification is abnormal in two respects: it contains only three nucleotide types in each strand (A,G,T versus A,C,T), and each strand has an excess of one nucleotide (T or A, respectively).</p><p>Analysis of bisulphite-treated DNA can be performed either by directly sequencing the PCR products or by cloning the product and sequencing a number of independent clones. Both methods have their respective advantages and disadvantages, and the final choice depends on the exact aim of the experiment. The experimental differences that arise between the two approaches fall into four main areas: the template characteristics and primer design; the way in which the base-calling software interprets the trace data; the cost and speed of the analysis and the loss of methylation phase information (see the Discussion Section).</p><p>When these modified DNAs are used as templates for automated sequencing by the Sanger dideoxy method, problematic aberrant base-calling can sometimes occur. Miscalling of the DNA sequence by some automated sequencers is the result of the adaptive algorithms, that are used by the analysis software in order to achieve extended reads. Such programs track the signal intensity of each dye and artificially amplify the signal when it is low for an extended period. The absence either of a C or of a G signal, in bisulphite sequencing of unmethylated DNA, triggers this adaptive response, which progressively amplifies the weak background signal and eventually inserts spurious C or G residues into the sequence.</p><p>A further, non-experimental difficulty that frequently hinders bisulphite sequencing projects relates to editing and alignment of sequences. The bisulphite-treated DNA strands are no longer complementary, and neither strand is a perfect match to the original sequence (unless completely methylated). While it is possible to align these sequences to a reference sequence that has been bisulphite-modified <italic>in silico</italic>, this process becomes problematic if the trace sequences come from a mixture of clones whose inserts originate from different daughter strands. In addition, in regions of extended runs of a single nucleotide the alignment may go out of register. Consequently, individual sequence reads often have to be manually corrected, which can be a tedious error-prone process when multiple clones are being analysed.</p><p>To address these problems, a number of software programs have been developed that facilitate individual steps in the bisulphite sequencing process. These include primer design (<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B3">3</xref>), bisulphite-treated sequence alignment (<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B5">5</xref>) and generation of graphical or text-based outputs (<xref ref-type="bibr" rid="B6">6</xref>). None of these programs offers an integrated solution for routine use; the individual programs are variously controlled from the command line, a graphical user interface (GUI) or a web browser. Their combined use requires a degree of computer literacy somewhat beyond that of the average biomedical scientist, which is a significant consideration now that bisulphite sequencing has been widely adopted into routine use in genetics laboratories. Also, while command-line programs are powerful and flexible (if well documented) they sometimes do not provide a facility for user intervention and data editing, which may be required for resolving anomalous results. A well-designed GUI allows easier interaction, since data can be entered and then repeatedly reanalysed and edited using different parameters, with the results readily visible.</p><p>As a practical solution for the genetics laboratory, we have therefore developed CpGviewer, a well-documented GUI-based program. It can use as input either multiple plain text files or sequence electropherograms (without adaptive peak height adjustment), and then align them to a reference sequence. The methylation status of each CpG dinucleotide is determined automatically and the results displayed as an interactive grid, within which each column represents one CpG dinucleotide found in the reference sequence. Interactive editing is facilitated by the fact that each cell in a row provides a direct link to the underlying sequence data surrounding the corresponding CpG dinucleotide, aligned to the reference sequence. The program also allows the user to view the entire electropherogram of each file. It offers the ability to save the exported summary methylation data in a variety of graphical formats for publication purposes. It also has a facility for assisting in the selection of primers for amplification of bisulphite-treated DNA.</p></sec><sec sec-type="materials|methods"><title>MATERIALS AND METHODS</title><sec><title>Software development and requirements</title><p>Programming was done using Microsoft Visual Studio 2005 using the Visual Basic language. The program has been tested only on Microsoft Windows XP, and requires the .NET framework 2.0 to be installed. The program and accompanying documentation are freely available for download at <ext-link ext-link-type="uri" xlink:href="http://xserve1.leeds.ac.uk/~iancarr/cpgviewer">http://xserve1.leeds.ac.uk/~iancarr/cpgviewer</ext-link></p></sec><sec><title>Bisulphite modification and cloning of DNA</title><p>A sodium bisulphite DNA modification protocol was used as described previously (<xref ref-type="bibr" rid="B7">7</xref>). The example data were derived from bisulphite sequencing of the differentially methylated region (DMR) in the imprinted ZAC (PLAGL1) tumour-suppressor gene (<xref ref-type="bibr" rid="B7">7</xref>). The reference sequence corresponds to nucleotides 48434376&#x02013;48433838 of the Chromosome 6 assembly, accession NT_025741.14. PCR of bisulphite-modified DNA was carried out using the following primers, which amplify both methylated and unmethylated sequences: Zac9: dCCCAACCRTATCTAAATCAAAACT; and Zac1: dGTGTTTAGGATAGTGTTTGGTT. PCR conditions were as follows: denaturation at 94&#x000b0;C for 3&#x02009;min followed by 35 cycles of 94&#x000b0;C, 30&#x02009;s; 58&#x000b0;C, 30&#x02009;s; 72&#x000b0;C, 30&#x02009;s and a final extension step at 72&#x000b0;C for 3&#x02009;min. PCR products were gel-extracted, purified using the Geneclean II kit (MP Biomedicals, Solon, OH, USA) and ligated into pGEM-T Easy vector (Promega, Madison, WI, USA) according to the manufacturer's protocol. Ligations were transformed into DH5&#x003b1; cells and DNA extracted from recombinant clones using the Qiaprep Spin miniprep kit (Qiagen, Valencia, CA, USA).</p></sec><sec><title>DNA sequencing</title><p>For analysis on the MegaBace500 sequencer (GE Healthcare, Amersham, UK), miniprep DNA was sequenced using the DYEnamic ET Terminator kit according to the manufacturer's protocol. For analysis on the ABI3130xl sequencer, sequencing reactions were prepared using the BigDye Terminator v3.1 Cycle Sequencing kit (Applied Biosystems, Foster City, CA, USA). Plasmid clones were sequenced using standard M13 forward and reverse primers.</p></sec><sec><title>Trace file analysis</title><p>Since the program is designed to use as input either raw or analysed trace data from a number of different sources, it first extracts the trace data from each file type, and converts them into a common format that is used by its internal basecaller. If the data originate from an unprocessed file, the program automatically adjusts the baseline intensities of each trace and then corrects for spectral overlap between different dyes and different dye motilities. (However, since Staden files can originate from a variety of sources, it is assumed that .SCF data have already been corrected for differences in dye migration and spectral overlay.) Once the data are in the correct format, the base caller detects nucleotide peak positions by differential analysis of the individual traces. The typical peak to peak distance is determined and the data reanalysed to detect missed and false peaks. The sequence is then trimmed to remove poor quality sequence as determined by peak spacing. Although CpGviewer can be used perfectly well with previously analysed sequence data, we wrote this non-adaptive basecalling routine in order to circumvent major difficulties that certain adaptive routines (notably the Cimmaron basecaller supplied with MegaBace instruments) have when analysing sequences derived from unmethylated templates.</p></sec><sec><title>Alignment of bisulphite sequences to genomic reference sequence</title><p>The alignment is created using a local extension algorithm similar to that used in BLAST (<xref ref-type="bibr" rid="B8">8</xref>). An array of overlapping DNA fragments 10&#x02009;bp in length is created from the <italic>in silico</italic> bisulphite-modified reference sequence. (This fragment length can be changed via <bold>CpG</bold>&#x02009;&#x0003e;&#x02009;<bold>Alignment options</bold>&#x02009;&#x0003e;&#x02009;<bold>Word size</bold>.) These fragments are each mapped to regions on the query sequence that have an identical sequence. These sequences are then extended at both ends, the extension being terminated when three of the last five bases do not match between the reference and query sequences. The extended sequences are then sorted to remove duplicate alignments. The remaining alignments are then linked together, such that the largest fragment is linked to the start and end of the reference sequence using the remaining extended fragments, keeping the number and size of gaps to a minimum. Where gaps of unaligned sequences are created these are then aligned to each other using a pairwise alignment algorithm (<xref ref-type="bibr" rid="B9">9</xref>). Each alignment is given a quality score that is the percentage of the alignment's total length derived from the extended fragments. While this alignment is performed on the <italic>in silico</italic> converted reference sequence, the original reference sequence is also manipulated in the same way, and is displayed unmodified in the screen alignments, since this allows the user to identify specific CpG dinucleotides more easily than if traces are displayed aligned against the converted sequence.</p></sec></sec><sec sec-type="results"><title>RESULTS</title><sec><title>Analysis of electropherogram data</title><p>DNA sequences can be loaded into the program in a number of different electropherogram file formats. However, some knowledge of the behaviour of the individual sequencing instrument is advisable. Thus, for the MegaBace family of sequencers (GE Healthcare, Amersham, UK), *.esd files are best avoided, because of the adaptive baseline manipulation performed in generating them; instead, data are imported from unprocessed *.rsd files. Similarly, it is possible to use the raw sequence data in a *.AB1 file, rather than the processed data. During the analysis, the program examines the peak spacing of the traces and uses this information to trim the nucleotide sequence at its ends. However, internal regions of low sequence quality are not discarded. Rather, we have chosen to detect and discard low quality regions and vector DNA sequences later, when aligning the sequences to the reference sequence.</p></sec><sec><title>Alignment of bisulphite-treated DNA sequences</title><p>Once the DNA sequence has been determined for each trace file, it is aligned against the reference sequence using a local extension algorithm written for the purpose. (Commonly used alignment programs are not ideal for this task, because of the variable degree of divergence between the reference and experimental sequences.) Since the alignment is performed using the output sequences, without reference to trace quality scores, it is also possible to load sequences as plain text files. Such files are treated in the same manner as electropherogram data, except that the program interface does not provide a link to any peak height data.</p><p>Bisulphite treatment of unmethylated DNA results in sister strands that are no longer complementary to each other and are imperfect matches to the original sequence. To facilitate alignment of these modified sequences to the original reference sequence, each experimental sequence is compared to the predicted bisulphite-modified forward and reverse strands, as well as the original reference sequence. The alignment generating the highest score (see the Methods Section) is then used for subsequent sequence displays.</p></sec><sec><title>Visualization of CpG methylation status</title><p>The sequence alignment can be viewed either in the form of an interactive grid (<xref ref-type="fig" rid="F1">Figure 1</xref>) or as a web page, containing &#x02018;snapshot&#x02019; images of the local trace and alignment around each CpG in the reference sequence. These views each allow verification of the quality of the sequence and its alignment, around each CpG dinucleotide. The web page view can also be saved to disk, and so viewed independently of the source data.
<fig id="F1" position="float"><label>Figure 1.</label><caption><p>Interactive methylation status grid. The CpGviewer grid window, after loading the ZAC sample electropherograms. The traces can be seen to fall into two classes, either predominantly methylated (maternal allele) or unmethylated (paternal allele), as typical for an imprinted gene DMR. Clicking on a cell with the left mouse button displays the status of that CpG dinucleotide and the name of the sequence file from which it derives.</p></caption><graphic xlink:href="gkm330f1"/></fig></p><p>The interactive view comprises a window containing a grid of colour-coded squares (<xref ref-type="fig" rid="F1">Figure 1</xref>). Each column represents one CpG dinucleotide in the reference sequence and each row an individual experimental DNA sequence. Clicking on an individual cell displays its underlying data. The blue cells at the head of each column contain information on the position of that CpG dinucleotide in the reference sequence, while those at the start of each row identify the file name containing that sequence. For the remaining cells, black is used to highlight methylated CpG dinucleotides. Unmethylated CpG dinucleotides can either be displayed in white, or CpA and TpG can be shown in two distinguishable colours (pink and green). (In general, only one of CpA and TpG is applicable for a single experiment, but the two-colour display enables identification of any anomalous results.) Where a CpG dinucleotide in the reference sequence has been aligned to a sequence other than CpG, TpG or CpA its cell is yellow; this implies either the presence of a SNP at that position, or a sequencing or PCR artefact. Cells that correspond to positions that lie outside the alignment of an individual sequence trace are shaded grey.</p><p>When a blue border square is left-clicked, the caption below the grid displays either (i) for a row, the source file name and the aligned sequence's percentage of dC and dG content or (ii) for a column, information about the position of that CpG within the reference sequence. Similarly, left-clicking a square within the main body of the grid identifies the individual CpG, its methylation status and its file name (<xref ref-type="fig" rid="F1">Figure 1</xref>).</p><p>Right-clicking on a blue row square will display that file's electropherogram image, allowing the quality of the sequence to be observed (<xref ref-type="fig" rid="F2">Figure 2</xref>). Right-clicking on a main grid cell produces an output that depends on the origin of the sequence file: if the sequence was loaded as text, the sequence alignment is displayed with the chosen CpG position capitalized and marked by two asterisks (<xref ref-type="fig" rid="F3">Figure 3</xref>). If the sequence was generated from an electropherogram, right-clicking displays the local sequence trace with the corresponding part of the alignment (<xref ref-type="fig" rid="F4">Figure 4</xref>). This trace image display can be disabled by selecting <bold>Options</bold>&#x02009;&#x0003e;&#x02009;<bold>Always show text alignment</bold>.
<fig id="F2" position="float"><label>Figure 2.</label><caption><p>Electropherogram of a bisulphite-treated DNA clone. Right-clicking on one of the blue row cells displays the entire electropherogram for that individual sequence.</p></caption><graphic xlink:href="gkm330f2"/></fig>
<fig id="F3" position="float"><label>Figure 3.</label><caption><p>Display of the text alignment underlying the methylation status grid. This display option is used under two circumstances: if the original input sequence was plain text rather than trace data; if the Always show text alignment option is selected. In these circumstances, right-clicking on a cell shows that sequence's alignment against the reference sequence with the display window centred on the selected CpG dinucleotide.</p></caption><graphic xlink:href="gkm330f3"/></fig>
<fig id="F4" position="float"><label>Figure 4.</label><caption><p>Display of the electropherogram data underlying the methylation status grid. Ordinarily (see <xref ref-type="fig" rid="F3">Figure 3</xref> for exceptions), right-clicking on a cell in the main body of the interactive grid displays an image of the local region of the sequence trace and its alignment with the reference sequence (lower text row).</p></caption><graphic xlink:href="gkm330f4"/></fig></p><p>Using the CpG grid display window, it is also possible to generate a consensus sequence interactively. Selecting <bold>Edit</bold>&#x02009;&#x0003e;&#x02009;<bold>Create consensus&#x02009;&#x02026;</bold>&#x02009;adds a new row at the bottom of the grid. The cells in this row are initially grey, but change to match whichever colour is chosen by clicking on any cell in the same column. Once the consensus row is completed, the underlying sequence can be saved via <bold>Edit</bold>&#x02009;&#x0003e;&#x02009;<bold>Save consensus&#x02009;&#x02026;</bold>&#x02009;. This feature may be useful for various purposes. For example, if multiple sequence runs are performed on a single cloned product, the consensus row can be used to assemble the most accurate sequence of that clone. Alternatively, if each row represents a separate clone, a sequence can be built that represents the population consensus methylation state, e.g. for a specific tissue or patient. Also, since consensus sequences can be saved and then reloaded as text input files, the feature can be used consecutively to generate clone sequences and then a population consensus. For an imprinted CpG island, where the methylation patterns fall into two clearly distinguishable groups, a separate consensus can be created and saved for each allele.</p><p>Most bisulphite sequencing projects require some additional editing of the alignment. Therefore, the true status of mismatched CpGs that are highlighted in yellow or grey can be manually assigned after inspecting the sequence data. To do this, the <bold>Edit</bold>&#x02009;&#x0003e;&#x02009;<bold>Edit data</bold> option is first selected. A left-click on a square then allows the user to choose any of the possible alternative states of this CpG dinucleotide. (This choice is overlaid on the original grid square as a slightly smaller square of the new colour.) A right-click while in this mode brings up (as described earlier) the electropherogram or sequence alignment display window; the user can inspect this and then click on the window to assign the correct status (<xref ref-type="fig" rid="F5">Figure 5</xref>).
<fig id="F5" position="float"><label>Figure 5.</label><caption><p>Editing the CpG methylation status. Clicking in the electropherogram image window allows the methylation status of the CpG dinucleotide to be edited via a dropdown menu. In the grid, the edited squares can be seen as smaller squares representing the edited values, overlaying the larger squares representing the originals. The editing menu can also be accessed by clicking on the text of the alignment (<xref ref-type="fig" rid="F3">Figure 3</xref>) or by clicking the grid when in edit mode.</p></caption><graphic xlink:href="gkm330f5"/></fig></p><p>For a large project, a partially edited set of data can be saved to disk as a *.edi file with the same prefix as the input reference sequence. This file can be reloaded for later use, but does not contain all the original electropherogram data, which must therefore be retained for use in conjunction with the *.edi file.</p><p>The <bold>Tasks</bold>&#x02009;&#x0003e;&#x02009;<bold>Save Image&#x02009;&#x02026;</bold>&#x02009;command allows the grid display to be exported to a variety of graphics file formats. In addition to the square pattern used for the interactive grid, two &#x02018;lollipop&#x02019; styles as commonly used in publications are available, either with fixed spacing or scaled to show the relative positions of each CpG within the sequence (<xref ref-type="fig" rid="F6">Figure 6</xref>). This exported graphic can also be generated either with the edited or the original cell data (<bold>Options</bold>&#x02009;&#x0003e;&#x02009;<bold>Use edited data when saving images</bold>).
<fig id="F6" position="float"><label>Figure 6.</label><caption><p>Summary output of methylation data. Publication type CpG dinucleotide information shown as equally spaced (<bold>A</bold>) or scaled (<bold>B</bold>) &#x02018;lollipops&#x02019;. (To prevent closely spaced lollipops from overlying one another in the scaled view, a fixed gap of half the width of a lollipop is inserted in the <italic>x</italic> axis after each lollipop stick).</p></caption><graphic xlink:href="gkm330f6"/></fig></p></sec></sec><sec sec-type="discussion"><title>DISCUSSION</title><p>As stated earlier, methylation analysis can be performed either by direct sequencing of PCR products or by sequencing a number of cloned PCR products. Each approach has its merits. At first sight, direct PCR sequencing appears a much quicker and cheaper option than cloning and then sequencing multiple copies of the product. However, it often requires significant effort to optimize the initial PCR conditions so as to eliminate template contamination with spurious amplification products. This is probably a consequence of the reduced sequence complexity of bisulphite-treated DNA. Also, if the genomic DNA displays two divergent methylation states (as is the case for differentially methylated regions (DMRs) of imprinted genes), the bisulphite PCR product contains two very different template sequences. These highly divergent sequences may then demonstrate quite disparate electrophoretic mobilities, (e.g. due to one sequence having a greater tendency to form a stable secondary structure). This can lead to superimposed &#x02018;staggered&#x02019; electropherograms representing methylated and unmethylated alleles, which are hard to read. Neither of these technical issues is a problem when sequencing cloned products; since each clone contains just one sequence, differences in mobility do not arise, while any spuriously amplified PCR products can also be readily identified and discarded.</p><p>CpGviewer is therefore primarily aimed at projects in which multiple cloned bisulphite-PCR sequences are being compared. Others, in contrast, have taken computational approaches that aim at robust quantitative analysis of directly sequenced bisulphite-PCR products (<xref ref-type="bibr" rid="B4">4</xref>). The latter approach is necessary for high-throughput &#x02018;epigenomic&#x02019; studies. For smaller studies focussed on one or two genomic regions, however, the cost and time incurred in template optimization for direct sequencing may be greater than that of cloning and sequencing the products. Furthermore, direct sequencing can never reveal the full information content present in bisulphite-PCR products derived from a diploid genome or from a mixed population of cells. For example, if a tumour DNA appears to show a methylation level of 50%, this could represent randomly distributed methylation of &#x0223c;50% of each CpG, or the existence of a mixture of two cell populations, one completely methylated and one completely unmethylated. Similar considerations apply to the interpretation of direct sequencing of DMRs of imprinted genes, where the two alleles may differ markedly in methylation status. Sometimes it is wise also to compare the results of direct sequencing with cloning and sequencing, thus permitting the detection of cloning biases that occur at some DMRs.</p><p>Both direct and clonal bisulphite sequencing approaches can also sometimes be affected by base-calling problems. Recent advances in sequencing technology have been directed primarily at increased read length with the undesired side effect that the computational approaches used by some base callers can hamper the analysis of DNA with an unusual base composition. As described above, adaptive amplification of the C (or G) baseline can be induced by the deficiency of C (or G) residues in templates derived from bisulphite-modified DNA. Even if this effect (which is much more pronounced when methylated CpGs are absent from the starting material) is not severe enough to cause extra bases to be called, it also reduces the sequence quality score. We have found this effect to be particularly problematic when sequencing unmethylated DNA sources on the MegaBace500 instrument; this was the principal reason for including a non-adaptive base-calling algorithm for analysing raw sequence traces that does not adjust baseline intensity according to perceived sequence context. For the related reason alluded to above, we have also chosen not to discard sequence traces based on their quality scores. While such quality scores are very important in the construction of <italic>de novo</italic> sequence contigs, they are of limited value when aligning multiple independent test sequences against a known reference sequence.</p><p>In any bisulphite sequencing project, once the sequences have been base called, they must be aligned against the reference sequence. Again, the commonly used local and global alignment tools are not well suited to this task, both because the sister strands of bisulphite-treated template DNA no longer match the original sequence, and because variability in methylation status means that individual product molecules vary in sequence. We have therefore used an algorithm that can align DNA sequences irrespective of the sequence direction, methylation status and completeness of cytosine deamination. As stated earlier, it is at this stage of analysis that sequences are discarded, if they cannot be aligned to the reference. This approach allows us to shift the experimental quality control away from analysis of fluorescence peak heights, onto the comparison of the base-called sequence with a reference sequence (which it should align perfectly to, and against which discrepancies can be rapidly eliminated interactively).</p><p>The final convenience offered by this program is the production of a graphical representation of the methylation status of all the experimental sequences. Graphical representations of this type are commonly used when publishing the results of bisulphite sequencing studies. Our program automates this tedious and error-prone data collation step, with user input limited to interactive editing and generation of a final consensus sequence (if desired). It is a simple matter at this stage to identify sequences with poorer quality reads, by the presence of yellow cells. Rapid display of the trace data corresponding to these cells allows the rapid validation or discarding of individual results.</p><p>In conclusion, analysis of the methylation status of DNA by the sequencing of cloned sodium bisulphite-treated DNA products is a well-established and important laboratory technique that has for some time been hindered by a lack of easy to use data analysis software. We have made a number of design decisions in developing this program, that focus on the special requirements of this methodology. By discarding unnecessary or inappropriate steps that create bottlenecks in the analytical process, we have found that the time required to complete a methylation study can be dramatically reduced.</p></sec>
<sec sec-type="supplementary-material">
<title>Supplementary Material</title>
<supplementary-material id="PMC_1" content-type="local-data">
<caption>
<title>[Supplementary Material]</title>
</caption>
<media mimetype="text" mime-subtype="html" xlink:href="nar_gkm330_index.html"/>
<media xlink:role="associated-file" mimetype="application" mime-subtype="msword"
xlink:href="nar_gkm330_nar-00723-met-s-2007-File009.doc"/>
</supplementary-material>
</sec>
</body><back><ack><title>ACKNOWLEDGEMENTS</title><p>This work was supported by the West Riding Medical Research Trust, by the Leukaemia Research Fund Grant 00/56 and by a pump-priming grant from Yorkshire Cancer Research. Funding to pay the Open Access publication charges for this article was provided by the West Riding Medical Research Trust.</p><p><italic>Conflict of interest statement</italic>. None declared.</p></ack><ref-list><title>REFERENCES</title><ref id="B1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clark</surname><given-names>SJ</given-names></name><name><surname>Harrison</surname><given-names>J</given-names></name><name><surname>Paul</surname><given-names>CL</given-names></name><name><surname>Frommer</surname><given-names>M</given-names></name></person-group><article-title>High sensitivity mapping of methylated cytosines</article-title><source>Nucleic Acids Res</source><year>1994</year><volume>22</volume><fpage>2990</fpage><lpage>2997</lpage><pub-id pub-id-type="pmid">8065911</pub-id></element-citation></ref><ref id="B2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>L-C</given-names></name><name><surname>Dahiya</surname><given-names>R</given-names></name></person-group><article-title>MethPrimer: designing primers for methylation PCRs</article-title><source>Bioinformatics</source><year>2002</year><volume>18</volume><fpage>1427</fpage><lpage>1431</lpage><pub-id pub-id-type="pmid">12424112</pub-id></element-citation></ref><ref id="B3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tusn&#x000e1;dy</surname><given-names>GE</given-names></name><name><surname>Simon</surname><given-names>I</given-names></name><name><surname>V&#x000e1;radi</surname><given-names>A</given-names></name><name><surname>Ar&#x000e1;nyi</surname><given-names>T</given-names></name></person-group><article-title>BiSearch: primer-design and search tool for PCR on bisulfite-treated genomes</article-title><source>Nucleic Acids Res</source><year>2005</year><volume>33</volume><fpage>e9</fpage><pub-id pub-id-type="pmid">15653630</pub-id></element-citation></ref><ref id="B4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lewin</surname><given-names>J</given-names></name><name><surname>Schmitt</surname><given-names>AO</given-names></name><name><surname>Adorj&#x000e1;n</surname><given-names>P</given-names></name><name><surname>Hildmann</surname><given-names>T</given-names></name><name><surname>Piepenbrock</surname><given-names>C</given-names></name></person-group><article-title>Quantitative DNA methylation analysis based on four-dye trace data from direct sequencing of PCR amplificates</article-title><source>Bioinformatics</source><year>2004</year><volume>20</volume><fpage>3005</fpage><lpage>3012</lpage><pub-id pub-id-type="pmid">15247106</pub-id></element-citation></ref><ref id="B5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bock</surname><given-names>C</given-names></name><name><surname>Reither</surname><given-names>S</given-names></name><name><surname>Mikeska</surname><given-names>T</given-names></name><name><surname>Paulsen</surname><given-names>M</given-names></name><name><surname>Walter</surname><given-names>J</given-names></name><name><surname>Lengauer</surname><given-names>T</given-names></name></person-group><article-title>BiQ Analyzer: visualization and quality control for DNA methylation data from bisulfite sequencing</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>4067</fpage><lpage>4068</lpage><pub-id pub-id-type="pmid">16141249</pub-id></element-citation></ref><ref id="B6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grunau</surname><given-names>C</given-names></name><name><surname>Schattevoy</surname><given-names>R</given-names></name><name><surname>Mache</surname><given-names>N</given-names></name><name><surname>Rosenthal</surname><given-names>A</given-names></name></person-group><article-title>MethTools &#x02013; a toolbox to visualize and analyze DNA methylation data</article-title><source>Nucleic Acids Res</source><year>2000</year><volume>28</volume><fpage>1053</fpage><lpage>1058</lpage><pub-id pub-id-type="pmid">10666443</pub-id></element-citation></ref><ref id="B7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kamiya</surname><given-names>M</given-names></name><name><surname>Judson</surname><given-names>H</given-names></name><name><surname>Okazaki</surname><given-names>Y</given-names></name><name><surname>Kusakabe</surname><given-names>M</given-names></name><name><surname>Muramatsu</surname><given-names>M</given-names></name><name><surname>Takada</surname><given-names>S</given-names></name><name><surname>Takagi</surname><given-names>N</given-names></name><name><surname>Arima</surname><given-names>T</given-names></name><name><surname>Wake</surname><given-names>N</given-names></name><etal/></person-group><article-title>The cell cycle control gene ZAC/PLAGL1 is imprinted &#x02013; a strong candidate gene for transient neonatal diabetes</article-title><source>Hum. Mol. Genet</source><year>2000</year><volume>9</volume><fpage>453</fpage><lpage>460</lpage><pub-id pub-id-type="pmid">10655556</pub-id></element-citation></ref><ref id="B8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altschul</surname><given-names>SF</given-names></name><name><surname>Gish</surname><given-names>W</given-names></name><name><surname>Miller</surname><given-names>W</given-names></name><name><surname>Myers</surname><given-names>EW</given-names></name><name><surname>Lipman</surname><given-names>DJ</given-names></name></person-group><article-title>Basic local alignment search tool</article-title><source>J. Mol. Biol</source><year>1990</year><volume>215</volume><fpage>403</fpage><lpage>410</lpage><pub-id pub-id-type="pmid">2231712</pub-id></element-citation></ref><ref id="B9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Needleman</surname><given-names>SB</given-names></name><name><surname>Wunsch</surname><given-names>CD</given-names></name></person-group><article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins</article-title><source>J. Mol. Biol</source><year>1970</year><volume>48</volume><fpage>443</fpage><lpage>453</lpage><pub-id pub-id-type="pmid">5420325</pub-id></element-citation></ref></ref-list></back></article>
